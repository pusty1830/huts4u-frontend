{"version":3,"file":"static/js/434.06116b18.chunk.js","mappings":"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","sources":["components/Payments/Calculation.tsx"],"sourcesContent":["// // src/utils/priceCalculations.ts\r\n\r\n// /**\r\n//  * Calculate the complete price breakdown including all fees and taxes\r\n//  * @param basePrice - The base room price (before any fees/taxes)\r\n//  * @returns Object containing all price components\r\n//  */\r\n// export const calculatePriceBreakdown = (basePrice: number) => {\r\n//     const numericBase = Number(basePrice) || 0;\r\n\r\n//     if (!numericBase || numericBase <= 0) {\r\n//         return {\r\n//             basePrice: 0,\r\n//             platformFee: 0,\r\n//             gstOnBase: 0,\r\n//             gstOnPlatform: 0,\r\n//             gatewayFee: 0,\r\n//             gstOnGateway: 0,\r\n//             gstTotal: 0,\r\n//             finalPrice: 0,\r\n//         };\r\n//     }\r\n\r\n//     const gstOnBase = numericBase * 0.05;\r\n//     const platformFeeBase = numericBase + gstOnBase;\r\n//     const platformFee = platformFeeBase * 0.13;\r\n//     const gstOnPlatform = platformFee * 0.18;\r\n//     const amountBeforeGateway = numericBase + gstOnBase + platformFee + gstOnPlatform;\r\n    \r\n//     // Split 3.8% into three parts: 1.6%, 0.3%, 1.9% (each with 18% GST)\r\n//     // Part 1: 1.6%\r\n//     const gatewayFeePart1 = amountBeforeGateway * 0.016;\r\n//     const gstOnGatewayPart1 = gatewayFeePart1 * 0.18;\r\n    \r\n//     // Part 2: 0.3% (calculated on amount after part 1)\r\n//     const amountAfterPart1 = amountBeforeGateway + gatewayFeePart1 + gstOnGatewayPart1;\r\n//     const gatewayFeePart2 = amountAfterPart1 * 0.003;\r\n//     const gstOnGatewayPart2 = gatewayFeePart2 * 0.18;\r\n    \r\n//     // Part 3: 1.9% (calculated on amount after part 2)\r\n//     const amountAfterPart2 = amountAfterPart1 + gatewayFeePart2 + gstOnGatewayPart2;\r\n//     const gatewayFeePart3 = amountAfterPart2 * 0.019;\r\n//     const gstOnGatewayPart3 = gatewayFeePart3 * 0.18;\r\n    \r\n//     // Total gateway fee and GST (backward compatible)\r\n//     const gatewayFee = gatewayFeePart1 + gatewayFeePart2 + gatewayFeePart3;\r\n//     const gstOnGateway = gstOnGatewayPart1 + gstOnGatewayPart2 + gstOnGatewayPart3;\r\n    \r\n//     const gstTotal = gstOnBase + gstOnPlatform + gstOnGateway;\r\n//     const finalPrice = numericBase + platformFee + gstTotal;\r\n\r\n//     return {\r\n//         basePrice: numericBase,\r\n//         platformFee,\r\n//         gstOnBase,\r\n//         gstOnPlatform,\r\n//         gatewayFee,\r\n//         gstOnGateway,\r\n//         gstTotal,\r\n//         finalPrice,\r\n//     };\r\n// };\r\n\r\n// // Helper function to format INR currency\r\n// export const formatINR = (val: number) =>\r\n//     val.toLocaleString(\"en-IN\", {\r\n//         style: \"currency\",\r\n//         currency: \"INR\",\r\n//         minimumFractionDigits: 0,\r\n//     });\r\n\r\n// // Optional: Function to calculate total price for multiple rooms/nights\r\n// export const calculateTotalPrice = (\r\n//     basePrice: number,\r\n//     roomsCount: number = 1,\r\n//     nights: number = 1\r\n// ) => {\r\n//     const breakdown = calculatePriceBreakdown(basePrice);\r\n//     const perRoomFinal = breakdown.finalPrice;\r\n//     const perRoomBase = breakdown.basePrice;\r\n//     const perRoomPlatform = breakdown.platformFee;\r\n//     const perRoomGstTotal = breakdown.gstTotal;\r\n\r\n//     const multiplier = roomsCount * nights;\r\n\r\n//     return {\r\n//         ...breakdown,\r\n//         totalBase: +(perRoomBase * multiplier),\r\n//         totalPlatform: +(perRoomPlatform * multiplier),\r\n//         totalGst: +(perRoomGstTotal * multiplier),\r\n//         totalFinal: +(perRoomFinal * multiplier),\r\n//     };\r\n// };\r\n\r\n// export const calculatePriceBreakdown1 = (\r\n//     basePrice: number,\r\n//     mealPlanPrice: number = 0,\r\n//     discounts: {\r\n//         hotelDiscountValue: number;\r\n//         hotelDiscountType: 'percentage' | 'flat' | null;\r\n//         couponApplied: boolean;\r\n//         couponValue: number;\r\n//     }\r\n// ) => {\r\n//     const numericBase = Number(basePrice) || 0;\r\n//     const numericMeal = Number(mealPlanPrice) || 0;\r\n\r\n//     if (!numericBase || numericBase <= 0) {\r\n//         return {\r\n//             basePrice: 0,\r\n//             mealPlanPrice: 0,\r\n//             gstOnBase: 0,\r\n//             platformFee: 0,\r\n//             gstOnPlatform: 0,\r\n//             convenienceFee: 0,\r\n//             gstOnConvenience: 0,\r\n//             totalWithoutDiscount: 0,\r\n//             hotelDiscount: 0,\r\n//             couponDiscount: 0,\r\n//             totalDiscount: 0,\r\n//             finalPrice: 0,\r\n//         };\r\n//     }\r\n\r\n//     // Total taxable value (base + meal plan)\r\n//     const totalTaxableValue = numericBase + numericMeal;\r\n\r\n//     // 1. GST on base + meal (5%)\r\n//     const gstOnBase = totalTaxableValue * 0.05;\r\n\r\n//     // Amount after base GST\r\n//     const amountAfterBaseGst = totalTaxableValue + gstOnBase;\r\n\r\n//     // 2. Platform fee (13% on base + GST)\r\n//     const platformFee = amountAfterBaseGst * 0.13;\r\n\r\n//     // 3. GST on platform fee (18%)\r\n//     const gstOnPlatform = platformFee * 0.18;\r\n\r\n//     // 4. Subtotal before convenience\r\n//     const subtotalBeforeConvenience =\r\n//         totalTaxableValue + gstOnBase + platformFee + gstOnPlatform;\r\n\r\n//     // Split 3.8% into three parts: 1.6%, 0.3%, 1.9% (each with 18% GST)\r\n//     // Part 1: 1.6%\r\n//     const convenienceFeePart1 = subtotalBeforeConvenience * 0.016;\r\n//     const gstOnConveniencePart1 = convenienceFeePart1 * 0.18;\r\n    \r\n//     // Part 2: 0.3% (calculated on amount after part 1)\r\n//     const amountAfterPart1 = subtotalBeforeConvenience + convenienceFeePart1 + gstOnConveniencePart1;\r\n//     const convenienceFeePart2 = amountAfterPart1 * 0.003;\r\n//     const gstOnConveniencePart2 = convenienceFeePart2 * 0.18;\r\n    \r\n//     // Part 3: 1.9% (calculated on amount after part 2)\r\n//     const amountAfterPart2 = amountAfterPart1 + convenienceFeePart2 + gstOnConveniencePart2;\r\n//     const convenienceFeePart3 = amountAfterPart2 * 0.019;\r\n//     const gstOnConveniencePart3 = convenienceFeePart3 * 0.18;\r\n    \r\n//     // Total convenience fee and GST (backward compatible)\r\n//     const convenienceFee = convenienceFeePart1 + convenienceFeePart2 + convenienceFeePart3;\r\n//     const gstOnConvenience = gstOnConveniencePart1 + gstOnConveniencePart2 + gstOnConveniencePart3;\r\n\r\n//     // 7. Total without discount\r\n//     const totalWithoutDiscount =\r\n//         subtotalBeforeConvenience + convenienceFee + gstOnConvenience;\r\n\r\n//     // Calculate hotel discount\r\n//     let hotelDiscount = 0;\r\n//     if (discounts.hotelDiscountValue > 0 && discounts.hotelDiscountType) {\r\n//         if (discounts.hotelDiscountType === 'percentage') {\r\n//             // Percentage discount on total without discount\r\n//             hotelDiscount = totalWithoutDiscount * (discounts.hotelDiscountValue / 100);\r\n//         } else {\r\n//             // Flat discount\r\n//             hotelDiscount = Math.min(discounts.hotelDiscountValue, totalWithoutDiscount);\r\n//         }\r\n//     }\r\n\r\n//     // Calculate coupon discount (5% on total without discount)\r\n//     let couponDiscount = 0;\r\n//     if (discounts.couponApplied) {\r\n//         couponDiscount = totalWithoutDiscount * discounts.couponValue;\r\n//     }\r\n\r\n//     // Total discount\r\n//     const totalDiscount = hotelDiscount + couponDiscount;\r\n\r\n//     // Final price = total without discount - discounts\r\n//     const finalPrice = totalWithoutDiscount - totalDiscount;\r\n\r\n//     return {\r\n//         basePrice: numericBase,\r\n//         mealPlanPrice: numericMeal,\r\n//         gstOnBase,\r\n//         platformFee,\r\n//         gstOnPlatform,\r\n//         convenienceFee,\r\n//         gstOnConvenience,\r\n//         totalWithoutDiscount,\r\n//         hotelDiscount,\r\n//         couponDiscount,\r\n//         totalDiscount,\r\n//         finalPrice,\r\n//     };\r\n// };\r\n\r\n// export const round2 = (n: number) => Math.round(n * 100) / 100;\r\n\r\n// export const calculateInvoiceBreakdown = (finalAmount: number) => {\r\n//     const discountPercentage = 0.05; // 5% discount\r\n//     const serviceChargePercentage = 0.13; // 13% of Base Price WITH GST\r\n//     const convenienceFeePercentages = [0.016, 0.003, 0.019]; // 1.6%, 0.3%, 1.9% (total 3.8%)\r\n\r\n//     // Step 1: Calculate subtotal before discount\r\n//     const subtotalBeforeDiscount = round2(finalAmount / (1 - discountPercentage));\r\n//     const discountAmount = round2(subtotalBeforeDiscount * discountPercentage);\r\n\r\n//     // Step 2: Find Base Price iteratively\r\n//     let basePriceExclGST = round2(subtotalBeforeDiscount / 1.23965);\r\n    \r\n//     // Iterate to refine the calculation due to sequential fees\r\n//     for (let i = 0; i < 5; i++) {\r\n//         const baseCGST = round2(basePriceExclGST * 0.025);\r\n//         const baseSGST = round2(basePriceExclGST * 0.025);\r\n//         const baseTotal = round2(basePriceExclGST + baseCGST + baseSGST);\r\n\r\n//         const serviceChargesExclGST = round2(baseTotal * serviceChargePercentage);\r\n//         const serviceCGST = round2(serviceChargesExclGST * 0.09);\r\n//         const serviceSGST = round2(serviceChargesExclGST * 0.09);\r\n//         const serviceTotal = round2(serviceChargesExclGST + serviceCGST + serviceSGST);\r\n\r\n//         // Calculate sequential convenience fees\r\n//         let currentAmount = baseTotal + serviceTotal;\r\n//         let totalConvenienceExclGST = 0;\r\n//         let totalConvenienceCGST = 0;\r\n//         let totalConvenienceSGST = 0;\r\n        \r\n//         for (const percentage of convenienceFeePercentages) {\r\n//             const convenienceExclGST = round2(currentAmount * percentage);\r\n//             const convenienceCGST = round2(convenienceExclGST * 0.09);\r\n//             const convenienceSGST = round2(convenienceExclGST * 0.09);\r\n            \r\n//             totalConvenienceExclGST += convenienceExclGST;\r\n//             totalConvenienceCGST += convenienceCGST;\r\n//             totalConvenienceSGST += convenienceSGST;\r\n            \r\n//             currentAmount += convenienceExclGST + convenienceCGST + convenienceSGST;\r\n//         }\r\n        \r\n//         const convenienceTotal = round2(totalConvenienceExclGST + totalConvenienceCGST + totalConvenienceSGST);\r\n//         const calculatedSubtotal = round2(baseTotal + serviceTotal + convenienceTotal);\r\n//         const calculatedFinal = round2(calculatedSubtotal * (1 - discountPercentage));\r\n        \r\n//         // Adjust base price\r\n//         basePriceExclGST = round2(basePriceExclGST * (finalAmount / calculatedFinal));\r\n//     }\r\n\r\n//     // Final calculation with refined base price\r\n//     const baseCGST = round2(basePriceExclGST * 0.025);\r\n//     const baseSGST = round2(basePriceExclGST * 0.025);\r\n//     const baseTotal = round2(basePriceExclGST + baseCGST + baseSGST);\r\n\r\n//     const serviceChargesExclGST = round2(baseTotal * serviceChargePercentage);\r\n//     const serviceCGST = round2(serviceChargesExclGST * 0.09);\r\n//     const serviceSGST = round2(serviceChargesExclGST * 0.09);\r\n//     const serviceTotal = round2(serviceChargesExclGST + serviceCGST + serviceSGST);\r\n\r\n//     // Calculate sequential convenience fees\r\n//     let currentAmount = baseTotal + serviceTotal;\r\n//     let totalConvenienceExclGST = 0;\r\n//     let totalConvenienceCGST = 0;\r\n//     let totalConvenienceSGST = 0;\r\n    \r\n//     for (const percentage of convenienceFeePercentages) {\r\n//         const convenienceExclGST = round2(currentAmount * percentage);\r\n//         const convenienceCGST = round2(convenienceExclGST * 0.09);\r\n//         const convenienceSGST = round2(convenienceExclGST * 0.09);\r\n        \r\n//         totalConvenienceExclGST += convenienceExclGST;\r\n//         totalConvenienceCGST += convenienceCGST;\r\n//         totalConvenienceSGST += convenienceSGST;\r\n        \r\n//         currentAmount += convenienceExclGST + convenienceCGST + convenienceSGST;\r\n//     }\r\n    \r\n//     const convenienceTotal = round2(totalConvenienceExclGST + totalConvenienceCGST + totalConvenienceSGST);\r\n\r\n//     // Recalculate subtotal to ensure accuracy\r\n//     const calculatedSubtotal = round2(baseTotal + serviceTotal + convenienceTotal);\r\n//     const calculatedDiscount = round2(calculatedSubtotal * discountPercentage);\r\n//     const calculatedFinal = round2(calculatedSubtotal - calculatedDiscount);\r\n\r\n//     return {\r\n//         basePrice: basePriceExclGST,\r\n//         baseCGST: baseCGST,\r\n//         baseSGST: baseSGST,\r\n//         baseTotal: baseTotal,\r\n//         serviceCharges: serviceChargesExclGST,\r\n//         serviceCGST: serviceCGST,\r\n//         serviceSGST: serviceSGST,\r\n//         serviceTotal: serviceTotal,\r\n//         convenienceFee: totalConvenienceExclGST, // Backward compatible\r\n//         convenienceCGST: totalConvenienceCGST,\r\n//         convenienceSGST: totalConvenienceSGST,\r\n//         convenienceTotal: convenienceTotal,\r\n//         subtotalBeforeDiscount: calculatedSubtotal,\r\n//         discountAmount: calculatedDiscount,\r\n//         finalAmount: calculatedFinal,\r\n//         totalCGST: round2(baseCGST + serviceCGST + totalConvenienceCGST),\r\n//         totalSGST: round2(baseSGST + serviceSGST + totalConvenienceSGST),\r\n//         totalGST: round2(baseCGST + baseSGST + serviceCGST + serviceSGST + totalConvenienceCGST + totalConvenienceSGST),\r\n//         totalTaxable: round2(basePriceExclGST + serviceChargesExclGST + totalConvenienceExclGST),\r\n//     };\r\n// };\r\n\r\n// export const reversePriceBreakup = (finalAmount: number) => {\r\n//     // Use iterative approach to account for sequential fees\r\n//     let basePrice = finalAmount / 1.2156862745; // Start with approximate multiplier\r\n    \r\n//     // Iterate to refine the calculation\r\n//     for (let i = 0; i < 10; i++) {\r\n//         const gstOnBase = basePrice * 0.05;\r\n//         const commission = basePrice * 0.13;\r\n//         const gstOnCommission = commission * 0.18;\r\n        \r\n//         // Calculate sequential convenience fees\r\n//         let core = basePrice + gstOnBase + commission + gstOnCommission;\r\n        \r\n//         // Part 1: 1.6%\r\n//         const convenienceFee1 = core * 0.016;\r\n//         const gstOnConvenience1 = convenienceFee1 * 0.18;\r\n//         core += convenienceFee1 + gstOnConvenience1;\r\n        \r\n//         // Part 2: 0.3%\r\n//         const convenienceFee2 = core * 0.003;\r\n//         const gstOnConvenience2 = convenienceFee2 * 0.18;\r\n//         core += convenienceFee2 + gstOnConvenience2;\r\n        \r\n//         // Part 3: 1.9%\r\n//         const convenienceFee3 = core * 0.019;\r\n//         const gstOnConvenience3 = convenienceFee3 * 0.18;\r\n//         core += convenienceFee3 + gstOnConvenience3;\r\n        \r\n//         const totalCheck = basePrice + gstOnBase + commission + gstOnCommission + \r\n//                           convenienceFee1 + gstOnConvenience1 + \r\n//                           convenienceFee2 + gstOnConvenience2 + \r\n//                           convenienceFee3 + gstOnConvenience3;\r\n        \r\n//         // Adjust base price\r\n//         basePrice = basePrice * (finalAmount / totalCheck);\r\n        \r\n//         // Break if close enough\r\n//         if (Math.abs(finalAmount - totalCheck) < 0.01) break;\r\n//     }\r\n\r\n//     // Final calculation\r\n//     const gstOnBase = basePrice * 0.05;\r\n//     const commission = basePrice * 0.13;\r\n//     const gstOnCommission = commission * 0.18;\r\n    \r\n//     let core = basePrice + gstOnBase + commission + gstOnCommission;\r\n    \r\n//     const convenienceFee1 = core * 0.016;\r\n//     const gstOnConvenience1 = convenienceFee1 * 0.18;\r\n//     core += convenienceFee1 + gstOnConvenience1;\r\n    \r\n//     const convenienceFee2 = core * 0.003;\r\n//     const gstOnConvenience2 = convenienceFee2 * 0.18;\r\n//     core += convenienceFee2 + gstOnConvenience2;\r\n    \r\n//     const convenienceFee3 = core * 0.019;\r\n//     const gstOnConvenience3 = convenienceFee3 * 0.18;\r\n    \r\n//     // Total convenience fee for backward compatibility\r\n//     const convenienceFee = convenienceFee1 + convenienceFee2 + convenienceFee3;\r\n//     const gstOnConvenience = gstOnConvenience1 + gstOnConvenience2 + gstOnConvenience3;\r\n    \r\n//     const totalCheck = basePrice + gstOnBase + commission + gstOnCommission + \r\n//                        convenienceFee + gstOnConvenience;\r\n\r\n//     return {\r\n//         basePrice: Math.round(basePrice),\r\n//         gstOnBase,\r\n//         commission,\r\n//         gstOnCommission,\r\n//         convenienceFee, // Backward compatible\r\n//         gstOnConvenience, // Backward compatible\r\n//         totalCheck: basePrice + gstOnBase + commission + gstOnCommission + convenienceFee + gstOnConvenience\r\n//     };\r\n// };\r\n\r\n// src/utils/priceCalculations.ts\r\n\r\n/**\r\n * Calculate the complete price breakdown including all fees and taxes\r\n * @param basePrice - The base room price (before any fees/taxes)\r\n * @returns Object containing all price components\r\n */\r\nexport const calculatePriceBreakdown = (basePrice: number) => {\r\n    const numericBase = Number(basePrice) || 0;\r\n\r\n    if (!numericBase || numericBase <= 0) {\r\n        return {\r\n            basePrice: 0,\r\n            platformFee: 0,\r\n            gstOnBase: 0,\r\n            gstOnPlatform: 0,\r\n            gatewayFee: 0,\r\n            gstOnGateway: 0,\r\n            gstTotal: 0,\r\n            finalPrice: 0,\r\n        };\r\n    }\r\n\r\n    const gstOnBase = numericBase * 0.05;\r\n    const platformFeeBase = numericBase + gstOnBase;\r\n    const platformFee = platformFeeBase * 0.13;\r\n    const gstOnPlatform = platformFee * 0.18;\r\n    const amountBeforeGateway = numericBase + gstOnBase + platformFee + gstOnPlatform;\r\n    \r\n    // Split into two parts: 1.6% and 0.3% (total 1.9%)\r\n    // Part 1: 1.6%\r\n    const gatewayFeePart1 = amountBeforeGateway * 0.016;\r\n    const gstOnGatewayPart1 = gatewayFeePart1 * 0.18;\r\n    \r\n    // Part 2: 0.3% (calculated on amount after part 1)\r\n    const amountAfterPart1 = amountBeforeGateway + gatewayFeePart1 + gstOnGatewayPart1;\r\n    const gatewayFeePart2 = amountAfterPart1 * 0.003;\r\n    const gstOnGatewayPart2 = gatewayFeePart2 * 0.18;\r\n    \r\n    // Total gateway fee and GST (backward compatible)\r\n    const gatewayFee = gatewayFeePart1 + gatewayFeePart2;\r\n    const gstOnGateway = gstOnGatewayPart1 + gstOnGatewayPart2;\r\n    \r\n    const gstTotal = gstOnBase + gstOnPlatform + gstOnGateway;\r\n    const finalPrice = numericBase + platformFee + gstTotal;\r\n\r\n    return {\r\n        basePrice: numericBase,\r\n        platformFee,\r\n        gstOnBase,\r\n        gstOnPlatform,\r\n        gatewayFee,\r\n        gstOnGateway,\r\n        gstTotal,\r\n        finalPrice,\r\n    };\r\n};\r\n\r\n// Helper function to format INR currency\r\nexport const formatINR = (val: number) =>\r\n    val.toLocaleString(\"en-IN\", {\r\n        style: \"currency\",\r\n        currency: \"INR\",\r\n        minimumFractionDigits: 0,\r\n    });\r\n\r\n// Optional: Function to calculate total price for multiple rooms/nights\r\nexport const calculateTotalPrice = (\r\n    basePrice: number,\r\n    roomsCount: number = 1,\r\n    nights: number = 1\r\n) => {\r\n    const breakdown = calculatePriceBreakdown(basePrice);\r\n    const perRoomFinal = breakdown.finalPrice;\r\n    const perRoomBase = breakdown.basePrice;\r\n    const perRoomPlatform = breakdown.platformFee;\r\n    const perRoomGstTotal = breakdown.gstTotal;\r\n\r\n    const multiplier = roomsCount * nights;\r\n\r\n    return {\r\n        ...breakdown,\r\n        totalBase: +(perRoomBase * multiplier),\r\n        totalPlatform: +(perRoomPlatform * multiplier),\r\n        totalGst: +(perRoomGstTotal * multiplier),\r\n        totalFinal: +(perRoomFinal * multiplier),\r\n    };\r\n};\r\n\r\nexport const calculatePriceBreakdown1 = (\r\n    basePrice: number,\r\n    mealPlanPrice: number = 0,\r\n    discounts: {\r\n        hotelDiscountValue: number;\r\n        hotelDiscountType: 'percentage' | 'flat' | null;\r\n        couponApplied: boolean;\r\n        couponValue: number;\r\n    }\r\n) => {\r\n    const numericBase = Number(basePrice) || 0;\r\n    const numericMeal = Number(mealPlanPrice) || 0;\r\n\r\n    if (!numericBase || numericBase <= 0) {\r\n        return {\r\n            basePrice: 0,\r\n            mealPlanPrice: 0,\r\n            gstOnBase: 0,\r\n            platformFee: 0,\r\n            gstOnPlatform: 0,\r\n            convenienceFee: 0,\r\n            gstOnConvenience: 0,\r\n            totalWithoutDiscount: 0,\r\n            hotelDiscount: 0,\r\n            couponDiscount: 0,\r\n            totalDiscount: 0,\r\n            finalPrice: 0,\r\n        };\r\n    }\r\n\r\n    // Total taxable value (base + meal plan)\r\n    const totalTaxableValue = numericBase + numericMeal;\r\n\r\n    // 1. GST on base + meal (5%)\r\n    const gstOnBase = totalTaxableValue * 0.05;\r\n\r\n    // Amount after base GST\r\n    const amountAfterBaseGst = totalTaxableValue + gstOnBase;\r\n\r\n    // 2. Platform fee (13% on base + GST)\r\n    const platformFee = amountAfterBaseGst * 0.13;\r\n\r\n    // 3. GST on platform fee (18%)\r\n    const gstOnPlatform = platformFee * 0.18;\r\n\r\n    // 4. Subtotal before convenience\r\n    const subtotalBeforeConvenience =\r\n        totalTaxableValue + gstOnBase + platformFee + gstOnPlatform;\r\n\r\n    // Split into two parts: 1.6% and 0.3% (total 1.9%)\r\n    // Part 1: 1.6%\r\n    const convenienceFeePart1 = subtotalBeforeConvenience * 0.016;\r\n    const gstOnConveniencePart1 = convenienceFeePart1 * 0.18;\r\n    \r\n    // Part 2: 0.3% (calculated on amount after part 1)\r\n    const amountAfterPart1 = subtotalBeforeConvenience + convenienceFeePart1 + gstOnConveniencePart1;\r\n    const convenienceFeePart2 = amountAfterPart1 * 0.003;\r\n    const gstOnConveniencePart2 = convenienceFeePart2 * 0.18;\r\n    \r\n    // Total convenience fee and GST (backward compatible)\r\n    const convenienceFee = convenienceFeePart1 + convenienceFeePart2;\r\n    const gstOnConvenience = gstOnConveniencePart1 + gstOnConveniencePart2;\r\n\r\n    // 7. Total without discount\r\n    const totalWithoutDiscount =\r\n        subtotalBeforeConvenience + convenienceFee + gstOnConvenience;\r\n\r\n    // Calculate hotel discount\r\n    let hotelDiscount = 0;\r\n    if (discounts.hotelDiscountValue > 0 && discounts.hotelDiscountType) {\r\n        if (discounts.hotelDiscountType === 'percentage') {\r\n            // Percentage discount on total without discount\r\n            hotelDiscount = totalWithoutDiscount * (discounts.hotelDiscountValue / 100);\r\n        } else {\r\n            // Flat discount\r\n            hotelDiscount = Math.min(discounts.hotelDiscountValue, totalWithoutDiscount);\r\n        }\r\n    }\r\n\r\n    // Calculate coupon discount (5% on total without discount)\r\n    let couponDiscount = 0;\r\n    if (discounts.couponApplied) {\r\n        couponDiscount = totalWithoutDiscount * discounts.couponValue;\r\n    }\r\n\r\n    // Total discount\r\n    const totalDiscount = hotelDiscount + couponDiscount;\r\n\r\n    // Final price = total without discount - discounts\r\n    const finalPrice = totalWithoutDiscount - totalDiscount;\r\n\r\n    return {\r\n        basePrice: numericBase,\r\n        mealPlanPrice: numericMeal,\r\n        gstOnBase,\r\n        platformFee,\r\n        gstOnPlatform,\r\n        convenienceFee,\r\n        gstOnConvenience,\r\n        totalWithoutDiscount,\r\n        hotelDiscount,\r\n        couponDiscount,\r\n        totalDiscount,\r\n        finalPrice,\r\n    };\r\n};\r\n\r\nexport const round2 = (n: number) => Math.round(n * 100) / 100;\r\n\r\nexport const calculateInvoiceBreakdown = (finalAmount: number) => {\r\n    const discountPercentage = 0.05; // 5% discount\r\n    const serviceChargePercentage = 0.13; // 13% of Base Price WITH GST\r\n    const convenienceFeePercentages = [0.016, 0.003]; // 1.6%, 0.3% (total 1.9%)\r\n\r\n    // Step 1: Calculate subtotal before discount\r\n    const subtotalBeforeDiscount = round2(finalAmount / (1 - discountPercentage));\r\n    const discountAmount = round2(subtotalBeforeDiscount * discountPercentage);\r\n\r\n    // Step 2: Find Base Price iteratively\r\n    let basePriceExclGST = round2(subtotalBeforeDiscount / 1.23965);\r\n    \r\n    // Adjust the divisor for 1.9% instead of 3.8%\r\n    basePriceExclGST = round2(basePriceExclGST * (3.8 / 1.9)); // Adjust for lower percentage\r\n    \r\n    // Iterate to refine the calculation due to sequential fees\r\n    for (let i = 0; i < 5; i++) {\r\n        const baseCGST = round2(basePriceExclGST * 0.025);\r\n        const baseSGST = round2(basePriceExclGST * 0.025);\r\n        const baseTotal = round2(basePriceExclGST + baseCGST + baseSGST);\r\n\r\n        const serviceChargesExclGST = round2(baseTotal * serviceChargePercentage);\r\n        const serviceCGST = round2(serviceChargesExclGST * 0.09);\r\n        const serviceSGST = round2(serviceChargesExclGST * 0.09);\r\n        const serviceTotal = round2(serviceChargesExclGST + serviceCGST + serviceSGST);\r\n\r\n        // Calculate sequential convenience fees\r\n        let currentAmount = baseTotal + serviceTotal;\r\n        let totalConvenienceExclGST = 0;\r\n        let totalConvenienceCGST = 0;\r\n        let totalConvenienceSGST = 0;\r\n        \r\n        for (const percentage of convenienceFeePercentages) {\r\n            const convenienceExclGST = round2(currentAmount * percentage);\r\n            const convenienceCGST = round2(convenienceExclGST * 0.09);\r\n            const convenienceSGST = round2(convenienceExclGST * 0.09);\r\n            \r\n            totalConvenienceExclGST += convenienceExclGST;\r\n            totalConvenienceCGST += convenienceCGST;\r\n            totalConvenienceSGST += convenienceSGST;\r\n            \r\n            currentAmount += convenienceExclGST + convenienceCGST + convenienceSGST;\r\n        }\r\n        \r\n        const convenienceTotal = round2(totalConvenienceExclGST + totalConvenienceCGST + totalConvenienceSGST);\r\n        const calculatedSubtotal = round2(baseTotal + serviceTotal + convenienceTotal);\r\n        const calculatedFinal = round2(calculatedSubtotal * (1 - discountPercentage));\r\n        \r\n        // Adjust base price\r\n        basePriceExclGST = round2(basePriceExclGST * (finalAmount / calculatedFinal));\r\n    }\r\n\r\n    // Final calculation with refined base price\r\n    const baseCGST = round2(basePriceExclGST * 0.025);\r\n    const baseSGST = round2(basePriceExclGST * 0.025);\r\n    const baseTotal = round2(basePriceExclGST + baseCGST + baseSGST);\r\n\r\n    const serviceChargesExclGST = round2(baseTotal * serviceChargePercentage);\r\n    const serviceCGST = round2(serviceChargesExclGST * 0.09);\r\n    const serviceSGST = round2(serviceChargesExclGST * 0.09);\r\n    const serviceTotal = round2(serviceChargesExclGST + serviceCGST + serviceSGST);\r\n\r\n    // Calculate sequential convenience fees\r\n    let currentAmount = baseTotal + serviceTotal;\r\n    let totalConvenienceExclGST = 0;\r\n    let totalConvenienceCGST = 0;\r\n    let totalConvenienceSGST = 0;\r\n    \r\n    for (const percentage of convenienceFeePercentages) {\r\n        const convenienceExclGST = round2(currentAmount * percentage);\r\n        const convenienceCGST = round2(convenienceExclGST * 0.09);\r\n        const convenienceSGST = round2(convenienceExclGST * 0.09);\r\n        \r\n        totalConvenienceExclGST += convenienceExclGST;\r\n        totalConvenienceCGST += convenienceCGST;\r\n        totalConvenienceSGST += convenienceSGST;\r\n        \r\n        currentAmount += convenienceExclGST + convenienceCGST + convenienceSGST;\r\n    }\r\n    \r\n    const convenienceTotal = round2(totalConvenienceExclGST + totalConvenienceCGST + totalConvenienceSGST);\r\n\r\n    // Recalculate subtotal to ensure accuracy\r\n    const calculatedSubtotal = round2(baseTotal + serviceTotal + convenienceTotal);\r\n    const calculatedDiscount = round2(calculatedSubtotal * discountPercentage);\r\n    const calculatedFinal = round2(calculatedSubtotal - calculatedDiscount);\r\n\r\n    return {\r\n        basePrice: basePriceExclGST,\r\n        baseCGST: baseCGST,\r\n        baseSGST: baseSGST,\r\n        baseTotal: baseTotal,\r\n        serviceCharges: serviceChargesExclGST,\r\n        serviceCGST: serviceCGST,\r\n        serviceSGST: serviceSGST,\r\n        serviceTotal: serviceTotal,\r\n        convenienceFee: totalConvenienceExclGST, // Backward compatible\r\n        convenienceCGST: totalConvenienceCGST,\r\n        convenienceSGST: totalConvenienceSGST,\r\n        convenienceTotal: convenienceTotal,\r\n        subtotalBeforeDiscount: calculatedSubtotal,\r\n        discountAmount: calculatedDiscount,\r\n        finalAmount: calculatedFinal,\r\n        totalCGST: round2(baseCGST + serviceCGST + totalConvenienceCGST),\r\n        totalSGST: round2(baseSGST + serviceSGST + totalConvenienceSGST),\r\n        totalGST: round2(baseCGST + baseSGST + serviceCGST + serviceSGST + totalConvenienceCGST + totalConvenienceSGST),\r\n        totalTaxable: round2(basePriceExclGST + serviceChargesExclGST + totalConvenienceExclGST),\r\n    };\r\n};\r\n\r\nexport const reversePriceBreakup = (finalAmount: number) => {\r\n    // Adjust multiplier for 1.9% instead of 3.8%\r\n    const multiplier = 1.2156862745 * (1.9 / 3.8); // Scale down for lower percentage\r\n    let basePrice = finalAmount / multiplier; // Start with approximate multiplier\r\n    \r\n    // Iterate to refine the calculation\r\n    for (let i = 0; i < 10; i++) {\r\n        const gstOnBase = basePrice * 0.05;\r\n        const commission = basePrice * 0.13;\r\n        const gstOnCommission = commission * 0.18;\r\n        \r\n        // Calculate sequential convenience fees\r\n        let core = basePrice + gstOnBase + commission + gstOnCommission;\r\n        \r\n        // Part 1: 1.6%\r\n        const convenienceFee1 = core * 0.016;\r\n        const gstOnConvenience1 = convenienceFee1 * 0.18;\r\n        core += convenienceFee1 + gstOnConvenience1;\r\n        \r\n        // Part 2: 0.3%\r\n        const convenienceFee2 = core * 0.003;\r\n        const gstOnConvenience2 = convenienceFee2 * 0.18;\r\n        core += convenienceFee2 + gstOnConvenience2;\r\n        \r\n        // No third part (1.9%)\r\n        \r\n        const totalCheck = basePrice + gstOnBase + commission + gstOnCommission + \r\n                          convenienceFee1 + gstOnConvenience1 + \r\n                          convenienceFee2 + gstOnConvenience2;\r\n        \r\n        // Adjust base price\r\n        basePrice = basePrice * (finalAmount / totalCheck);\r\n        \r\n        // Break if close enough\r\n        if (Math.abs(finalAmount - totalCheck) < 0.01) break;\r\n    }\r\n\r\n    // Final calculation\r\n    const gstOnBase = basePrice * 0.05;\r\n    const commission = basePrice * 0.13;\r\n    const gstOnCommission = commission * 0.18;\r\n    \r\n    let core = basePrice + gstOnBase + commission + gstOnCommission;\r\n    \r\n    const convenienceFee1 = core * 0.016;\r\n    const gstOnConvenience1 = convenienceFee1 * 0.18;\r\n    core += convenienceFee1 + gstOnConvenience1;\r\n    \r\n    const convenienceFee2 = core * 0.003;\r\n    const gstOnConvenience2 = convenienceFee2 * 0.18;\r\n    \r\n    // Total convenience fee for backward compatibility\r\n    const convenienceFee = convenienceFee1 + convenienceFee2;\r\n    const gstOnConvenience = gstOnConvenience1 + gstOnConvenience2;\r\n    \r\n    const totalCheck = basePrice + gstOnBase + commission + gstOnCommission + \r\n                       convenienceFee + gstOnConvenience;\r\n\r\n    return {\r\n        basePrice: Math.round(basePrice),\r\n        gstOnBase,\r\n        commission,\r\n        gstOnCommission,\r\n        convenienceFee, // Backward compatible\r\n        gstOnConvenience, // Backward compatible\r\n        totalCheck: basePrice + gstOnBase + commission + gstOnCommission + convenienceFee + gstOnConvenience\r\n    };\r\n};"],"names":["calculatePriceBreakdown","basePrice","numericBase","Number","platformFee","gstOnBase","gstOnPlatform","gatewayFee","gstOnGateway","gstTotal","finalPrice","amountBeforeGateway","gatewayFeePart1","gstOnGatewayPart1","gatewayFeePart2","calculatePriceBreakdown1","mealPlanPrice","arguments","length","undefined","discounts","numericMeal","convenienceFee","gstOnConvenience","totalWithoutDiscount","hotelDiscount","couponDiscount","totalDiscount","totalTaxableValue","subtotalBeforeConvenience","convenienceFeePart1","gstOnConveniencePart1","convenienceFeePart2","hotelDiscountValue","hotelDiscountType","Math","min","couponApplied","couponValue","round2","n","round","calculateInvoiceBreakdown","finalAmount","discountPercentage","convenienceFeePercentages","subtotalBeforeDiscount","basePriceExclGST","i","baseCGST","baseSGST","baseTotal","serviceChargesExclGST","serviceCGST","serviceSGST","serviceTotal","currentAmount","totalConvenienceExclGST","totalConvenienceCGST","totalConvenienceSGST","percentage","convenienceExclGST","convenienceCGST","convenienceSGST","convenienceTotal","calculatedSubtotal","calculatedFinal","calculatedDiscount","serviceCharges","discountAmount","totalCGST","totalSGST","totalGST","totalTaxable","reversePriceBreakup","commission","gstOnCommission","core","convenienceFee1","gstOnConvenience1","convenienceFee2","gstOnConvenience2","totalCheck","abs"],"ignoreList":[],"sourceRoot":""}