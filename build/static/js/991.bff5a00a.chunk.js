"use strict";(self.webpackChunkhuts4u=self.webpackChunkhuts4u||[]).push([[991],{70141:(e,o,t)=>{t.d(o,{A:()=>r});var s=t(59662),i=t(70579);const r=(0,s.A)((0,i.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},74991:(e,o,t)=>{t.r(o),t.d(o,{default:()=>Me});var s=t(89379),i=t(7353),r=t(12110),n=t(26494),l=t(94496),a=t(14194),d=t(11906),c=t(36591),u=t(67784),x=t(17392),m=t(53193),h=t(79190),p=t(57465),f=t(32143),v=t(43845),g=t(81637),A=t(77739),b=t(74605),y=t(80045),j=t(65043),S=t(58387),C=t(98610),k=t(39768),D=t(33064),I=t(59662),z=t(70579);const R=(0,I.A)((0,z.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),T=(0,I.A)((0,z.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),w=(0,I.A)((0,z.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var Y=t(6803),M=t(61475),P=t(92532),F=t(72372);function N(e){return(0,F.Ay)("MuiCheckbox",e)}const G=(0,P.A)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]);var W=t(34535),H=t(56262),O=t(52445),V=t(98206),B=t(81139),_=t(4162);const E=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","disableRipple","className","slots","slotProps"],L=(0,W.Ay)(D.A,{shouldForwardProp:e=>(0,M.A)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:t}=e;return[o.root,t.indeterminate&&o.indeterminate,o["size".concat((0,Y.A)(t.size))],"default"!==t.color&&o["color".concat((0,Y.A)(t.color))]]}})((0,H.A)(e=>{let{theme:o}=e;return{color:(o.vars||o).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:o.vars?"rgba(".concat(o.vars.palette.action.activeChannel," / ").concat(o.vars.palette.action.hoverOpacity,")"):(0,k.X4)(o.palette.action.active,o.palette.action.hoverOpacity)}}},...Object.entries(o.palette).filter((0,O.A)()).map(e=>{let[t]=e;return{props:{color:t,disableRipple:!1},style:{"&:hover":{backgroundColor:o.vars?"rgba(".concat(o.vars.palette[t].mainChannel," / ").concat(o.vars.palette.action.hoverOpacity,")"):(0,k.X4)(o.palette[t].main,o.palette.action.hoverOpacity)}}}}),...Object.entries(o.palette).filter((0,O.A)()).map(e=>{let[t]=e;return{props:{color:t},style:{["&.".concat(G.checked,", &.").concat(G.indeterminate)]:{color:(o.vars||o).palette[t].main},["&.".concat(G.disabled)]:{color:(o.vars||o).palette.action.disabled}}}}),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}})),X=(0,z.jsx)(T,{}),U=(0,z.jsx)(R,{}),Z=(0,z.jsx)(w,{}),q=j.forwardRef(function(e,o){var t,i,r;const n=(0,V.b)({props:e,name:"MuiCheckbox"}),{checkedIcon:l=X,color:a="primary",icon:d=U,indeterminate:c=!1,indeterminateIcon:u=Z,inputProps:x,size:m="medium",disableRipple:h=!1,className:p,slots:f={},slotProps:v={}}=n,g=(0,y.A)(n,E),A=c?u:d,b=c?u:l,k=(0,s.A)((0,s.A)({},n),{},{disableRipple:h,color:a,indeterminate:c,size:m}),D=(e=>{const{classes:o,indeterminate:t,color:i,size:r}=e,n={root:["root",t&&"indeterminate","color".concat((0,Y.A)(i)),"size".concat((0,Y.A)(r))]},l=(0,C.A)(n,N,o);return(0,s.A)((0,s.A)({},o),l)})(k),I=null!==(t=v.input)&&void 0!==t?t:x,[R,T]=(0,_.A)("root",{ref:o,elementType:L,className:(0,S.A)(D.root,p),shouldForwardComponentProp:!0,externalForwardedProps:(0,s.A)({slots:f,slotProps:v},g),ownerState:k,additionalProps:{type:"checkbox",icon:j.cloneElement(A,{fontSize:null!==(i=A.props.fontSize)&&void 0!==i?i:m}),checkedIcon:j.cloneElement(b,{fontSize:null!==(r=b.props.fontSize)&&void 0!==r?r:m}),disableRipple:h,slots:f,slotProps:{input:(0,B.A)("function"===typeof I?I(k):I,{"data-indeterminate":c})}}});return(0,z.jsx)(R,(0,s.A)((0,s.A)({},T),{},{classes:D}))}),$=q;var J=t(39336),Q=t(83462),K=t(26600),ee=t(35316),oe=t(29347);const te=(0,I.A)((0,z.jsx)("path",{d:"M7.5 11C9.43 11 11 9.43 11 7.5S9.43 4 7.5 4 4 5.57 4 7.5 5.57 11 7.5 11m0-5C8.33 6 9 6.67 9 7.5S8.33 9 7.5 9 6 8.33 6 7.5 6.67 6 7.5 6M4.0025 18.5832 18.59 3.9955l1.4142 1.4143L5.4167 19.9974zM16.5 13c-1.93 0-3.5 1.57-3.5 3.5s1.57 3.5 3.5 3.5 3.5-1.57 3.5-3.5-1.57-3.5-3.5-3.5m0 5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"Percent"),se=(0,I.A)((0,z.jsx)("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4"}),"AttachMoney"),ie=(0,I.A)((0,z.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");var re=t(33438),ne=t(83560),le=t(86687),ae=t(15626),de=t(50103);const ce=(0,I.A)((0,z.jsx)("path",{d:"m21.41 11.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58s1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41s-.23-1.06-.59-1.42M5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7"}),"LocalOffer");var ue=t(98440),xe=t(84770);const me=(0,I.A)((0,z.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy"),he=(0,I.A)((0,z.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var pe=t(70141),fe=t(60446),ve=t.n(fe),ge=t(63516),Ae=t(17195),be=t.n(Ae),ye=t(73216),je=t(57488),Se=t(80899),Ce=t(31716),ke=t(33580),De=t(61968),Ie=t(82533),ze=t(69995),Re=t(88553),Te=t(75456),we=t(14434);const Ye=Se.Ik({name:Se.Yj().required("Guest name is required"),email:Se.Yj().email("Invalid email").optional(),phoneNumber:Se.Yj().required("Phone number is required").test("is-valid-phone","Enter a valid phone number",e=>{if(!e)return!1;return e.slice(2).length>=10})}),Me=()=>{var e,o,t,y,S,C,k,D;const I=(0,ye.zy)(),R=null===(e=I.state)||void 0===e?void 0:e.hotelData,T=null===(o=I.state)||void 0===o?void 0:o.selectedRoom,w=null===(t=I.state)||void 0===t?void 0:t.selectedSlot,Y=null===(y=I.state)||void 0===y?void 0:y.selectedMealPlan,M=(null===(S=I.state)||void 0===S?void 0:S.pricingDetails)||{},P=(null===(C=I.state)||void 0===C?void 0:C.inventoryData)||[],F=new URLSearchParams(I.search),N=F.get("bookingType"),G=F.get("time"),W=F.get("checkinDate"),H=F.get("checkOutDate"),O=F.get("rooms"),V=F.get("adults"),B=F.get("children"),[_,E]=(0,j.useState)(N),[L,X]=(0,j.useState)(G||"12:00"),[U,Z]=(0,j.useState)(W||ve()().format("YYYY-MM-DD")),[q,fe]=(0,j.useState)(H||ve()().add(1,"day").format("YYYY-MM-DD")),[Ae,Se]=(0,j.useState)(O||"1"),[Me,Fe]=(0,j.useState)(V||"1"),[Ne,Ge]=(0,j.useState)(B||"0"),[We,He]=(0,j.useState)(!1),[Oe,Ve]=(0,j.useState)(!1),[Be,_e]=(0,j.useState)(!1),[Ee,Le]=(0,j.useState)(!1),[Xe,Ue]=(0,j.useState)(W||ve()().format("YYYY-MM-DD")),[Ze,qe]=(0,j.useState)(H||ve()().add(1,"day").format("YYYY-MM-DD")),[$e,Je]=(0,j.useState)(G||"12:00"),Qe=null===w||void 0===w?void 0:w.slot,Ke=null===Qe||void 0===Qe||null===(k=Qe.match(/\d+/))||void 0===k?void 0:k[0],eo=Ke?parseInt(Ke,10):3,[oo,to]=(0,j.useState)(eo),[so,io]=(0,j.useState)(eo),[ro,no]=(0,j.useState)({}),[lo,ao]=(0,j.useState)(!1),[co,uo]=(0,j.useState)({phone:"",name:"",email:"",token:""}),[xo,mo]=(0,j.useState)(null),[ho,po]=(0,j.useState)(!1),[fo,vo]=(0,j.useState)(!1),[go,Ao]=(0,j.useState)([]),[bo,yo]=(0,j.useState)(!1),[jo,So]=(0,j.useState)(!1),[Co,ko]=(0,j.useState)(null),[Do,Io]=(0,j.useState)("HUTS4U"),[zo,Ro]=(0,j.useState)(!0),[To]=(0,j.useState)(.05),[wo,Yo]=(0,j.useState)(null),[Mo,Po]=(0,j.useState)(!1),[Fo,No]=(0,j.useState)(""),[Go,Wo]=(0,j.useState)(""),[Ho,Oo]=(0,j.useState)(""),[Vo,Bo]=(0,j.useState)("none"),[_o,Eo]=(0,j.useState)(!1),[Lo,Xo]=(0,j.useState)([]),[Uo,Zo]=(0,j.useState)(null),[qo,$o]=(0,j.useState)(!1),[Jo,Qo]=(0,j.useState)(!1),[Ko,et]=(0,j.useState)(null),[ot,tt]=(0,j.useState)(null),[st,it]=(0,j.useState)(Y||"EP"),[rt,nt]=(0,j.useState)((null===M||void 0===M?void 0:M.mealPlanPrice)||0),[lt,at]=(0,j.useState)((null===M||void 0===M?void 0:M.mealPlanDescription)||""),dt=(0,j.useRef)(null),ct=(0,j.useRef)(null),ut=(0,j.useRef)(null),xt=((e,o,t,s)=>{let i=0,r=0,n=0;const l=[];if(e<=0)return{requiredRooms:1,extraGuestCount:0,extraGuestCharge:0,guestsPerRoom:[0]};i=Math.ceil(e/t);let a=e;for(let c=0;c<i;c++)a>=o?(l[c]=o,a-=o):(l[c]=a,a=0);let d=0;for(;a>0&&d<i;)l[d]<t&&(l[d]+=1,a-=1),d++,d>=i&&a>0&&(d=0);return l.forEach(e=>{if(e>o){const t=e-o;r+=t,n+=t*s}}),{requiredRooms:i,extraGuestCount:r,extraGuestCharge:n,guestsPerRoom:l}})(Number(Me)+Number(Ne),(null===T||void 0===T?void 0:T.standardRoomOccupancy)||1,(null===T||void 0===T?void 0:T.maxRoomOccupancy)||1,(null===T||void 0===T?void 0:T.additionalGuestRate)||0),{requiredRooms:mt,extraGuestCount:ht,extraGuestCharge:pt,guestsPerRoom:ft}=xt,vt=(()=>{var e;if(!T)return{isAvailable:!1,message:"Room information is missing"};const o=null===(e=T.status)||void 0===e?void 0:e.toLowerCase();return"available"===o||"active"===o?{isAvailable:!0,message:"Available"}:{isAvailable:!1,message:"This room is currently not available"}})(),gt=Number((e=>{if(!T||!U||!e)return 0;const o=ve()(U).format("YYYY-MM-DD"),t=null===P||void 0===P?void 0:P.find(e=>ve()(e.date).format("YYYY-MM-DD")===o);if(!t)switch(e){case"rateFor1Night":return T.rateFor1Night||0;case"rateFor3Hour":return T.rateFor3Hour||0;case"rateFor6Hour":return T.rateFor6Hour||0;case"rateFor12Hour":return T.rateFor12Hour||0;default:return 0}switch(e){case"rateFor1Night":return t.overnightRate||T.rateFor1Night||0;case"rateFor3Hour":return t.threeHourRate||T.rateFor3Hour||0;case"rateFor6Hour":return t.sixHourRate||T.rateFor6Hour||0;case"rateFor12Hour":return t.twelveHourRate||T.rateFor12Hour||0;default:return 0}})((()=>{if("hourly"!==_)return"rateFor1Night";switch(oo){case 3:default:return"rateFor3Hour";case 6:return"rateFor6Hour";case 12:return"rateFor12Hour"}})()));(0,j.useEffect)(()=>{Number(Ae)!==mt&&Se(mt.toString())},[Me,Ne,T]),(0,j.useEffect)(()=>{null!==R&&void 0!==R&&R.id&&At()},[null===R||void 0===R?void 0:R.id]),(0,j.useEffect)(()=>{M&&(tt(M),M.mealPlanPrice&&nt(M.mealPlanPrice),M.mealPlanDescription&&at(M.mealPlanDescription))},[M]);const At=async()=>{if(null!==R&&void 0!==R&&R.id){yo(!0);try{var e,o,t;const s={data:{filter:"",hotelId:parseInt(R.id),isActive:!0},page:0,pageSize:1e3,order:[["createdAt","ASC"]]},i=await(0,ze.cz)(s);let r=[];if(null!==i&&void 0!==i&&null!==(e=i.data)&&void 0!==e&&null!==(o=e.data)&&void 0!==o&&o.rows?r=i.data.data.rows:null!==i&&void 0!==i&&null!==(t=i.data)&&void 0!==t&&t.data?r=i.data.data:null!==i&&void 0!==i&&i.data&&(r=Array.isArray(i.data)?i.data:[i.data]),Ao(r),r.length>0){const e=r[0];ko({id:e.id,hotelId:e.hotelId,roomId:e.roomId,discountType:e.discountType,discountValue:parseFloat(e.discountValue)||0,isActive:e.isActive}),So(!0),je.oR.success("Hotel discount applied: ".concat(e.discountValue).concat("percentage"===e.discountType?"%":"\u20b9"," off"))}}catch(s){console.error("Error fetching hotel discounts:",s),je.oR.error("Failed to load hotel discounts")}finally{yo(!1)}}};(0,j.useEffect)(()=>{(0,Ie.M3)()&&bt()},[]);const bt=async()=>{try{var e;const o=await(0,ze.E$)(),t=null===o||void 0===o||null===(e=o.data)||void 0===e?void 0:e.data;no(t),null!==t&&void 0!==t&&t._id&&yt(t._id)}catch(o){je.oR.error("Failed to load user profile")}},yt=async e=>{if(e){$o(!0);try{var o;const t=await(0,ze.dt)(e);let i=[];null!==t&&void 0!==t&&null!==(o=t.data)&&void 0!==o&&o.data&&Array.isArray(t.data.data)?i=t.data.data:Array.isArray(null===t||void 0===t?void 0:t.data)&&(i=t.data);const r=i.map(e=>e.gst_detail&&"object"===typeof e.gst_detail?(0,s.A)((0,s.A)({},e.gst_detail),{},{mappingId:e.id,userId:e.userId,gstId:e.gstId,isPrimary:e.isPrimary||!1,mappingCreatedAt:e.createdAt,mappingUpdatedAt:e.updatedAt}):e);Xo(r);const n=r.filter(e=>!0===e.verified||"Active"===e.gstStatus);if(n.length>0){const e=n[0];Zo(e),No(e.gstNumber||""),Wo(e.legalName||e.tradeName||""),Oo(e.address||""),Bo("verified"),Po(!0),je.oR.success("Auto-selected GST: ".concat(e.gstNumber))}else r.length>0&&Po(!0)}catch(t){console.error("Error loading GST records:",t)}finally{$o(!1)}}},jt=e=>{Zo(e),No(e.gstNumber||""),Wo(e.legalName||""),Oo(e.address||""),Bo(!0===e.verified||"Active"===e.gstStatus?"verified":"none"),Qo(!1),je.oR.success("Selected GSTIN: ".concat(e.gstNumber))},St=()=>{Zo(null),No(""),Wo(""),Oo(""),Bo("none"),Qo(!1),je.oR.info("GST selection cleared")},Ct=()=>{if(!U||!q)return 1;const e=ve()(U,"YYYY-MM-DD",!0),o=ve()(q,"YYYY-MM-DD",!0);if(!e.isValid()||!o.isValid())return 1;const t=o.diff(e,"day");return Math.max(1,t)},kt=Ct(),Dt=(()=>{if(ot&&!Oe&&!Be&&!Ee){let e;if("hourly"===_){e=mt*(oo/3)}else e=mt*kt;const o=rt*mt*("hourly"===_?1:kt),t=(ot.basePrice,(0,we.Sr)(ot.basePrice||0,o,{hotelDiscountValue:jo&&(null===Co||void 0===Co?void 0:Co.discountValue)||0,hotelDiscountType:jo&&(null===Co||void 0===Co?void 0:Co.discountType)||null,couponApplied:zo,couponValue:.05}));return(0,s.A)((0,s.A)({},t),{},{nights:kt,totalMultiplier:e,bookingType:_,slotDuration:oo,requiredRooms:mt,unitBase:(ot.basePrice||0)/mt/("hourly"===_?oo/3:kt),totalMealPlanPrice:o,mealPlanDescription:lt})}let e;if("hourly"===_){e=mt*(oo/3)}else e=mt*kt;const o=gt*e,t=rt*mt*("hourly"===_?1:kt),i=(0,we.Sr)(o,t,{hotelDiscountValue:jo&&(null===Co||void 0===Co?void 0:Co.discountValue)||0,hotelDiscountType:jo&&(null===Co||void 0===Co?void 0:Co.discountType)||null,couponApplied:zo,couponValue:.05});return(0,s.A)((0,s.A)({},i),{},{nights:kt,totalMultiplier:e,bookingType:_,slotDuration:oo,requiredRooms:mt,unitBase:gt,totalMealPlanPrice:t,mealPlanDescription:lt})})(),{basePrice:It,mealPlanPrice:zt,gstOnBase:Rt,platformFee:Tt,gstOnPlatform:wt,convenienceFee:Yt,gstOnConvenience:Mt,totalWithoutDiscount:Pt,hotelDiscount:Ft,couponDiscount:Nt,totalDiscount:Gt,finalPrice:Wt,unitBase:Ht,mealPlanDescription:Ot}=Dt,Vt=It+zt,Bt=Vt+Tt,_t=Rt+wt+Yt+Mt,Et=Number(Wt.toFixed(2)),Lt=Tt,Xt=wt/2,Ut=wt/2,Zt=Yt+Mt,qt=Et,$t=async()=>{try{var e,o;if(!qt||qt<=0)return void je.oR.error("Booking amount cannot be zero.");const t=(null===R||void 0===R?void 0:R.id)||(null===R||void 0===R?void 0:R._id);if(!t)return void je.oR.error("Hotel information is missing");let i=null;"verified"===Vo&&Fo&&(i={gstNumber:Fo,legalName:Go,address:Ho,verified:!0,gstRecordId:(null===Uo||void 0===Uo?void 0:Uo.id)||(null===Uo||void 0===Uo?void 0:Uo._id),gstStatus:(null===Uo||void 0===Uo?void 0:Uo.gstStatus)||"Active"});const r={hotelDiscount:jo?{discountId:null===Co||void 0===Co?void 0:Co.id,discountType:null===Co||void 0===Co?void 0:Co.discountType,discountValue:null===Co||void 0===Co?void 0:Co.discountValue,discountAmount:Ft}:null,couponDiscount:zo?{couponCode:Do,discountValue:.05,discountAmount:Nt}:null,totalDiscount:Gt},n=(0,s.A)((0,s.A)({},Dt),{},{nights:kt,rooms:mt.toString(),adults:Me,children:Ne,bookingType:_,checkinDate:U,checkOutDate:q,checkinTime:L,slotDuration:oo,extraGuestCount:ht,extraGuestCharge:pt,guestsPerRoom:ft,inventoryData:P,unitBase:Ht,mealPlan:st,mealPlanPrice:zt,mealPlanDescription:Ot,finalPrice:Et,grandTotal:Math.round(qt)}),l={name:Qt.values.name,email:Qt.values.email||"guest@huts4u.com",phoneNumber:Qt.values.phoneNumber},a=ss(),d={amount:Math.round(qt),order_currency:"INR",customerName:Qt.values.name,customerEmail:Qt.values.email||"guest@huts4u.com",customerPhone:Qt.values.phoneNumber,order_meta:{return_url:"".concat(window.location.origin,"/payment/return")},order_note:"Hotel Booking",booking_data:{gstDetails:i,discountDetails:r,bookingType:_,hotelId:t,roomId:(null===T||void 0===T?void 0:T.id)||(null===T||void 0===T?void 0:T._id),mealPlan:st,mealPlanPrice:zt,checkinDate:U,checkOutDate:q,checkinTime:L,slotDuration:oo,rooms:mt,adults:Me,children:Ne,extraGuestCount:ht,extraGuestCharge:pt,guestsPerRoom:ft}};He(!0);const c=await(0,ze.fS)(d),{orderId:u,paymentSessionId:x}=(null===c||void 0===c||null===(e=c.data)||void 0===e?void 0:e.data)||{};if(!u||!x)return void je.oR.error("Failed to create Cashfree order");const m={orderId:u,paymentSessionId:x,orderDetails:null===c||void 0===c||null===(o=c.data)||void 0===o?void 0:o.data,bookingDetails:{hotel:{id:(null===R||void 0===R?void 0:R.id)||(null===R||void 0===R?void 0:R._id),propertyName:null===R||void 0===R?void 0:R.propertyName,address:null===R||void 0===R?void 0:R.address,propertyImages:null===R||void 0===R?void 0:R.propertyImages,receptionEmail:null===R||void 0===R?void 0:R.receptionEmail,receptionMobile:null===R||void 0===R?void 0:R.receptionMobile},room:{id:(null===T||void 0===T?void 0:T.id)||(null===T||void 0===T?void 0:T._id),roomCategory:null===T||void 0===T?void 0:T.roomCategory,standardRoomOccupancy:null===T||void 0===T?void 0:T.standardRoomOccupancy,maxRoomOccupancy:null===T||void 0===T?void 0:T.maxRoomOccupancy,additionalGuestRate:null===T||void 0===T?void 0:T.additionalGuestRate},guestInfo:l,gstDetails:i,discountDetails:r,timing:a,pricingDetails:n,bookingType:_,checkinDate:U,checkOutDate:q,checkinTime:L,slotDuration:oo,rooms:mt,adults:Me,children:Ne,extraGuestCount:ht,extraGuestCharge:pt,guestsPerRoom:ft,inventoryData:P,mealPlan:st,mealPlanPrice:zt,mealPlanDescription:Ot,customerDetails:{customer_name:Qt.values.name,customer_email:Qt.values.email||"guest@huts4u.com",customer_phone:Qt.values.phoneNumber},amount:Math.round(qt)},originalPayload:d};sessionStorage.setItem("cashfree_booking_data",JSON.stringify(m));const h=new window.Cashfree({mode:"production"});await h.checkout({paymentSessionId:x,redirectTarget:"_modal",theme:{primaryColor:"#6A1B9A",secondaryColor:"#9C27B0",textColor:"#FFFFFF",backgroundColor:"#FFFFFF"}}),setTimeout(()=>{window.location.href="/payment/return?order_id=".concat(u)},2e3)}catch(t){console.error("Cashfree Payment Error:",t),je.oR.error("Payment failed. Please try again.")}finally{He(!1)}},Jt=(0,ye.Zp)(),Qt=(0,ge.Wx)({initialValues:{name:ro.userName||"",email:ro.email||"",phoneNumber:ro.phoneNumber?"91".concat(ro.phoneNumber):"91"},validationSchema:Ye,enableReinitialize:!0,onSubmit:async e=>{if(Yo(null),vt.isAvailable){var o,t,s;if(!e.name.trim())return Yo("Guest name is required"),null===(o=dt.current)||void 0===o||o.focus(),void(null===(t=dt.current)||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center"}));if(!e.phoneNumber||"91"===e.phoneNumber||e.phoneNumber.length<12)return Yo("Valid phone number is required"),void(null===(s=ct.current)||void 0===s||s.scrollIntoView({behavior:"smooth",block:"center"}));if(ho)if((0,Ie.M3)())await $t();else{const o={name:e.name,email:e.email,phone:e.phoneNumber.slice(2)};try{var i;const t=await(0,ze.AJ)(o);ao(!0),(0,je.oR)("OTP sent successfully. Please verify the OTP."),uo({phone:e.phoneNumber.slice(2),name:e.name,email:e.email,token:null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.data})}catch(r){console.log(r),je.oR.error("Failed to send OTP. Please try again.")}}else Yo("Please accept Terms & Conditions before proceeding.")}else Yo(vt.message)}}),Kt=async()=>{try{const o=(0,Ie.F6)(),t=(null===Uo||void 0===Uo?void 0:Uo.id)||(null===Uo||void 0===Uo?void 0:Uo._id);if(o&&t){var e;const s={userId:o},i=await(0,ze.yZ)(t,s);null!==i&&void 0!==i&&null!==(e=i.data)&&void 0!==e&&e.success&&(je.oR.success("GST record linked to your account!"),yt(o))}$t()}catch(o){console.error("Error updating GST with user ID:",o),je.oR.error("Could not link GST to account. Proceeding with payment..."),$t()}},es=(0,j.useRef)(null),[os,ts]=(0,j.useState)("auto"),ss=()=>{if("hourly"===_&&L&&U&&oo){const e=ve()("".concat(U," ").concat(L),"YYYY-MM-DD HH:mm"),o=e.add(oo,"hour");return{checkInDate:e.format("DD MMM YYYY"),checkInTime:e.format("hh:mm A"),checkOutDate:o.format("DD MMM YYYY"),checkOutTime:o.format("hh:mm A"),duration:"".concat(oo," hrs"),bookingType:"hourly"}}{const e=Ct();return{checkInDate:ve()(U,"YYYY-MM-DD").format("DD MMM YYYY"),checkInTime:"12:00 PM",checkOutDate:ve()(q,"YYYY-MM-DD").format("DD MMM YYYY"),checkOutTime:"11:00 AM",duration:"".concat(e," night").concat(e>1?"s":""),bookingType:"daily"}}};(0,j.useEffect)(()=>{es.current&&ts("".concat(es.current.clientHeight,"px"))},[R,kt,oo]);const is=(()=>{const e=[];for(let o=0;o<24;o++)for(let t=0;t<60;t+=30){const s="".concat(o.toString().padStart(2,"0"),":").concat(t.toString().padStart(2,"0"));e.push({value:s,label:ve()(s,"HH:mm").format("hh:mm A")})}return e})(),rs=()=>{const e=""!==Qt.values.name.trim(),o=Qt.values.phoneNumber&&"91"!==Qt.values.phoneNumber&&Qt.values.phoneNumber.length>=12,t=ho,s=vt.isAvailable;return e&&o&&t&&s},ns=(e,o)=>{Qt.setFieldValue(e,o),Qt.setFieldTouched(e,!0),wo&&Yo(null)},ls=()=>{const e=ve()(U).format("YYYY-MM-DD");return(null===P||void 0===P?void 0:P.find(o=>ve()(o.date).format("YYYY-MM-DD")===e))?"Dynamic Inventory Pricing":"Standard Rate"},as=e=>"percentage"===e?(0,z.jsx)(te,{}):(0,z.jsx)(se,{}),ds=e=>"percentage"===e?"% off":"\u20b9 off";return(0,z.jsxs)(i.A,{sx:(0,s.A)((0,s.A)({},De.VX),{},{background:"#f6f6f6",mt:0,py:4,px:{xs:1,md:3},display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:"center",gap:"20px"}),children:[(0,z.jsx)(r.A,{sx:{p:1,background:"white",maxWidth:"700px",border:"none",boxShadow:0,borderRadius:"12px"},children:(0,z.jsxs)(n.A,{children:[(0,z.jsx)(l.A,{variant:"h6",gutterBottom:!0,sx:{color:ke.A.firstColor,fontWeight:"bold"},children:"Your Booking Summary"}),!vt.isAvailable&&(0,z.jsxs)(a.A,{severity:"error",sx:{mb:2,borderRadius:2,"& .MuiAlert-message":{fontSize:"14px",fontWeight:500}},children:[vt.message,(0,z.jsx)(d.A,{variant:"outlined",size:"small",sx:{ml:2},onClick:()=>Jt(-1),children:"Go Back"})]}),(0,z.jsxs)(i.A,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:{xs:0,md:2},position:"relative",mt:2,height:"fit-content",alignItems:"stretch"},children:[(0,z.jsx)(c.A,{component:"img",sx:{width:{xs:"100%",md:"250px"},borderRadius:"12px",objectFit:"cover",height:os,transition:"height 0.3s ease"},image:null===R||void 0===R||null===(D=R.propertyImages)||void 0===D?void 0:D[0]}),(0,z.jsxs)("div",{style:{height:"fit-content"},ref:es,children:[(0,z.jsx)(l.A,{sx:{fontSize:"20px",fontWeight:600,color:ke.A.firstColor,mt:{xs:1.5,md:1},display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:1,WebkitBoxOrient:"vertical"},children:null===R||void 0===R?void 0:R.propertyName}),(0,z.jsx)(l.A,{sx:{fontFamily:"CustomFontSB",fontSize:{xs:"12px",md:"14px"},display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:1,WebkitBoxOrient:"vertical"},children:null===R||void 0===R?void 0:R.address}),(0,z.jsx)(l.A,{sx:{fontSize:14,color:ke.A.forthColor,fontStyle:"italic",mb:1,mt:.5},children:"hourly"===_?"Hourly Booking":"Daily/Overnight Booking"}),(0,z.jsxs)("div",{style:{marginTop:"10px",display:"flex",flexWrap:"wrap",flexDirection:"column",gap:"4px"},children:[(0,z.jsx)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:Oe?(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(u.A,{type:"date",size:"small",value:Xe,onChange:e=>{Ue(e.target.value),tt(null)},InputLabelProps:{shrink:!0},sx:{width:150},InputProps:{sx:{height:36}}}),(0,z.jsx)(x.A,{size:"small",onClick:()=>{if(Xe)if(ve()(Xe,"YYYY-MM-DD",!0).isValid())if("hourly"===_)Z(Xe),Ve(!1),je.oR.success("Check-in date updated");else{if(ve()(Xe).isAfter(ve()(Ze)))return void je.oR.error("Check-in date cannot be after check-out date");Z(Xe),Ve(!1),je.oR.success("Check-in date updated")}else je.oR.error("Invalid date format. Please use YYYY-MM-DD format");else je.oR.error("Please select a check-in date")},sx:{color:"green"},children:(0,z.jsx)(ie,{})}),(0,z.jsx)(x.A,{size:"small",onClick:()=>{Ue(U),Ve(!1)},sx:{color:"red"},children:(0,z.jsx)(re.A,{})})]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(l.A,{sx:Pe,children:[(0,z.jsx)("strong",{children:"Check-In Date:"})," ",ve()(U,"YYYY-MM-DD").format("DD MMM YYYY")]}),(0,z.jsx)(x.A,{size:"small",onClick:()=>{Ue(U),Ve(!0)},sx:{ml:-1},children:(0,z.jsx)(ne.A,{fontSize:"small"})})]})}),"hourly"===_&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(i.A,{sx:{display:"flex",alignItems:"center",gap:1,mt:1},children:Ee?(0,z.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",gap:1,width:"100%"},children:[(0,z.jsx)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,z.jsxs)(m.A,{size:"small",sx:{minWidth:120},children:[(0,z.jsx)(h.A,{children:"Check-in Time"}),(0,z.jsx)(p.A,{value:$e,onChange:e=>Je(e.target.value),label:"Check-in Time",children:is.map(e=>(0,z.jsx)(f.A,{value:e.value,children:e.label},e.value))})]})}),(0,z.jsxs)(i.A,{sx:{display:"flex",gap:1},children:[(0,z.jsx)(x.A,{size:"small",onClick:()=>{$e?$e.match(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)?(X($e),to(so),Le(!1),je.oR.success("Check-in time and duration updated")):je.oR.error("Invalid time format. Please use HH:mm format"):je.oR.error("Please select a check-in time")},sx:{color:"green"},children:(0,z.jsx)(ie,{})}),(0,z.jsx)(x.A,{size:"small",onClick:()=>{Je(L),io(oo),Le(!1)},sx:{color:"red"},children:(0,z.jsx)(re.A,{})})]})]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(l.A,{sx:Pe,children:[(0,z.jsx)("strong",{children:"Check-In Time:"})," ",L&&ve()(L,"HH:mm",!0).isValid()?ve()(L,"HH:mm").format("hh:mm A"):"12:00 PM"]}),(0,z.jsx)(x.A,{size:"small",onClick:()=>{Je(L),io(oo),Le(!0)},sx:{ml:-1},children:(0,z.jsx)(ne.A,{fontSize:"small"})})]})}),(0,z.jsxs)(l.A,{sx:Pe,children:[(0,z.jsx)("strong",{children:"Check-Out Time:"})," ",ve()("".concat(U," ").concat(L),"YYYY-MM-DD HH:mm").add(oo,"hour").format("DD MMM YYYY hh:mm A")]})]}),"hourly"!==_&&(0,z.jsx)(i.A,{sx:{display:"flex",alignItems:"center",gap:1,mt:1},children:Be?(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(u.A,{type:"date",size:"small",value:Ze,onChange:e=>{qe(e.target.value),tt(null)},InputLabelProps:{shrink:!0},sx:{width:150},InputProps:{sx:{height:36}}}),(0,z.jsx)(x.A,{size:"small",onClick:()=>{Ze?ve()(Ze,"YYYY-MM-DD",!0).isValid()?ve()(Ze).isBefore(ve()(Xe))?je.oR.error("Check-out date cannot be before check-in date"):(fe(Ze),_e(!1),je.oR.success("Check-out date updated")):je.oR.error("Invalid date format. Please use YYYY-MM-DD format"):je.oR.error("Please select a check-out date")},sx:{color:"green"},children:(0,z.jsx)(ie,{})}),(0,z.jsx)(x.A,{size:"small",onClick:()=>{qe(q),_e(!1)},sx:{color:"red"},children:(0,z.jsx)(re.A,{})})]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(l.A,{sx:Pe,children:[(0,z.jsx)("strong",{children:"Check-Out Date:"})," ",ve()(q,"YYYY-MM-DD").format("DD MMM YYYY")]}),(0,z.jsx)(x.A,{size:"small",onClick:()=>{qe(q),_e(!0)},sx:{ml:-1},children:(0,z.jsx)(ne.A,{fontSize:"small"})})]})}),"hourly"===_?(0,z.jsxs)(l.A,{sx:Pe,children:[(0,z.jsx)("strong",{children:"Duration: "}),oo," hrs"]}):(0,z.jsxs)(l.A,{sx:Pe,children:[(0,z.jsx)("strong",{children:"Nights: "}),kt," night",kt>1?"s":""]}),(0,z.jsxs)(l.A,{sx:Pe,children:[(0,z.jsx)("strong",{children:"Room type:"})," ",null===T||void 0===T?void 0:T.roomCategory]}),rt>0&&Ot&&(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,z.jsxs)(l.A,{sx:(0,s.A)((0,s.A)({},Pe),{},{bgcolor:"#e8f5e9",border:"1px solid #c8e6c9"}),children:[(0,z.jsx)("strong",{children:"Meal Plan:"})," ",Ot]}),(0,z.jsx)(le.A,{fontSize:"small",sx:{color:ke.A.firstColor}})]}),(0,z.jsx)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,z.jsxs)(l.A,{sx:Pe,children:[(0,z.jsx)("strong",{children:"Room Info: "}),mt," Room",mt&&mt>1?"s":"",",",Me," Adult",Me&&Number(Me)>1?"s":"",",",Ne," Child",Ne&&Number(Ne)>1?"ren":""]})}),(0,z.jsxs)(l.A,{sx:{fontSize:12,color:ke.A.forthColor,mt:1,fontStyle:"italic"},children:[ls()," \u2022 Price may vary by date and availability"]})]})]})]}),(0,z.jsxs)(i.A,{sx:{mt:2,p:1.5,bgcolor:"#f5f5f5",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[(0,z.jsx)(l.A,{variant:"caption",sx:{fontWeight:600,color:ke.A.forthColor,display:"block",mb:.5},children:"Room Occupancy Rules"}),(0,z.jsxs)(i.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[(0,z.jsxs)(l.A,{variant:"caption",sx:{bgcolor:"#e3f2fd",color:"#1976d2",px:1,py:.5,borderRadius:"4px"},children:["Standard: ",(null===T||void 0===T?void 0:T.standardRoomOccupancy)||1," guest",(null===T||void 0===T?void 0:T.standardRoomOccupancy)>1?"s":""]}),(0,z.jsxs)(l.A,{variant:"caption",sx:{bgcolor:"#fff3e0",color:"#f57c00",px:1,py:.5,borderRadius:"4px"},children:["Maximum: ",(null===T||void 0===T?void 0:T.maxRoomOccupancy)||1," guest",(null===T||void 0===T?void 0:T.maxRoomOccupancy)>1?"s":""]}),(0,z.jsxs)(l.A,{variant:"caption",sx:{bgcolor:"#e8f5e9",color:"#2e7d32",px:1,py:.5,borderRadius:"4px"},children:["Your Guest: ",Number(Me)+Number(Ne)," guest",Number(Me)+Number(Ne)>1?"s":""]}),(0,z.jsxs)(l.A,{variant:"caption",sx:{bgcolor:"#f3e5f5",color:"#7b1fa2",px:1,py:.5,borderRadius:"4px"},children:["Rooms needed: ",mt]})]}),ft&&ft.length>0&&(0,z.jsxs)(i.A,{sx:{mt:2},children:[(0,z.jsx)(l.A,{variant:"caption",sx:{fontWeight:600,color:ke.A.forthColor,display:"block",mb:.5},children:"Room-wise Guest Distribution:"}),(0,z.jsx)(i.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:ft.map((e,o)=>{const t=(null===T||void 0===T?void 0:T.standardRoomOccupancy)||1,s=e>t?e-t:0;return(0,z.jsxs)(l.A,{variant:"caption",sx:{bgcolor:s>0?"#ffebee":"#e8f5e9",color:s>0?"#c62828":"#2e7d32",px:1,py:.5,borderRadius:"4px"},children:["Room ",o+1,": ",e," guest",1!==e?"s":"",s>0&&" (+".concat(s," extra)")]},o)})})]}),ht>0&&(0,z.jsxs)(i.A,{sx:{mt:1.5,p:1,bgcolor:"#fff3e0",borderRadius:"6px",border:"1px solid #ffcc80"},children:[(0,z.jsxs)(l.A,{variant:"caption",sx:{fontWeight:600,color:"#e65100",display:"flex",alignItems:"center",gap:.5,mb:1},children:[(0,z.jsx)(ae.A,{fontSize:"small"}),"Additional Guest Charges (Payable at Property):"]}),(0,z.jsxs)(i.A,{sx:{ml:2,mt:.5},children:[(0,z.jsxs)(l.A,{variant:"caption",sx:{display:"block"},children:["\u2022 ",ht," extra guest",ht>1?"s":""," across ",mt," room",mt>1?"s":"","(Standard occupancy: ",(null===T||void 0===T?void 0:T.standardRoomOccupancy)||1," guest",(null===T||void 0===T?void 0:T.standardRoomOccupancy)>1?"s":""," per room)"]}),(0,z.jsxs)(l.A,{variant:"caption",sx:{display:"block",fontWeight:600,color:"#e65100",mt:.5},children:["\u2022 Total extra charge: \u20b9 ",pt.toFixed(2)]}),(0,z.jsx)(l.A,{variant:"caption",sx:{display:"block",color:"#666",mt:.5},children:"Note: This amount will be collected directly by the property during check-in."})]})]})]}),wo&&(0,z.jsx)(a.A,{severity:"error",sx:{mt:3,mb:2,borderRadius:2,"& .MuiAlert-message":{fontSize:"14px",fontWeight:500}},onClose:()=>Yo(null),children:wo}),(0,z.jsxs)("form",{onSubmit:Qt.handleSubmit,children:[(0,z.jsx)(l.A,{variant:"h6",mt:4,sx:{color:ke.A.firstColor,fontWeight:"bold"},children:"Guest Information"}),(0,z.jsx)(De.XY,{label:"Guest Name *",name:"name",fullWidth:!0,margin:"normal",value:Qt.values.name,onChange:e=>ns("name",e.target.value),onBlur:Qt.handleBlur,error:Qt.touched.name&&Boolean(Qt.errors.name),helperText:Qt.touched.name&&Qt.errors.name?String(Qt.errors.name):" ",inputRef:dt,sx:{"& .MuiFormHelperText-root":{color:"red",fontSize:"12px",marginLeft:1,marginTop:.5,fontWeight:500},"& .MuiOutlinedInput-root":{"&.Mui-error fieldset":{borderColor:"red",borderWidth:"2px"}}}}),(0,z.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",width:{xs:"100%",md:"100%"}},children:[(0,z.jsx)(be(),{country:"in",onlyCountries:["in"],disableDropdown:!0,countryCodeEditable:!1,enableSearch:!1,value:Qt.values.phoneNumber,placeholder:"Phone Number",onChange:e=>Qt.setFieldValue("phoneNumber",e),onBlur:()=>Qt.setFieldTouched("phoneNumber",!0),inputStyle:{width:"100%",height:"56px",borderRadius:"52px",border:"none",outline:"none",boxShadow:"4px 4px 10px rgba(104, 39, 184, 0.17)",color:ke.A.firstColor,paddingLeft:"60px",fontSize:"16px",backgroundColor:"white"},buttonStyle:{borderRadius:"52px 0 0 52px",backgroundColor:"white",border:"none"},containerStyle:{width:"100%"},dropdownStyle:{borderRadius:"12px"}}),Qt.touched.phoneNumber&&Qt.errors.phoneNumber&&(0,z.jsx)(l.A,{sx:{color:"red",fontSize:"12px",mt:.5,ml:"14px"},children:Qt.errors.phoneNumber})]}),(0,z.jsx)(De.XY,{label:"Email Address (Optional)",name:"email",fullWidth:!0,margin:"normal",value:Qt.values.email,onChange:e=>ns("email",e.target.value),onBlur:Qt.handleBlur,error:Qt.touched.email&&Boolean(Qt.errors.email),helperText:Qt.touched.email&&Qt.errors.email?String(Qt.errors.email):" ",sx:{"& .MuiFormHelperText-root":{fontSize:"12px",marginLeft:1,marginTop:.5}}}),(0,z.jsxs)(i.A,{sx:{mt:3,mb:2},children:[(0,z.jsx)(l.A,{variant:"subtitle1",sx:{color:ke.A.firstColor,fontWeight:"bold",mb:1},children:"Available Discounts"}),go.length>0&&(0,z.jsx)(i.A,{sx:{mb:2},children:jo?(0,z.jsxs)(i.A,{sx:{p:2,borderRadius:2,bgcolor:"#e8f5e9",border:"1px solid #c8e6c9",display:"flex",alignItems:"center",justifyContent:"space-between",animation:Co?"fadeInScale 0.5s ease-out":"none","@keyframes fadeInScale":{"0%":{opacity:0,transform:"scale(0.95)"},"100%":{opacity:1,transform:"scale(1)"}}},children:[(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(de.A,{color:"success"}),(0,z.jsxs)(i.A,{children:[(0,z.jsx)(l.A,{sx:{fontWeight:600,color:"#2e7d32"},children:"Hotel Discount Applied"}),(0,z.jsxs)(l.A,{variant:"body2",sx:{color:"#388e3c",display:"flex",alignItems:"center",gap:.5},children:[as((null===Co||void 0===Co?void 0:Co.discountType)||"flat"),(null===Co||void 0===Co?void 0:Co.discountValue)||0,ds((null===Co||void 0===Co?void 0:Co.discountType)||"flat")]}),(0,z.jsxs)(l.A,{variant:"caption",sx:{color:"#666",display:"block",mt:.5},children:["You saved \u20b9 ",Ft.toFixed(2)]})]})]}),(0,z.jsx)(d.A,{variant:"outlined",color:"error",size:"small",onClick:()=>{ko(null),So(!1),je.oR.info("Hotel discount removed")},children:"Remove"})]}):(0,z.jsxs)(i.A,{sx:{p:2,borderRadius:2,bgcolor:"#e3f2fd",border:"1px solid #bbdefb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(de.A,{color:"primary"}),(0,z.jsxs)(i.A,{children:[(0,z.jsx)(l.A,{sx:{fontWeight:600,color:"#1565c0"},children:"Hotel Discount Available"}),(0,z.jsxs)(l.A,{variant:"body2",sx:{color:"#1976d2",display:"flex",alignItems:"center",gap:.5},children:[as(go[0].discountType),go[0].discountValue,ds(go[0].discountType)]})]})]}),(0,z.jsx)(d.A,{variant:"contained",sx:{background:ke.A.firstColor},size:"small",onClick:()=>{if(go.length>0&&!jo){const e=go[0];ko({id:e.id,hotelId:e.hotelId,roomId:e.roomId,discountType:e.discountType,discountValue:parseFloat(e.discountValue)||0,isActive:e.isActive}),So(!0),je.oR.success("Hotel discount applied: ".concat(e.discountValue).concat("percentage"===e.discountType?"%":"\u20b9"," off"))}},children:"Apply"})]})}),zo?(0,z.jsxs)(i.A,{sx:{p:2,borderRadius:2,bgcolor:"#e8f5e9",border:"1px solid #c8e6c9",display:"flex",alignItems:"center",justifyContent:"space-between",animation:zo?"fadeInScale 0.5s ease-out":"none"},children:[(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(ce,{color:"success"}),(0,z.jsxs)(i.A,{children:[(0,z.jsx)(l.A,{sx:{fontWeight:600,color:"#2e7d32"},children:"Huts4u Discount Applied"}),(0,z.jsxs)(l.A,{variant:"caption",sx:{color:"#666",display:"block",mt:.5},children:["You saved \u20b9 ",Nt.toFixed(2)]})]})]}),(0,z.jsx)(d.A,{variant:"outlined",color:"error",size:"small",onClick:()=>{Ro(!1),je.oR.info("Huts4u Discount removed")},children:"Remove"})]}):(0,z.jsxs)(i.A,{sx:{p:2,borderRadius:2,bgcolor:"#fff3e0",border:"1px solid #ffcc80",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(ce,{color:"warning"}),(0,z.jsxs)(i.A,{children:[(0,z.jsx)(l.A,{sx:{fontWeight:600,color:"#e65100"},children:"Huts4u Discount Available"}),(0,z.jsx)(l.A,{variant:"body2",sx:{color:"#e65100"},children:"5% off on total amount"})]})]}),(0,z.jsx)(d.A,{variant:"contained",sx:{background:ke.A.firstColor},size:"small",onClick:()=>{Ro(!0),je.oR.success("Huts4u Discount applied!")},children:"Apply"})]}),(jo||zo)&&(0,z.jsxs)(i.A,{sx:{mt:2,p:1.5,borderRadius:2,bgcolor:"#f5f0ff",border:"1px solid #d1c4e9",animation:"slideInFromLeft 0.5s ease-out","@keyframes slideInFromLeft":{"0%":{opacity:0,transform:"translateX(-20px)"},"100%":{opacity:1,transform:"translateX(0)"}}},children:[(0,z.jsx)(l.A,{sx:{fontSize:14,fontWeight:600,color:ke.A.firstColor,mb:.5},children:"Total Discounts Applied:"}),(0,z.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,z.jsx)(l.A,{variant:"body2",sx:{color:"#666"},children:"Total savings:"}),(0,z.jsxs)(l.A,{variant:"body2",sx:{fontWeight:600,color:"#2e7d32",animation:Gt>0?"pulse 1s ease-in-out":"none","@keyframes pulse":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(1.1)"},"100%":{transform:"scale(1)"}}},children:["\u20b9 ",Gt.toFixed(2)]})]})]})]}),(0,z.jsxs)(i.A,{sx:{mt:3,mb:2},children:[(0,z.jsxs)(i.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},mb:1,gap:{xs:1,sm:0}},children:[(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(l.A,{variant:"subtitle1",sx:{color:ke.A.firstColor,fontWeight:"bold",fontSize:{xs:"1rem",sm:"1.1rem"}},children:"GST Details(Optional)"}),Fo&&(0,z.jsx)(v.A,{label:"GST Added \u2713",color:"success",size:"small",icon:(0,z.jsx)(ue.A,{}),sx:{fontSize:{xs:"0.7rem",sm:"0.8rem"},height:{xs:28,sm:32}}})]}),(0,z.jsx)(i.A,{sx:{display:"flex",gap:1,width:{xs:"100%",sm:"auto"}},children:Fo?(0,z.jsxs)(i.A,{sx:{display:"flex",gap:1},children:[(0,z.jsx)(d.A,{size:"small",variant:"outlined",onClick:St,sx:{textTransform:"none",fontSize:{xs:"0.75rem",sm:"0.875rem"},minWidth:{xs:"80px",sm:"100px"},whiteSpace:"nowrap",borderColor:"#ff6b6b",color:"#ff6b6b","&:hover":{bgcolor:"#ffeaea",borderColor:"#ff4444"}},children:"Remove"}),(0,z.jsx)(d.A,{size:"small",variant:"outlined",onClick:()=>Po(!Mo),sx:{textTransform:"none",fontSize:{xs:"0.75rem",sm:"0.875rem"},minWidth:{xs:"100px",sm:"120px"},whiteSpace:"nowrap",borderColor:ke.A.firstColor,color:ke.A.firstColor,"&:hover":{bgcolor:"#f5f0ff"}},children:Mo?"Hide Details":"Change GST"})]}):(0,z.jsx)(d.A,{size:"small",variant:Mo?"outlined":"contained",onClick:()=>{Po(!Mo),(0,Ie.M3)()&&!Mo&&yt((0,Ie.F6)())},sx:{textTransform:"none",fontSize:{xs:"0.75rem",sm:"0.875rem"},minWidth:{xs:"100px",sm:"120px"},whiteSpace:"nowrap",bgcolor:Mo?"transparent":ke.A.firstColor,color:Mo?ke.A.firstColor:"white",borderColor:Mo?ke.A.firstColor:"transparent","&:hover":{bgcolor:Mo?"#f5f0ff":ke.A.firstColor,borderColor:ke.A.firstColor}},children:Mo?"Cancel":"Add GST"})})]}),!Fo&&!Mo&&(0,z.jsx)(i.A,{sx:{p:{xs:1,sm:1.5},borderRadius:1.5,bgcolor:"#f0f7ff",border:"1px solid #cce5ff",mb:2},children:(0,z.jsxs)(l.A,{variant:"body2",sx:{color:"#0066cc",fontSize:{xs:"0.8rem",sm:"0.9rem"},display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(xe.A,{fontSize:"small"}),"Need a business invoice? Add your GST details to get a tax invoice with your booking."]})}),Mo&&(0,z.jsxs)(i.A,{sx:{p:{xs:1.5,sm:2},borderRadius:2,bgcolor:"#f8f9fa",border:"1px solid #dee2e6",animation:"slideDown 0.3s ease-out"},children:[qo&&(0,z.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",my:2},children:(0,z.jsx)(g.A,{size:24})}),(0,Ie.M3)()&&Lo.length>0&&!Jo&&(0,z.jsxs)(i.A,{sx:{mb:3},children:[(0,z.jsxs)(l.A,{variant:"body2",sx:{mb:1.5,color:ke.A.forthColor,fontWeight:600,display:"flex",alignItems:"center",gap:1,fontSize:{xs:"0.85rem",sm:"0.9rem"}},children:[(0,z.jsx)(xe.A,{fontSize:"small"}),"Your Saved GST Records:"]}),(0,z.jsx)(i.A,{sx:{p:{xs:1,sm:2},borderRadius:2,bgcolor:"white",border:"1px solid #e0e0e0",maxHeight:{xs:"250px",sm:"300px"},overflowY:"auto"},children:0===Lo.length?(0,z.jsxs)(i.A,{sx:{p:3,textAlign:"center",color:"#666"},children:[(0,z.jsx)(xe.A,{sx:{fontSize:40,color:"#ddd",mb:1}}),(0,z.jsx)(l.A,{variant:"body2",children:"No saved GST records found"}),(0,z.jsx)(l.A,{variant:"caption",children:"Add your first GSTIN to save it for future bookings"})]}):Lo.map((e,o)=>{const t=!0===e.verified||"Active"===e.gstStatus,s=(null===Uo||void 0===Uo?void 0:Uo.id)===e.id||(null===Uo||void 0===Uo?void 0:Uo._id)===e._id;return(0,z.jsx)(i.A,{sx:{p:{xs:1,sm:1.5},mb:1.5,borderRadius:2,border:s?"2px solid ".concat(ke.A.firstColor):"1px solid #ddd",backgroundColor:s?"#f3e5f5":"white",cursor:"pointer","&:hover":{borderColor:ke.A.firstColor,backgroundColor:"#faf5ff"}},onClick:()=>jt(e),children:(0,z.jsxs)(i.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},gap:{xs:1,sm:0}},children:[(0,z.jsxs)(i.A,{sx:{flex:1,width:"100%"},children:[(0,z.jsxs)(i.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"flex-start",sm:"center"},gap:{xs:.5,sm:1},mb:.5},children:[(0,z.jsx)(l.A,{variant:"body2",sx:{fontWeight:600,fontSize:{xs:"0.85rem",sm:"0.9rem"}},children:e.gstNumber}),(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:.5,flexWrap:"wrap"},children:[t&&(0,z.jsx)(A.A,{title:"Verified GST",children:(0,z.jsx)(ue.A,{fontSize:"small",color:"success"})}),e.gstStatus&&(0,z.jsx)(v.A,{label:e.gstStatus,size:"small",color:"Active"===e.gstStatus?"success":"error",variant:"outlined",sx:{height:20,fontSize:"0.65rem"}})]})]}),(0,z.jsx)(l.A,{variant:"caption",sx:{color:"#666",display:"block",mb:.5,fontSize:{xs:"0.75rem",sm:"0.8rem"}},children:e.legalName}),(0,z.jsx)(l.A,{variant:"caption",sx:{color:"#888",display:"block",fontSize:{xs:"0.7rem",sm:"0.75rem"}},children:e.address})]}),(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:.5,width:{xs:"100%",sm:"auto"},justifyContent:{xs:"flex-end",sm:"flex-start"},mt:{xs:1,sm:0}},children:[s?(0,z.jsx)(v.A,{label:"Selected",size:"small",color:"success",icon:(0,z.jsx)(ie,{}),sx:{height:24,fontSize:"0.7rem"}}):(0,z.jsx)(d.A,{size:"small",variant:"outlined",onClick:o=>{o.stopPropagation(),jt(e)},sx:{fontSize:"0.75rem",minWidth:"70px"},children:"Select"}),(0,z.jsxs)(i.A,{sx:{display:"flex",gap:.5},children:[(0,z.jsx)(A.A,{title:"Copy GSTIN",children:(0,z.jsx)(x.A,{size:"small",sx:{fontSize:{xs:"0.8rem",sm:"1rem"}},onClick:o=>{var t;o.stopPropagation(),t=e.gstNumber,navigator.clipboard.writeText(t).then(()=>je.oR.success("GSTIN copied to clipboard")).catch(()=>je.oR.error("Failed to copy GSTIN"))},children:(0,z.jsx)(me,{fontSize:"small"})})}),(0,z.jsx)(A.A,{title:"Remove from account",children:(0,z.jsx)(x.A,{size:"small",color:"error",sx:{fontSize:{xs:"0.8rem",sm:"1rem"}},onClick:o=>{o.stopPropagation(),(async e=>{if((0,Ie.M3)()){if(window.confirm("Are you sure you want to remove this GST from your account?")){et(e);try{var o;const t={userId:(0,Ie.F6)()},s=await(0,ze.Av)(e,t.userId);null!==s&&void 0!==s&&null!==(o=s.data)&&void 0!==o&&o.success?(je.oR.success("GST removed from your account"),Xo(o=>o.filter(o=>o.id!==e&&o._id!==e)),!Uo||Uo.id!==e&&Uo._id!==e||St()):je.oR.error("Failed to remove GST")}catch(t){console.error("Error deleting GST:",t),je.oR.error("Failed to remove GST")}finally{et(null)}}}else je.oR.error("Please login to manage GST records")})(e.id||e._id)},disabled:Ko===(e.id||e._id),children:Ko===(e.id||e._id)?(0,z.jsx)(g.A,{size:16}):(0,z.jsx)(he,{fontSize:"small"})})})]})]})]})},e._id||e.id||o)})}),(0,z.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",mt:2},children:(0,z.jsx)(d.A,{startIcon:(0,z.jsx)(pe.A,{}),variant:"outlined",onClick:()=>{Qo(!0),No(""),Wo(""),Oo(""),Bo("none"),Zo(null)},sx:{textTransform:"none",fontSize:{xs:"0.8rem",sm:"0.875rem"}},children:"Add New GST"})})]}),(Jo||!(0,Ie.M3)()||(0,Ie.M3)()&&0===Lo.length)&&(0,z.jsxs)(i.A,{children:[(0,z.jsx)(l.A,{variant:"body2",sx:{mb:2,color:ke.A.forthColor,fontWeight:600,fontSize:{xs:"0.9rem",sm:"1rem"}},children:Jo?"Add New GSTIN":"Enter GSTIN for Business Invoice"}),(0,z.jsxs)(i.A,{sx:{mb:2},children:[(0,z.jsxs)(i.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"},gap:{xs:1,sm:1},mb:1},children:[(0,z.jsx)(De.XY,{label:"GSTIN Number",fullWidth:!0,value:Fo,onChange:e=>{const o=e.target.value.toUpperCase();if(No(o),15===o.length){/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/i.test(o)||(je.oR.error("Invalid GSTIN format. Please check the number."),Bo("invalid"))}},placeholder:"Enter 15-digit GSTIN",inputRef:ut,disabled:"verified"===Vo,sx:{flex:1},size:"small"}),(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:["verified"===Vo&&(0,z.jsx)(A.A,{title:"GSTIN Verified",children:(0,z.jsx)(ue.A,{color:"success",sx:{fontSize:{xs:24,sm:28}}})}),(0,z.jsx)(d.A,{variant:"contained",size:"small",onClick:async()=>{var e;if(!Fo.trim())return je.oR.error("Please enter GSTIN number"),void(null===(e=ut.current)||void 0===e||e.focus());if(!/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/i.test(Fo.toUpperCase()))return je.oR.error("Please enter a valid 15-digit GSTIN format"),void Bo("invalid");Eo(!0),Bo("pending");try{var o,t;const e=(0,Ie.M3)()?(0,Ie.F6)():null,u=(0,s.A)({gstNumber:Fo.toUpperCase()},e&&{userId:e}),x=await(0,ze.Lb)(u);if(null!==x&&void 0!==x&&null!==(o=x.data)&&void 0!==o&&o.data){var i,r,n,l;const o=(null===(i=x.data)||void 0===i?void 0:i.data)||(null===(r=x.data)||void 0===r?void 0:r.result);Bo("verified"),Wo((null===o||void 0===o?void 0:o.legalName)||(null===o||void 0===o?void 0:o.lgnm)||""),Oo((null===o||void 0===o?void 0:o.address)||(null===o||void 0===o||null===(n=o.pradr)||void 0===n?void 0:n.adr)||"");const t=(0,s.A)((0,s.A)({},o),{},{id:null===o||void 0===o?void 0:o.id,gstNumber:(null===o||void 0===o?void 0:o.gstNumber)||Fo.toUpperCase(),legalName:(null===o||void 0===o?void 0:o.legalName)||(null===o||void 0===o?void 0:o.lgnm)||"",address:(null===o||void 0===o?void 0:o.address)||(null===o||void 0===o||null===(l=o.pradr)||void 0===l?void 0:l.adr)||"",verified:!0});Zo(t),je.oR.success("GSTIN verified successfully!"),e&&yt(e)}else if("BAD_REQUEST"===(null===x||void 0===x||null===(t=x.data)||void 0===t?void 0:t.status)){var a;const o=(null===(a=x.data)||void 0===a?void 0:a.message)||"GST verification failed";if(o.includes("already exists")){var d;const o=null===(d=x.data)||void 0===d?void 0:d.data;if(e&&null!==o&&void 0!==o&&o.id)try{var c;const t=await(0,ze.yZ)(o.id,{userId:e});null!==t&&void 0!==t&&null!==(c=t.data)&&void 0!==c&&c.success&&je.oR.success("GST linked to your account!")}catch(m){console.error("Error updating GST user ID:",m)}Bo("verified"),No(o.gstNumber||Fo.toUpperCase()),Wo(o.legalName||""),Oo(o.address||""),Zo(o),je.oR.info("Using existing GST record")}else Bo("invalid"),je.oR.error(o)}else Bo("invalid"),je.oR.error("GST verification failed. Please try again.")}catch(h){var u,x;if(console.error("GST verification error:",h),Bo("invalid"),"BAD_REQUEST"===(null===(u=h.response)||void 0===u||null===(x=u.data)||void 0===x?void 0:x.status)){const e=h.response.data;null!==e&&void 0!==e&&e.data?(Bo("verified"),Wo(e.data.legalName||""),Oo(e.data.address||""),Zo(e.data),je.oR.info("Using existing GST record")):je.oR.error((null===e||void 0===e?void 0:e.message)||"Invalid GST number")}else je.oR.error("Failed to verify GST. Please check your internet connection.")}finally{Eo(!1)}},disabled:_o||"verified"===Vo||15!==Fo.length,sx:{textTransform:"none",bgcolor:ke.A.firstColor,fontSize:{xs:"0.75rem",sm:"0.875rem"},minWidth:{xs:"100px",sm:"120px"},height:{xs:"36px",sm:"40px"}},startIcon:_o?(0,z.jsx)(g.A,{size:16,color:"inherit"}):null,children:_o?"Verifying...":"verified"===Vo?"Verified":"Verify"})]})]}),"invalid"===Vo&&(0,z.jsx)(a.A,{severity:"error",sx:{mt:1,fontSize:"0.8rem",py:.5},children:"Invalid GSTIN format. Please enter a valid 15-digit GSTIN."}),Fo.length>0&&Fo.length<15&&(0,z.jsx)(l.A,{variant:"caption",sx:{color:"warning.main",display:"block",mt:.5,fontSize:"0.75rem"},children:"Enter 15-digit GSTIN to verify"})]}),"verified"===Vo&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(De.XY,{label:"Legal Business Name",fullWidth:!0,margin:"normal",size:"small",value:Go,onChange:e=>Wo(e.target.value),InputProps:{startAdornment:(0,z.jsx)(A.A,{title:"Verified",children:(0,z.jsx)(ue.A,{color:"success",sx:{mr:1,fontSize:20}})})},sx:{mb:2}}),(0,z.jsx)(De.XY,{label:"Registered Business Address",fullWidth:!0,margin:"normal",size:"small",multiline:!0,rows:2,value:Ho,onChange:e=>Oo(e.target.value),InputProps:{startAdornment:(0,z.jsx)(A.A,{title:"Verified",children:(0,z.jsx)(ue.A,{color:"success",sx:{mr:1,fontSize:20}})})},sx:{mb:2}}),(0,z.jsxs)(a.A,{severity:"success",sx:{mb:2,fontSize:"0.9rem"},icon:(0,z.jsx)(ue.A,{}),children:[(0,z.jsx)(l.A,{variant:"body2",sx:{fontWeight:600},children:"GSTIN verified successfully!"}),(0,z.jsx)(l.A,{variant:"caption",children:"This GST will be added to your invoice"})]}),(0,Ie.M3)()&&(0,z.jsx)(l.A,{variant:"caption",sx:{color:"#666",display:"block",textAlign:"center",mt:1,fontSize:"0.8rem"},children:"This GST record will be saved to your account for future bookings"})]}),(0,Ie.M3)()&&Lo.length>0&&Jo&&(0,z.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",mt:2},children:(0,z.jsx)(d.A,{variant:"text",size:"small",onClick:()=>{Qo(!1),No(""),Wo(""),Oo(""),Bo("none")},sx:{textTransform:"none",fontSize:"0.8rem"},children:"\u2190 Back to Saved GST Records"})})]}),Uo&&(0,z.jsxs)(a.A,{severity:"success",sx:{mt:2,fontSize:"0.9rem"},icon:(0,z.jsx)(ie,{}),children:[(0,z.jsx)(l.A,{variant:"body2",sx:{fontWeight:600},children:"Selected GST for Invoice:"}),(0,z.jsxs)(i.A,{sx:{ml:1,mt:.5},children:[(0,z.jsx)(l.A,{variant:"body2",sx:{fontWeight:600},children:Uo.gstNumber}),(0,z.jsx)(l.A,{variant:"caption",sx:{color:"#388e3c",display:"block"},children:Uo.legalName}),(0,z.jsx)(l.A,{variant:"caption",sx:{color:"#666",display:"block",mt:.5},children:Uo.address})]}),(0,z.jsx)(i.A,{sx:{display:"flex",justifyContent:"flex-end",mt:1},children:(0,z.jsx)(d.A,{size:"small",color:"error",onClick:St,sx:{fontSize:"0.75rem"},children:"Remove GST"})})]}),!Fo&&(0,z.jsx)(i.A,{sx:{p:{xs:1,sm:1.5},borderRadius:1.5,bgcolor:"#f0f7ff",border:"1px solid #cce5ff",mt:2},children:(0,z.jsxs)(l.A,{variant:"body2",sx:{color:"#0066cc",fontSize:{xs:"0.8rem",sm:"0.9rem"},display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(Te.A,{fontSize:"small"}),(0,z.jsx)("strong",{children:"Optional:"})," Add GST only if you need a business invoice. You can proceed without GST for personal bookings."]})})]})]}),(0,z.jsx)(i.A,{sx:{mt:2},children:(0,z.jsx)(b.A,{control:(0,z.jsx)($,{checked:ho,onChange:e=>{po(e.target.checked),wo&&e.target.checked&&Yo(null)},color:"primary"}),label:(0,z.jsxs)("span",{children:["I accept the"," ",(0,z.jsx)("span",{style:{color:ke.A.firstColor,cursor:"pointer",textDecoration:"underline"},onClick:()=>vo(!0),children:"Terms & Conditions"})]})})}),(0,z.jsx)(Ce.A,{variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2,opacity:rs()?1:.7,"&:disabled":{backgroundColor:"#e0e0e0",color:"#9e9e9e",cursor:"not-allowed"}},type:"submit",disabled:!rs(),children:(0,Ie.M3)()?"Pay Now":"Verify Phone & Pay"}),(0,z.jsx)(Re.A,{open:lo,onClose:()=>ao(!1),onVerificationSuccess:()=>{ao(!1),"verified"===Vo&&Uo&&(0,Ie.M3)()&&!Uo.userId?Kt():$t()},phone:co.phone,name:co.name,email:co.email,token:co.token})]})]})}),(0,z.jsx)(r.A,{sx:{p:1,background:"white",border:"none",boxShadow:0,borderRadius:"12px",height:"fit-content",minWidth:{md:"350px"}},children:(0,z.jsxs)(n.A,{children:[(0,z.jsx)(l.A,{variant:"h6",gutterBottom:!0,sx:{color:ke.A.firstColor,fontWeight:"bold"},children:"Your Bill Summary"}),(jo||zo)&&(0,z.jsxs)(i.A,{sx:{mb:2,p:1.5,bgcolor:"#e8f5e9",borderRadius:1,border:"1px solid #c8e6c9",display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(de.A,{color:"success",fontSize:"small"}),(0,z.jsxs)(i.A,{children:[(0,z.jsx)(l.A,{variant:"body2",sx:{fontWeight:600,color:"#2e7d32"},children:"Discounts Applied"}),(0,z.jsxs)(l.A,{variant:"caption",sx:{color:"#388e3c",display:"block"},children:["Total savings: \u20b9 ",Gt.toFixed(2)]}),(0,z.jsxs)(i.A,{sx:{display:"flex",gap:1,mt:.5},children:[jo&&(0,z.jsx)(v.A,{size:"small",label:"Hotel Discount: \u20b9 ".concat(Ft.toFixed(2)),color:"success",variant:"outlined"}),zo&&(0,z.jsx)(v.A,{size:"small",label:"Huts4u: \u20b9 ".concat(Nt.toFixed(2)),color:"primary",variant:"outlined"})]})]})]}),"verified"===Vo&&(0,z.jsxs)(i.A,{sx:{mb:2,p:1.5,bgcolor:"#e8f5e9",borderRadius:1,border:"1px solid #c8e6c9",display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(ue.A,{color:"success",fontSize:"small"}),(0,z.jsxs)(i.A,{children:[(0,z.jsx)(l.A,{variant:"body2",sx:{fontWeight:600,color:"#2e7d32"},children:"GST Invoice Enabled"}),(0,z.jsxs)(l.A,{variant:"caption",sx:{color:"#388e3c",display:"block"},children:["GSTIN: ",Fo]}),(0,z.jsx)(l.A,{variant:"caption",sx:{color:"#666",display:"block"},children:Go})]})]}),(null===M||void 0===M?void 0:M.mealPlanPrice)>0&&(null===M||void 0===M?void 0:M.mealPlanDescription)&&(0,z.jsxs)(i.A,{sx:{mb:2,p:1.5,bgcolor:"#fff3e0",borderRadius:1,border:"1px solid #ffcc80",display:"flex",alignItems:"center",gap:1},children:[(0,z.jsx)(le.A,{color:"warning",fontSize:"small"}),(0,z.jsxs)(i.A,{children:[(0,z.jsx)(l.A,{variant:"body2",sx:{fontWeight:600,color:"#e65100"},children:"Meal Plan Included"}),(0,z.jsx)(l.A,{variant:"caption",sx:{color:"#e65100",display:"block"},children:M.mealPlanDescription}),(0,z.jsx)(l.A,{variant:"caption",sx:{color:"#666",display:"block"},children:"Meal charges included in base price"})]})]}),(0,z.jsxs)(i.A,{sx:{mb:2,p:1.5,bgcolor:"#e3f2fd",borderRadius:1,border:"1px solid #bbdefb"},children:[(0,z.jsx)(l.A,{variant:"body2",sx:{fontWeight:600,color:"#1565c0"},children:ls()}),(0,z.jsx)(l.A,{variant:"caption",sx:{color:"#1976d2",display:"block",mt:.5},children:"hourly"===_?"".concat(oo," hrs \u2022 ").concat(mt," room").concat(mt&&mt>1?"s":""):"".concat(kt," night").concat(kt>1?"s":""," \u2022 ").concat(mt," room").concat(mt&&mt>1?"s":"")}),(null===M||void 0===M?void 0:M.mealPlanPrice)>0&&(0,z.jsxs)(l.A,{variant:"caption",sx:{color:"#e65100",fontWeight:600,mt:.5,display:"block"},children:["\u2713 ",M.mealPlanDescription," Included"]}),zo&&(0,z.jsx)(l.A,{variant:"caption",sx:{color:"green",fontWeight:600,mt:.5,display:"block"},children:"\u2713  Huts4u Discount Applied"}),jo&&(0,z.jsx)(l.A,{variant:"caption",sx:{color:"#2e7d32",fontWeight:600,mt:.5,display:"block"},children:"\u2713  Hotel Discount Applied"})]}),ht>0&&(0,z.jsxs)(i.A,{sx:{mb:2,p:1.5,bgcolor:"#fff3e0",borderRadius:"8px",border:"1px solid #ffcc80"},children:[(0,z.jsxs)(l.A,{variant:"caption",sx:{fontWeight:600,color:"#e65100",display:"flex",alignItems:"center",gap:.5,mb:1},children:[(0,z.jsx)(ae.A,{fontSize:"small"}),"Additional Guest Charges"]}),(0,z.jsxs)(l.A,{variant:"body2",sx:{ml:2},children:[ht," extra guest",ht>1?"s":"",": \u20b9 ",pt.toFixed(2)]}),(0,z.jsx)(l.A,{variant:"caption",sx:{display:"block",color:"#666",mt:1,fontStyle:"italic"},children:"Note: This amount will be collected directly by the property during check-in."})]}),(0,z.jsxs)("div",{style:{marginTop:"10px",display:"flex",flexWrap:"wrap",flexDirection:"column",gap:"8px",alignItems:"flex-end"},children:[(0,z.jsx)(l.A,{sx:{fontSize:"24px",color:ke.A.firstColor,fontWeight:"bold",animation:jo?"priceDropAnimation 0.6s ease-out":"none","@keyframes priceDropAnimation":{"0%":{opacity:0,transform:"scale(0.9)"},"70%":{opacity:1,transform:"scale(1.05)"},"100%":{opacity:1,transform:"scale(1)"}}},children:Bt>0?"\u20b9 ".concat(Bt.toFixed(0)):"\u2014"}),(0,z.jsx)(l.A,{sx:{fontSize:"13px",color:ke.A.forthColor,textAlign:"right"},children:_t>0?(0,z.jsxs)(z.Fragment,{children:["+ \u20b9",_t.toFixed(0)," taxes & fees"]}):"\u2014"}),(0,z.jsx)(J.A,{sx:{width:"100%",mt:1}}),(0,z.jsxs)("div",{style:{width:"100%",textAlign:"right"},children:[(0,z.jsxs)(l.A,{sx:{fontSize:13,color:ke.A.forthColor},children:["Subtotal before discount: \u20b9 ",Pt.toFixed(2)]}),jo&&Ft>0&&(0,z.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1,animation:"slideInDiscount 0.5s ease-out","@keyframes slideInDiscount":{"0%":{opacity:0,transform:"translateX(-20px)"},"100%":{opacity:1,transform:"translateX(0)"}}},children:[(0,z.jsx)(l.A,{sx:{fontSize:14,color:"#2e7d32",fontWeight:600},children:"Hotel Discount:"}),(0,z.jsxs)(l.A,{sx:{fontSize:14,color:"#2e7d32",fontWeight:600,animation:"discountFlash 0.8s ease-in-out","@keyframes discountFlash":{"0%, 100%":{color:"#2e7d32"},"50%":{color:"#4caf50"}}},children:["- \u20b9 ",Ft.toFixed(2)]})]}),zo&&Nt>0&&(0,z.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1,animation:"slideInDiscount 0.5s ease-out 0.2s",animationFillMode:"both"},children:[(0,z.jsx)(l.A,{sx:{fontSize:14,color:"green",fontWeight:600},children:"Huts4u Discount:"}),(0,z.jsxs)(l.A,{sx:{fontSize:14,color:"green",fontWeight:600,animation:"discountFlash 0.8s ease-in-out 0.3s",animationFillMode:"both"},children:["- \u20b9 ",Nt.toFixed(2)]})]}),(0,z.jsx)(l.A,{sx:{fontSize:"16px",color:ke.A.firstColor,fontWeight:"700",mt:Ft>0||Nt>0?1:0,animation:jo||zo?"bounceIn 0.8s ease-out":"none","@keyframes bounceIn":{"0%":{opacity:0,transform:"scale(0.3)"},"50%":{opacity:1,transform:"scale(1.05)"},"70%":{transform:"scale(0.95)"},"100%":{opacity:1,transform:"scale(1)"}}},children:Wt>0?"Final: \u20b9 ".concat(Et.toFixed(2)):"---"})]})]}),(0,z.jsxs)(i.A,{sx:{mt:3,borderRadius:2,border:"1px dashed #ddd",p:2,backgroundColor:"#fafafa"},children:[(0,z.jsx)(l.A,{sx:{fontSize:13,fontWeight:600,mb:1,color:ke.A.forthColor},children:"Detailed Breakup"}),(0,z.jsxs)(l.A,{sx:{fontSize:13},children:[(0,z.jsx)("strong",{children:"1. Base Price"}),(0,z.jsxs)("span",{style:{float:"right"},children:["\u20b9 ",(It+zt+Rt).toFixed(2)]})]}),(0,z.jsxs)(l.A,{sx:{fontSize:13,mt:1},children:[(0,z.jsx)("strong",{children:"2. Service Charges"}),(0,z.jsx)("span",{style:{fontSize:11},children:" (HSN 996111)"}),(0,z.jsxs)("span",{style:{float:"right"},children:["\u20b9 ",Lt.toFixed(2)]})]}),(0,z.jsxs)(l.A,{sx:{fontSize:12,ml:2,mt:.3},children:["CGST @ 9% on Service",(0,z.jsxs)("span",{style:{float:"right"},children:["\u20b9 ",Xt.toFixed(2)]})]}),(0,z.jsxs)(l.A,{sx:{fontSize:12,ml:2},children:["SGST @ 9% on Service",(0,z.jsxs)("span",{style:{float:"right"},children:["\u20b9 ",Ut.toFixed(2)]})]}),(0,z.jsxs)(l.A,{sx:{fontSize:13,mt:1},children:[(0,z.jsx)("strong",{children:"3. Convenience Fees (Incl. GST)"}),(0,z.jsxs)("span",{style:{float:"right"},children:["\u20b9 ",Zt.toFixed(2)]})]}),(0,z.jsx)(J.A,{sx:{my:1.5}}),(0,z.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,z.jsx)(l.A,{sx:{fontSize:14,fontWeight:600},children:"Subtotal:"}),(0,z.jsxs)(l.A,{sx:{fontSize:14,fontWeight:600},children:["\u20b9 ",Pt.toFixed(2)]})]}),(jo||zo)&&(0,z.jsxs)(z.Fragment,{children:[jo&&Ft>0&&(0,z.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",mb:1,animation:jo?"slideInLeft 0.5s ease-out":"none","@keyframes slideInLeft":{"0%":{opacity:0,transform:"translateX(-20px)"},"100%":{opacity:1,transform:"translateX(0)"}}},children:[(0,z.jsx)(l.A,{sx:{fontSize:14,fontWeight:600,color:"#2e7d32"},children:"Hotel Discount:"}),(0,z.jsxs)(l.A,{sx:{fontSize:14,fontWeight:600,color:"#2e7d32",animation:jo?"discountPulse 1s ease-in-out":"none","@keyframes discountPulse":{"0%, 100%":{transform:"scale(1)"},"50%":{transform:"scale(1.1)"}}},children:["- \u20b9 ",Ft.toFixed(2)]})]}),zo&&Nt>0&&(0,z.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",mb:1.5,animation:zo?"slideInLeft 0.5s ease-out 0.2s":"none",animationFillMode:"both"},children:[(0,z.jsx)(l.A,{sx:{fontSize:14,fontWeight:600,color:"green"},children:"Huts4u Discount:"}),(0,z.jsxs)(l.A,{sx:{fontSize:14,fontWeight:600,color:"green",animation:zo?"discountPulse 1s ease-in-out 0.3s":"none",animationFillMode:"both"},children:["- \u20b9 ",Nt.toFixed(2)]})]}),(0,z.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",mb:1.5,animation:Gt>0?"slideInLeft 0.5s ease-out 0.4s":"none",animationFillMode:"both"},children:[(0,z.jsx)(l.A,{sx:{fontSize:14,fontWeight:600},children:"Total Discount:"}),(0,z.jsxs)(l.A,{sx:{fontSize:14,fontWeight:600,color:"red",animation:Gt>0?"highlightDiscount 1s ease-in-out":"none","@keyframes highlightDiscount":{"0%":{color:"red"},"50%":{color:"#ff6b6b"},"100%":{color:"red"}}},children:["- \u20b9 ",Gt.toFixed(2)]})]})]}),(0,z.jsx)(J.A,{sx:{my:1}}),(0,z.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,z.jsx)(l.A,{sx:{fontSize:14,fontWeight:600},children:"Total After Discount:"}),(0,z.jsxs)(l.A,{sx:{fontSize:14,fontWeight:600,color:ke.A.firstColor},children:["\u20b9 ",(Pt-Gt).toFixed(2)]})]}),(0,z.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1.5,pt:1.5,borderTop:"1px solid #ddd",animation:Wt>0?"finalTotalAnimation 0.8s ease-out":"none","@keyframes finalTotalAnimation":{"0%":{opacity:0,transform:"translateY(10px)"},"100%":{opacity:1,transform:"translateY(0)"}}},children:[(0,z.jsx)(l.A,{sx:{fontSize:16,fontWeight:700,color:ke.A.firstColor},children:"Total Payable"}),(0,z.jsxs)(l.A,{sx:{fontSize:18,fontWeight:700,color:ke.A.firstColor,animation:Wt>0?"totalBounce 0.8s ease-out":"none","@keyframes totalBounce":{"0%":{transform:"scale(0.8)"},"50%":{transform:"scale(1.1)"},"100%":{transform:"scale(1)"}}},children:["\u20b9 ",qt.toFixed(2)]})]}),(0,z.jsxs)(i.A,{sx:{mt:1.5},children:[(jo||zo)&&(0,z.jsx)(i.A,{sx:{p:1.5,bgcolor:"#e8f5e9",borderRadius:1,border:"1px solid #c8e6c9",mb:1,animation:"slideInBottom 0.5s ease-out","@keyframes slideInBottom":{"0%":{opacity:0,transform:"translateY(20px)"},"100%":{opacity:1,transform:"translateY(0)"}}},children:(0,z.jsxs)(l.A,{sx:{fontSize:13,color:"#2e7d32",fontWeight:600,textAlign:"center"},children:["\ud83c\udf89 You saved \u20b9 ",Gt.toFixed(2)," with discounts!"]})}),"verified"===Vo&&(0,z.jsx)(i.A,{sx:{p:1.5,bgcolor:"#e8f5e9",borderRadius:1,border:"1px solid #c8e6c9",animation:"slideInBottom 0.5s ease-out 0.2s",animationFillMode:"both"},children:(0,z.jsxs)(l.A,{sx:{fontSize:13,color:"#2e7d32",fontWeight:600,textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[(0,z.jsx)(ue.A,{fontSize:"small"}),"GST Invoice will be generated with your booking"]})})]})]})]})}),(0,z.jsxs)(Q.A,{open:fo,onClose:()=>vo(!1),maxWidth:"sm",fullWidth:!0,children:[(0,z.jsx)(K.A,{children:"Terms & Conditions"}),(0,z.jsxs)(ee.A,{children:[(0,z.jsx)(l.A,{variant:"body2",sx:{whiteSpace:"pre-line"},children:"\nBy booking, you agree to the property's terms and conditions, cancellation policy, and house rules.\nYou also agree to follow Huts4u's official Terms & Conditions mentioned on the link below.\nPlease ensure you have read and understood all applicable policies.\n"}),(0,z.jsx)(l.A,{variant:"body2",sx:{color:ke.A.firstColor,textDecoration:"underline",cursor:"pointer",fontWeight:600},onClick:()=>window.open("https://huts4u.com/terms","_blank"),children:"Open Huts4u Terms & Conditions"})]}),(0,z.jsx)(oe.A,{children:(0,z.jsx)(d.A,{onClick:()=>{vo(!1)},children:"Close"})})]})]})},Pe={borderRadius:"52px",boxShadow:"4px 4px 10px rgba(104, 39, 184, 0.17)",color:ke.A.firstColor,background:"white",fontSize:{xs:"12px",md:"14px"},width:"fit-content",p:1,px:2,mb:1}}}]);
//# sourceMappingURL=991.bff5a00a.chunk.js.map