"use strict";(self.webpackChunkhuts4u=self.webpackChunkhuts4u||[]).push([[339],{17339:(e,o,i)=>{i.r(o),i.d(o,{calculatePriceBreakdown:()=>Ye,default:()=>Te});var t=i(89379),l=i(7353),r=i(12110),n=i(26494),s=i(94496),a=i(14194),d=i(11906),c=i(36591),u=i(67784),m=i(17392),x=i(53193),h=i(79190),v=i(57465),p=i(32143),f=i(43845),g=i(81637),A=i(77739),b=i(74605),y=i(80045),j=i(65043),S=i(58387),k=i(98610),D=i(39768),C=i(33064),z=i(59662),R=i(70579);const I=(0,z.A)((0,R.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Y=(0,z.A)((0,R.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),T=(0,z.A)((0,R.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var w=i(6803),M=i(61475),P=i(92532),N=i(72372);function F(e){return(0,N.Ay)("MuiCheckbox",e)}const G=(0,P.A)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]);var H=i(34535),O=i(56262),W=i(52445),B=i(98206),V=i(81139),E=i(4162);const _=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","disableRipple","className","slots","slotProps"],L=(0,H.Ay)(C.A,{shouldForwardProp:e=>(0,M.A)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:i}=e;return[o.root,i.indeterminate&&o.indeterminate,o["size".concat((0,w.A)(i.size))],"default"!==i.color&&o["color".concat((0,w.A)(i.color))]]}})((0,O.A)(e=>{let{theme:o}=e;return{color:(o.vars||o).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:o.vars?"rgba(".concat(o.vars.palette.action.activeChannel," / ").concat(o.vars.palette.action.hoverOpacity,")"):(0,D.X4)(o.palette.action.active,o.palette.action.hoverOpacity)}}},...Object.entries(o.palette).filter((0,W.A)()).map(e=>{let[i]=e;return{props:{color:i,disableRipple:!1},style:{"&:hover":{backgroundColor:o.vars?"rgba(".concat(o.vars.palette[i].mainChannel," / ").concat(o.vars.palette.action.hoverOpacity,")"):(0,D.X4)(o.palette[i].main,o.palette.action.hoverOpacity)}}}}),...Object.entries(o.palette).filter((0,W.A)()).map(e=>{let[i]=e;return{props:{color:i},style:{["&.".concat(G.checked,", &.").concat(G.indeterminate)]:{color:(o.vars||o).palette[i].main},["&.".concat(G.disabled)]:{color:(o.vars||o).palette.action.disabled}}}}),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}})),U=(0,R.jsx)(Y,{}),Z=(0,R.jsx)(I,{}),q=(0,R.jsx)(T,{}),X=j.forwardRef(function(e,o){var i,l,r;const n=(0,B.b)({props:e,name:"MuiCheckbox"}),{checkedIcon:s=U,color:a="primary",icon:d=Z,indeterminate:c=!1,indeterminateIcon:u=q,inputProps:m,size:x="medium",disableRipple:h=!1,className:v,slots:p={},slotProps:f={}}=n,g=(0,y.A)(n,_),A=c?u:d,b=c?u:s,D=(0,t.A)((0,t.A)({},n),{},{disableRipple:h,color:a,indeterminate:c,size:x}),C=(e=>{const{classes:o,indeterminate:i,color:l,size:r}=e,n={root:["root",i&&"indeterminate","color".concat((0,w.A)(l)),"size".concat((0,w.A)(r))]},s=(0,k.A)(n,F,o);return(0,t.A)((0,t.A)({},o),s)})(D),z=null!==(i=f.input)&&void 0!==i?i:m,[I,Y]=(0,E.A)("root",{ref:o,elementType:L,className:(0,S.A)(C.root,v),shouldForwardComponentProp:!0,externalForwardedProps:(0,t.A)({slots:p,slotProps:f},g),ownerState:D,additionalProps:{type:"checkbox",icon:j.cloneElement(A,{fontSize:null!==(l=A.props.fontSize)&&void 0!==l?l:x}),checkedIcon:j.cloneElement(b,{fontSize:null!==(r=b.props.fontSize)&&void 0!==r?r:x}),disableRipple:h,slots:p,slotProps:{input:(0,V.A)("function"===typeof z?z(D):z,{"data-indeterminate":c})}}});return(0,R.jsx)(I,(0,t.A)((0,t.A)({},Y),{},{classes:C}))}),$=X;var K=i(39336),Q=i(83462),J=i(26600),ee=i(35316),oe=i(29347);const ie=(0,z.A)((0,R.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");var te=i(33438),le=i(83560);const re=(0,z.A)((0,R.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd"),ne=(0,z.A)((0,R.jsx)("path",{d:"m23 12-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69zm-12.91 4.72-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48z"}),"Verified");var se=i(84770);const ae=(0,z.A)((0,R.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy"),de=(0,z.A)((0,R.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var ce=i(70141);const ue=(0,z.A)((0,R.jsx)("path",{d:"m21.41 11.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58s1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41s-.23-1.06-.59-1.42M5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7"}),"LocalOffer");var me=i(60446),xe=i.n(me),he=i(63516),ve=i(17195),pe=i.n(ve),fe=i(73216),ge=i(57488),Ae=i(80899),be=i(31716),ye=i(69995),je=i(59007),Se=i(33580),ke=i(82533);const De=e=>{let{orderDetails:o,bookingDetails:i}=e;const[l,r]=(0,j.useState)(""),[n,s]=(0,j.useState)(""),[a,c]=((0,fe.Zp)(),(0,j.useState)(!0));console.log(i),(0,j.useEffect)(()=>{var e;"hourly"!==(null===i||void 0===i?void 0:i.bookingType)&&(0,ye.ge)(null===i||void 0===i||null===(e=i.room)||void 0===e?void 0:e.id).then(e=>{var o,i,t,l;r((null===e||void 0===e||null===(o=e.data)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.checkInTime)||""),s((null===e||void 0===e||null===(t=e.data)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.checkOutTime)||"")})},[i]);const u=()=>c(!1);return(0,R.jsx)("div",{children:(0,R.jsxs)(Q.A,{open:a,onClose:u,maxWidth:"xs",fullWidth:!0,sx:{"& .MuiPaper-root":{padding:"8px",borderRadius:"16px"}},children:[(0,R.jsx)(J.A,{children:"Complete Your Payment"}),(0,R.jsx)(ee.A,{children:(0,R.jsx)("p",{children:"Ensure your payment details are correct before proceeding."})}),(0,R.jsxs)(oe.A,{style:{display:"flex",justifyContent:"flex-end"},children:[(0,R.jsx)(d.A,{style:{textTransform:"none",color:"black"},onClick:u,children:"Cancel"}),(0,R.jsx)(d.A,{onClick:async()=>{var e,r,s;var a;if(!await(a="https://checkout.razorpay.com/v1/checkout.js",new Promise(e=>{const o=document.createElement("script");o.src=a,o.onload=()=>e(!0),o.onerror=()=>e(!1),document.body.appendChild(o)}))||!window.Razorpay)return void alert("Failed to load Razorpay SDK.");const d=(()=>{var e,o,t,r;return"hourly"===(null===i||void 0===i?void 0:i.bookingType)?{checkInTime:null===i||void 0===i||null===(e=i.timing)||void 0===e?void 0:e.checkInTime,checkOutTime:null===i||void 0===i||null===(o=i.timing)||void 0===o?void 0:o.checkOutTime}:{checkInTime:l||(null===i||void 0===i||null===(t=i.timing)||void 0===t?void 0:t.checkInTime),checkOutTime:n||(null===i||void 0===i||null===(r=i.timing)||void 0===r?void 0:r.checkOutTime)}})(),c={key:je.tz||"",amount:o.data.amount,currency:o.data.currency,order_id:o.data.id,prefill:{name:null===i||void 0===i||null===(e=i.guestInfo)||void 0===e?void 0:e.name,email:null===i||void 0===i||null===(r=i.guestInfo)||void 0===r?void 0:r.email,contact:null===i||void 0===i||null===(s=i.guestInfo)||void 0===s?void 0:s.phoneNumber},handler:async e=>{try{var l,r,n,s,a,c,u,m;const x=await(0,ye.KF)({orderId:e.razorpay_order_id,paymentId:e.razorpay_payment_id,signature:e.razorpay_signature});console.log(x),alert("Payment Successful");const h=(0,t.A)({userId:(0,ke.F6)(),hotelId:null===i||void 0===i||null===(l=i.hotel)||void 0===l?void 0:l.id,roomId:null===i||void 0===i||null===(r=i.room)||void 0===r?void 0:r.id,geustName:null===i||void 0===i||null===(n=i.guestInfo)||void 0===n?void 0:n.name,amountPaid:o.data.amount,checkInDate:null===i||void 0===i||null===(s=i.timing)||void 0===s?void 0:s.checkInDate,checkInTime:d.checkInTime,checkOutTime:d.checkOutTime,checkOutDate:null===i||void 0===i||null===(a=i.timing)||void 0===a?void 0:a.checkOutDate,bookingType:null===i||void 0===i?void 0:i.bookingType,geustDetails:null===i||void 0===i?void 0:i.guestInfo,adults:null===i||void 0===i?void 0:i.adults,children:null===i||void 0===i?void 0:i.children,hotelName:null===i||void 0===i||null===(c=i.hotel)||void 0===c?void 0:c.propertyName,status:"pending",paymentId:null===x||void 0===x||null===(u=x.data)||void 0===u||null===(m=u.data)||void 0===m?void 0:m.id,rooms:null===i||void 0===i?void 0:i.rooms},(null===i||void 0===i?void 0:i.gstDetails)&&{GstDetail:i.gstDetails});console.log(h),(0,ye.UY)(h).then(e=>{var l,r,n,s,a,c,u,m,x,h,v,p,f,g,A,b,y,j,S,k,D,C,z,R,I,Y,T,w,M,P,N,F,G,H,O,W,B,V,E,_,L,U,Z,q,X,$,K;const Q=(0,t.A)({userId:(0,ke.F6)(),paymentId:null===e||void 0===e||null===(l=e.data)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.id,hotelId:null===i||void 0===i||null===(n=i.hotel)||void 0===n?void 0:n.id,roomId:null===i||void 0===i||null===(s=i.room)||void 0===s?void 0:s.id,bookingId:null===e||void 0===e||null===(a=e.data)||void 0===a||null===(c=a.data)||void 0===c?void 0:c.id,amountPaise:o.data.amount,feePaise:100*((null===i||void 0===i||null===(u=i.pricingDetails)||void 0===u?void 0:u.platformFee)+(null===i||void 0===i||null===(m=i.pricingDetails)||void 0===m?void 0:m.gstOnPlatform)),netAmountPaise:100*((null===i||void 0===i||null===(x=i.pricingDetails)||void 0===x?void 0:x.basePrice)+(null===i||void 0===i||null===(h=i.pricingDetails)||void 0===h?void 0:h.gstOnBase)),currency:"INR",bookingsIncluded:[{id:null===e||void 0===e||null===(v=e.data)||void 0===v||null===(p=v.data)||void 0===p?void 0:p.id,bookingDate:null===e||void 0===e||null===(f=e.data)||void 0===f||null===(g=f.data)||void 0===g?void 0:g.checkInDate}],scheduledAt:xe()(null===i||void 0===i||null===(A=i.timing)||void 0===A?void 0:A.checkInDate,"DD MMM YYYY").toDate(),status:"pending",transactionRef:null,gatewayResponse:null,failureReason:null,processedBy:null,note:"Daily PayOut "},(null===i||void 0===i?void 0:i.gstDetails)&&{GstDetail:i.gstDetails}),J=(0,t.A)({userId:(0,ke.F6)(),paymentId:null===e||void 0===e||null===(b=e.data)||void 0===b||null===(y=b.data)||void 0===y?void 0:y.id,hotelId:null===i||void 0===i||null===(j=i.hotel)||void 0===j?void 0:j.id,bookingId:null===e||void 0===e||null===(S=e.data)||void 0===S||null===(k=S.data)||void 0===k?void 0:k.id,roomId:null===i||void 0===i||null===(D=i.room)||void 0===D?void 0:D.id,amountPaise:o.data.amount,feePaise:100*((null===i||void 0===i||null===(C=i.pricingDetails)||void 0===C?void 0:C.platformFee)+(null===i||void 0===i||null===(z=i.pricingDetails)||void 0===z?void 0:z.gstOnPlatform)),netmyAmountPaise:100*((null===i||void 0===i||null===(R=i.pricingDetails)||void 0===R?void 0:R.platformFee)+(null===i||void 0===i||null===(I=i.pricingDetails)||void 0===I?void 0:I.gstOnPlatform)),currency:"INR",bookingsIncluded:[null===e||void 0===e||null===(Y=e.data)||void 0===Y||null===(T=Y.data)||void 0===T?void 0:T.id],scheduledAt:xe()(null===i||void 0===i||null===(w=i.timing)||void 0===w?void 0:w.checkInDate,"DD MMM YYYY").toDate(),initiatedAt:new Date,processedAt:null,status:"pending",transactionRef:null,gatewayResponse:null,failureReason:null,processedBy:null,note:"Auto payout settlement"},(null===i||void 0===i?void 0:i.gstDetails)&&{GstDetail:i.gstDetails});console.log(J),(0,ye.VL)(J).then(e=>{console.log("My Payment is scheduled")}).catch(e=>{console.log("error while creating the mypayment",e)}),console.log(Q),(0,ye.fT)(Q).then(e=>{console.log("My Payout is scheduled")}).catch(e=>{console.log("error while creating the PayOut ",e)}),(0,ge.oR)(null===e||void 0===e||null===(M=e.data)||void 0===M?void 0:M.msg);const ee={guestName:null===i||void 0===i||null===(P=i.guestInfo)||void 0===P?void 0:P.name,location:null===i||void 0===i||null===(N=i.hotel)||void 0===N?void 0:N.address,hotelName:null===i||void 0===i||null===(F=i.hotel)||void 0===F?void 0:F.propertyName,checkInDate:xe()(null===i||void 0===i||null===(G=i.timing)||void 0===G?void 0:G.checkInDate,"DD MMM YYYY").format("DD MMM YYYY"),checkInTime:d.checkInTime,phone:null===i||void 0===i||null===(H=i.guestInfo)||void 0===H?void 0:H.phoneNumber,amountPaid:(null===i||void 0===i||null===(O=i.pricingDetails)||void 0===O?void 0:O.basePrice)+(null===i||void 0===i||null===(W=i.pricingDetails)||void 0===W?void 0:W.gstOnBase),basePrice:null===i||void 0===i||null===(B=i.pricingDetails)||void 0===B?void 0:B.basePrice,gstOnBase:null===i||void 0===i||null===(V=i.pricingDetails)||void 0===V?void 0:V.gstOnBase,razorpayfee:(null===i||void 0===i||null===(E=i.pricingDetails)||void 0===E?void 0:E.gstTotal)-((null===i||void 0===i||null===(_=i.pricingDetails)||void 0===_?void 0:_.gstOnBase)+(null===i||void 0===i||null===(L=i.pricingDetails)||void 0===L?void 0:L.gstOnPlatform)),platformFee:null===i||void 0===i||null===(U=i.pricingDetails)||void 0===U?void 0:U.platformFee,gstOnPlatform:null===i||void 0===i||null===(Z=i.pricingDetails)||void 0===Z?void 0:Z.gstOnPlatform,totalPrice:null===i||void 0===i||null===(q=i.pricingDetails)||void 0===q?void 0:q.totalPrice,adults:null===i||void 0===i?void 0:i.adults,children:null===i||void 0===i?void 0:i.children,rooms:1,checkOutTime:d.checkOutTime,checkOutDate:xe()(null===i||void 0===i||null===(X=i.timing)||void 0===X?void 0:X.checkOutDate,"DD MMM YYYY").format("DD MMM YYYY"),hotelEmail:null===i||void 0===i||null===($=i.hotel)||void 0===$?void 0:$.receptionEmail,receptionistPhone:null===i||void 0===i||null===(K=i.hotel)||void 0===K?void 0:K.receptionMobile};console.log(ee),(0,ye.Ud)(ee).then(e=>{console.log("message send to the wp",e)}).catch(e=>{console.log(e)}),window.location.href="/my-bookings"}).catch(e=>{console.log(e)})}catch(x){alert("Payment verification failed. Please try again.")}}};new window.Razorpay(c).open()},variant:"contained",style:{background:Se.A.firstColor,fontSize:"18px",textTransform:"none",border:"solid 1px white"},sx:{padding:"2px 10px",transition:"all 0.4s ease","&:hover":{paddingRight:"20px"}},children:"Proceed to Pay"})]})]})})};var Ce=i(61968),ze=i(88553),Re=i(75456);const Ie=Ae.Ik({name:Ae.Yj().required("Guest name is required"),email:Ae.Yj().email("Invalid email").optional(),phoneNumber:Ae.Yj().required("Phone number is required").test("is-valid-phone","Enter a valid phone number",e=>{if(!e)return!1;return e.slice(2).length>=10})}),Ye=function(e){let o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=Number(e)||0;if(!i||i<=0)return{basePrice:0,gstOnBase:0,platformFee:0,gstOnPlatform:0,convenienceFee:0,gstOnConvenience:0,totalWithoutDiscount:0,couponDiscount:0,finalPrice:0};const t=.05*i,l=.13*(i+t),r=.18*l,n=i+t+l+r,s=.02*n,a=.18*s,d=n+s+a;let c=0;o&&(c=.05*d);return{basePrice:i,gstOnBase:t,platformFee:l,gstOnPlatform:r,convenienceFee:s,gstOnConvenience:a,totalWithoutDiscount:d,couponDiscount:c,finalPrice:d-c}},Te=()=>{var e,o,i,y,S,k,D;const C=(0,fe.zy)(),z=null===(e=C.state)||void 0===e?void 0:e.hotelData,I=null===(o=C.state)||void 0===o?void 0:o.selectedRoom,Y=null===(i=C.state)||void 0===i?void 0:i.selectedSlot,T=null===(y=C.state)||void 0===y?void 0:y.pricingDetails,w=(null===(S=C.state)||void 0===S?void 0:S.inventoryData)||[];console.log("Received pricingDetails:",T),console.log("Received inventoryData:",w);const M=new URLSearchParams(C.search),P=M.get("bookingType"),N=M.get("time"),F=M.get("checkinDate"),G=M.get("checkOutDate"),H=M.get("rooms"),O=M.get("adults"),W=M.get("children"),[B,V]=(0,j.useState)(P),[E,_]=(0,j.useState)(N||"12:00"),[L,U]=(0,j.useState)(F||xe()().format("YYYY-MM-DD")),[Z,q]=(0,j.useState)(G||xe()().add(1,"day").format("YYYY-MM-DD")),[X,me]=(0,j.useState)(H||"1"),[ve,Ae]=(0,j.useState)(O||"1"),[je,Te]=(0,j.useState)(W||"0"),[Me,Pe]=(0,j.useState)(!1),[Ne,Fe]=(0,j.useState)(!1),[Ge,He]=(0,j.useState)(!1),[Oe,We]=(0,j.useState)(F||xe()().format("YYYY-MM-DD")),[Be,Ve]=(0,j.useState)(G||xe()().add(1,"day").format("YYYY-MM-DD")),[Ee,_e]=(0,j.useState)(N||"12:00"),Le=null===Y||void 0===Y?void 0:Y.slot,Ue=null===Le||void 0===Le||null===(k=Le.match(/\d+/))||void 0===k?void 0:k[0],Ze=Ue?parseInt(Ue,10):3,[qe,Xe]=(0,j.useState)(Ze),[$e,Ke]=(0,j.useState)(Ze),[Qe,Je]=(0,j.useState)({}),[eo,oo]=(0,j.useState)(!1),[io,to]=(0,j.useState)({phone:"",name:"",email:"",token:""}),[lo,ro]=(0,j.useState)(null),[no,so]=(0,j.useState)(!1),[ao,co]=(0,j.useState)(!1),[uo,mo]=(0,j.useState)("HUTS4U"),[xo,ho]=(0,j.useState)(!0),[vo,po]=(0,j.useState)(""),[fo,go]=(0,j.useState)(null),[Ao,bo]=(0,j.useState)(!1),[yo,jo]=(0,j.useState)(""),[So,ko]=(0,j.useState)(""),[Do,Co]=(0,j.useState)(""),[zo,Ro]=(0,j.useState)("none"),[Io,Yo]=(0,j.useState)(!1),[To,wo]=(0,j.useState)([]),[Mo,Po]=(0,j.useState)(null),[No,Fo]=(0,j.useState)(!1),[Go,Ho]=(0,j.useState)(!1),[Oo,Wo]=(0,j.useState)(null),[Bo,Vo]=(0,j.useState)(null),Eo=(0,j.useRef)(null),_o=(0,j.useRef)(null),Lo=(0,j.useRef)(null),Uo=((e,o,i,t)=>{let l=0,r=0,n=0;const s=[];if(e<=0)return{requiredRooms:1,extraGuestCount:0,extraGuestCharge:0,guestsPerRoom:[0]};l=Math.ceil(e/i);let a=e;for(let c=0;c<l;c++)a>=o?(s[c]=o,a-=o):(s[c]=a,a=0);let d=0;for(;a>0&&d<l;)s[d]<i&&(s[d]+=1,a-=1),d++,d>=l&&a>0&&(d=0);return s.forEach(e=>{if(e>o){const i=e-o;r+=i,n+=i*t}}),{requiredRooms:l,extraGuestCount:r,extraGuestCharge:n,guestsPerRoom:s}})(Number(ve)+Number(je),(null===I||void 0===I?void 0:I.standardRoomOccupancy)||1,(null===I||void 0===I?void 0:I.maxRoomOccupancy)||1,(null===I||void 0===I?void 0:I.additionalGuestRate)||0),{requiredRooms:Zo,extraGuestCount:qo,extraGuestCharge:Xo,guestsPerRoom:$o}=Uo,Ko=(()=>{var e;if(!I)return{isAvailable:!1,message:"Room information is missing"};const o=null===(e=I.status)||void 0===e?void 0:e.toLowerCase();return"available"===o||"active"===o?{isAvailable:!0,message:"Available"}:{isAvailable:!1,message:"This room is currently not available"}})(),Qo=Number((e=>{if(!I||!L||!e)return 0;const o=xe()(L).format("YYYY-MM-DD"),i=null===w||void 0===w?void 0:w.find(e=>xe()(e.date).format("YYYY-MM-DD")===o);if(console.log("DEBUG getInventoryPriceForDate:",{checkDay:o,slot:e,dayInventory:i,roomRates:{rateFor3Hour:I.rateFor3Hour,rateFor6Hour:I.rateFor6Hour,rateFor12Hour:I.rateFor12Hour,rateFor1Night:I.rateFor1Night}}),!i)switch(e){case"rateFor1Night":return I.rateFor1Night||0;case"rateFor3Hour":return I.rateFor3Hour||0;case"rateFor6Hour":return I.rateFor6Hour||0;case"rateFor12Hour":return I.rateFor12Hour||0;default:return 0}switch(e){case"rateFor1Night":return i.overnightRate||I.rateFor1Night||0;case"rateFor3Hour":return i.threeHourRate||I.rateFor3Hour||0;case"rateFor6Hour":return i.sixHourRate||I.rateFor6Hour||0;case"rateFor12Hour":return i.twelveHourRate||I.rateFor12Hour||0;default:return 0}})((()=>{if("hourly"!==B)return"rateFor1Night";switch(qe){case 3:default:return"rateFor3Hour";case 6:return"rateFor6Hour";case 12:return"rateFor12Hour"}})()));(0,j.useEffect)(()=>{Number(X)!==Zo&&me(Zo.toString())},[ve,je,I]),(0,j.useEffect)(()=>{T&&(console.log("Initializing calculatedPrice from pricingDetails:",T),Vo(T))},[T]),(0,j.useEffect)(()=>{(0,ke.M3)()&&Jo()},[]);const Jo=async()=>{try{var e;const o=await(0,ye.E$)(),i=null===o||void 0===o||null===(e=o.data)||void 0===e?void 0:e.data;Je(i),null!==i&&void 0!==i&&i._id&&ei(i._id)}catch(o){console.log("Error loading profile:",o),ge.oR.error("Failed to load user profile")}},ei=async e=>{if(e){Fo(!0);try{var o;const i=await(0,ye.dt)(e);console.log("GST API Response:",i);let l=[];null!==i&&void 0!==i&&null!==(o=i.data)&&void 0!==o&&o.data&&Array.isArray(i.data.data)?l=i.data.data:Array.isArray(null===i||void 0===i?void 0:i.data)&&(l=i.data),console.log("Raw GST Records:",l);const r=l.map(e=>e.gst_detail&&"object"===typeof e.gst_detail?(0,t.A)((0,t.A)({},e.gst_detail),{},{mappingId:e.id,userId:e.userId,gstId:e.gstId,isPrimary:e.isPrimary||!1,mappingCreatedAt:e.createdAt,mappingUpdatedAt:e.updatedAt}):e);console.log("Transformed GST Records:",r),wo(r);const n=r.filter(e=>!0===e.verified||"Active"===e.gstStatus);if(console.log("Verified GST Records:",n),n.length>0){const e=n[0];console.log("Auto-selecting GST Record:",e),Po(e),jo(e.gstNumber||""),ko(e.legalName||e.tradeName||""),Co(e.address||""),Ro("verified"),bo(!0),ge.oR.success("Auto-selected GST: ".concat(e.gstNumber))}else r.length>0&&(console.log("Showing non-verified GST records"),bo(!0))}catch(i){console.error("Error loading GST records:",i)}finally{Fo(!1)}}},oi=e=>{Po(e),jo(e.gstNumber||""),ko(e.legalName||""),Co(e.address||""),Ro(!0===e.verified||"Active"===e.gstStatus?"verified":"none"),Ho(!1),ge.oR.success("Selected GSTIN: ".concat(e.gstNumber))},ii=()=>{Po(null),jo(""),ko(""),Co(""),Ro("none"),Ho(!1),ge.oR.info("GST selection cleared")},ti=()=>{if(!L||!Z)return 1;const e=xe()(L,"YYYY-MM-DD",!0),o=xe()(Z,"YYYY-MM-DD",!0);if(!e.isValid()||!o.isValid())return 1;const i=o.diff(e,"day");return Math.max(1,i)},li=ti(),ri=(()=>{if(Bo&&!Me&&!Ne&&!Ge){console.log("Using existing calculatedPrice:",Bo);let e=0,o=Bo.totalPrice||0;xo&&(e=.05*o);const i=o-e;return{basePrice:Bo.basePrice||0,gstOnBase:Bo.gstOnBase||0,platformFee:Bo.platformFee||0,gstOnPlatform:Bo.gstOnPlatform||0,convenienceFee:Bo.gatewayFee||0,gstOnConvenience:.18*(Bo.gatewayFee||0),totalWithoutDiscount:o,couponDiscount:e,finalPrice:i,nights:li,totalMultiplier:Zo*("hourly"===B?qe/3:li),bookingType:B,slotDuration:qe,requiredRooms:Zo,unitBase:(Bo.basePrice||0)/Zo/("hourly"===B?qe/3:li)}}let e;if(console.log("Calculating price from scratch..."),"hourly"===B){e=Zo*(qe/3)}else e=Zo*li;const o=Ye(Qo*e,xo);return(0,t.A)((0,t.A)({},o),{},{nights:li,totalMultiplier:e,bookingType:B,slotDuration:qe,requiredRooms:Zo,unitBase:Qo})})(),{basePrice:ni,gstOnBase:si,platformFee:ai,gstOnPlatform:di,convenienceFee:ci,gstOnConvenience:ui,totalWithoutDiscount:mi,couponDiscount:xi,finalPrice:hi,unitBase:vi}=ri,pi=ni,fi=pi+700,gi=ni+ai,Ai=si+di+ci+ui,bi=Number(hi.toFixed(2)),yi=ai,ji=di/2,Si=di/2,ki=ci+ui,Di=bi,Ci=async()=>{try{if(!Di||Di<=0)return void ge.oR.error("Booking amount cannot be zero.");let e=null;"verified"===zo&&yo&&(e={gstNumber:yo,legalName:So,address:Do,verified:!0,gstRecordId:(null===Mo||void 0===Mo?void 0:Mo.id)||(null===Mo||void 0===Mo?void 0:Mo._id),gstStatus:(null===Mo||void 0===Mo?void 0:Mo.gstStatus)||"Active"});const o={amount:Math.round(Di),currency:"INR",metadata:{gstDetails:e,bookingType:B,hotelId:null===z||void 0===z?void 0:z._id,roomId:null===I||void 0===I?void 0:I._id}},i=await(0,ye.fS)(o);null!==i&&void 0!==i&&i.data?ro(i.data):ge.oR.error("Payment failed. Please try again.")}catch(e){console.error("Error during payment:",e),ge.oR.error("Payment failed. Please try again.")}},zi=(0,fe.Zp)(),Ri=(0,he.Wx)({initialValues:{name:Qe.userName||"",email:Qe.email||"",phoneNumber:Qe.phoneNumber?"91".concat(Qe.phoneNumber):"91"},validationSchema:Ie,enableReinitialize:!0,onSubmit:e=>{if(go(null),Ko.isAvailable){var o,i,t;if(!e.name.trim())return go("Guest name is required"),null===(o=Eo.current)||void 0===o||o.focus(),void(null===(i=Eo.current)||void 0===i||i.scrollIntoView({behavior:"smooth",block:"center"}));if(!e.phoneNumber||"91"===e.phoneNumber||e.phoneNumber.length<12)return go("Valid phone number is required"),void(null===(t=_o.current)||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center"}));if(no)if((0,ke.M3)())Ci();else{const o={name:e.name,email:e.email,phone:e.phoneNumber.slice(2)};(0,ye.AJ)(o).then(o=>{var i;console.log(o),oo(!0),(0,ge.oR)("OTP sent successfully. Please verify the OTP."),to({phone:e.phoneNumber.slice(2),name:e.name,email:e.email,token:null===o||void 0===o||null===(i=o.data)||void 0===i?void 0:i.data})}).catch(e=>{console.log(e)})}else go("Please accept Terms & Conditions before proceeding.")}else go(Ko.message)}}),Ii=async()=>{try{const o=(0,ke.F6)(),i=(null===Mo||void 0===Mo?void 0:Mo.id)||(null===Mo||void 0===Mo?void 0:Mo._id);if(o&&i){var e;const t={userId:o},l=await(0,ye.yZ)(i,t);null!==l&&void 0!==l&&null!==(e=l.data)&&void 0!==e&&e.success&&(ge.oR.success("GST record linked to your account!"),ei(o))}Ci()}catch(o){console.error("Error updating GST with user ID:",o),ge.oR.error("Could not link GST to account. Proceeding with payment..."),Ci()}},Yi=(0,j.useRef)(null),[Ti,wi]=(0,j.useState)("auto");(0,j.useEffect)(()=>{Yi.current&&wi("".concat(Yi.current.clientHeight,"px"))},[z,li,qe]);const Mi=(()=>{const e=[];for(let o=0;o<24;o++)for(let i=0;i<60;i+=30){const t="".concat(o.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"));e.push({value:t,label:xe()(t,"HH:mm").format("hh:mm A")})}return e})(),Pi=()=>{const e=""!==Ri.values.name.trim(),o=Ri.values.phoneNumber&&"91"!==Ri.values.phoneNumber&&Ri.values.phoneNumber.length>=12,i=no,t=Ko.isAvailable;return e&&o&&i&&t},Ni=(e,o)=>{Ri.setFieldValue(e,o),Ri.setFieldTouched(e,!0),fo&&go(null)},Fi=()=>{const e=xe()(L).format("YYYY-MM-DD");return(null===w||void 0===w?void 0:w.find(o=>xe()(o.date).format("YYYY-MM-DD")===e))?"Dynamic Inventory Pricing":"Standard Rate"};return(0,R.jsxs)(l.A,{sx:(0,t.A)((0,t.A)({},Ce.VX),{},{background:"#f6f6f6",mt:0,py:4,px:{xs:1,md:3},display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:"center",gap:"20px"}),children:[(0,R.jsx)(r.A,{sx:{p:1,background:"white",maxWidth:"700px",border:"none",boxShadow:0,borderRadius:"12px"},children:(0,R.jsxs)(n.A,{children:[(0,R.jsx)(s.A,{variant:"h6",gutterBottom:!0,sx:{color:Se.A.firstColor,fontWeight:"bold"},children:"Your Booking Summary"}),!Ko.isAvailable&&(0,R.jsxs)(a.A,{severity:"error",sx:{mb:2,borderRadius:2,"& .MuiAlert-message":{fontSize:"14px",fontWeight:500}},children:[Ko.message,(0,R.jsx)(d.A,{variant:"outlined",size:"small",sx:{ml:2},onClick:()=>zi(-1),children:"Go Back"})]}),(0,R.jsxs)(l.A,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:{xs:0,md:2},position:"relative",mt:2,height:"fit-content",alignItems:"stretch"},children:[(0,R.jsx)(c.A,{component:"img",sx:{width:{xs:"100%",md:"250px"},borderRadius:"12px",objectFit:"cover",height:Ti,transition:"height 0.3s ease"},image:null===z||void 0===z||null===(D=z.propertyImages)||void 0===D?void 0:D[0]}),(0,R.jsxs)("div",{style:{height:"fit-content"},ref:Yi,children:[(0,R.jsx)(s.A,{sx:{fontSize:"20px",fontWeight:600,color:Se.A.firstColor,mt:{xs:1.5,md:1},display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:1,WebkitBoxOrient:"vertical"},children:null===z||void 0===z?void 0:z.propertyName}),(0,R.jsx)(s.A,{sx:{fontFamily:"CustomFontSB",fontSize:{xs:"12px",md:"14px"},display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:1,WebkitBoxOrient:"vertical"},children:null===z||void 0===z?void 0:z.address}),(0,R.jsx)(s.A,{sx:{fontSize:14,color:Se.A.forthColor,fontStyle:"italic",mb:1,mt:.5},children:"hourly"===B?"Hourly Booking":"Daily/Overnight Booking"}),(0,R.jsxs)("div",{style:{marginTop:"10px",display:"flex",flexWrap:"wrap",flexDirection:"column",gap:"4px"},children:[(0,R.jsx)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:Me?(0,R.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,R.jsx)(u.A,{type:"date",size:"small",value:Oe,onChange:e=>{We(e.target.value),Vo(null)},InputLabelProps:{shrink:!0},sx:{width:150},InputProps:{sx:{height:36}}}),(0,R.jsx)(m.A,{size:"small",onClick:()=>{if(Oe)if(xe()(Oe,"YYYY-MM-DD",!0).isValid())if("hourly"===B)U(Oe),Pe(!1),ge.oR.success("Check-in date updated");else{if(xe()(Oe).isAfter(xe()(Be)))return void ge.oR.error("Check-in date cannot be after check-out date");U(Oe),Pe(!1),ge.oR.success("Check-in date updated")}else ge.oR.error("Invalid date format. Please use YYYY-MM-DD format");else ge.oR.error("Please select a check-in date")},sx:{color:"green"},children:(0,R.jsx)(ie,{})}),(0,R.jsx)(m.A,{size:"small",onClick:()=>{We(L),Pe(!1)},sx:{color:"red"},children:(0,R.jsx)(te.A,{})})]}):(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(s.A,{sx:we,children:[(0,R.jsx)("strong",{children:"Check-In Date:"})," ",xe()(L,"YYYY-MM-DD").format("DD MMM YYYY")]}),(0,R.jsx)(m.A,{size:"small",onClick:()=>{We(L),Pe(!0)},sx:{ml:-1},children:(0,R.jsx)(le.A,{fontSize:"small"})})]})}),"hourly"===B&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(l.A,{sx:{display:"flex",alignItems:"center",gap:1,mt:1},children:Ge?(0,R.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:1,width:"100%"},children:[(0,R.jsx)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,R.jsxs)(x.A,{size:"small",sx:{minWidth:120},children:[(0,R.jsx)(h.A,{children:"Check-in Time"}),(0,R.jsx)(v.A,{value:Ee,onChange:e=>_e(e.target.value),label:"Check-in Time",children:Mi.map(e=>(0,R.jsx)(p.A,{value:e.value,children:e.label},e.value))})]})}),(0,R.jsxs)(l.A,{sx:{display:"flex",gap:1},children:[(0,R.jsx)(m.A,{size:"small",onClick:()=>{Ee?Ee.match(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/)?(_(Ee),Xe($e),He(!1),ge.oR.success("Check-in time and duration updated")):ge.oR.error("Invalid time format. Please use HH:mm format"):ge.oR.error("Please select a check-in time")},sx:{color:"green"},children:(0,R.jsx)(ie,{})}),(0,R.jsx)(m.A,{size:"small",onClick:()=>{_e(E),Ke(qe),He(!1)},sx:{color:"red"},children:(0,R.jsx)(te.A,{})})]})]}):(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(s.A,{sx:we,children:[(0,R.jsx)("strong",{children:"Check-In Time:"})," ",E&&xe()(E,"HH:mm",!0).isValid()?xe()(E,"HH:mm").format("hh:mm A"):"12:00 PM"]}),(0,R.jsx)(m.A,{size:"small",onClick:()=>{_e(E),Ke(qe),He(!0)},sx:{ml:-1},children:(0,R.jsx)(le.A,{fontSize:"small"})})]})}),(0,R.jsxs)(s.A,{sx:we,children:[(0,R.jsx)("strong",{children:"Check-Out Time:"})," ",xe()("".concat(L," ").concat(E),"YYYY-MM-DD HH:mm").add(qe,"hour").format("DD MMM YYYY hh:mm A")]})]}),"hourly"!==B&&(0,R.jsx)(l.A,{sx:{display:"flex",alignItems:"center",gap:1,mt:1},children:Ne?(0,R.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,R.jsx)(u.A,{type:"date",size:"small",value:Be,onChange:e=>{Ve(e.target.value),Vo(null)},InputLabelProps:{shrink:!0},sx:{width:150},InputProps:{sx:{height:36}}}),(0,R.jsx)(m.A,{size:"small",onClick:()=>{Be?xe()(Be,"YYYY-MM-DD",!0).isValid()?xe()(Be).isBefore(xe()(Oe))?ge.oR.error("Check-out date cannot be before check-in date"):(q(Be),Fe(!1),ge.oR.success("Check-out date updated")):ge.oR.error("Invalid date format. Please use YYYY-MM-DD format"):ge.oR.error("Please select a check-out date")},sx:{color:"green"},children:(0,R.jsx)(ie,{})}),(0,R.jsx)(m.A,{size:"small",onClick:()=>{Ve(Z),Fe(!1)},sx:{color:"red"},children:(0,R.jsx)(te.A,{})})]}):(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(s.A,{sx:we,children:[(0,R.jsx)("strong",{children:"Check-Out Date:"})," ",xe()(Z,"YYYY-MM-DD").format("DD MMM YYYY")]}),(0,R.jsx)(m.A,{size:"small",onClick:()=>{Ve(Z),Fe(!0)},sx:{ml:-1},children:(0,R.jsx)(le.A,{fontSize:"small"})})]})}),"hourly"===B?(0,R.jsxs)(s.A,{sx:we,children:[(0,R.jsx)("strong",{children:"Duration: "}),qe," hrs"]}):(0,R.jsxs)(s.A,{sx:we,children:[(0,R.jsx)("strong",{children:"Nights: "}),li," night",li>1?"s":""]}),(0,R.jsxs)(s.A,{sx:we,children:[(0,R.jsx)("strong",{children:"Room type:"})," ",null===I||void 0===I?void 0:I.roomCategory]}),(0,R.jsx)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,R.jsxs)(s.A,{sx:we,children:[(0,R.jsx)("strong",{children:"Room Info: "}),Zo," Room",Zo&&Zo>1?"s":"",",",ve," Adult",ve&&Number(ve)>1?"s":"",",",je," Child",je&&Number(je)>1?"ren":""]})}),(0,R.jsxs)(s.A,{sx:{fontSize:12,color:Se.A.forthColor,mt:1,fontStyle:"italic"},children:[Fi()," \u2022 Price may vary by date and availability"]})]})]})]}),(0,R.jsxs)(l.A,{sx:{mt:2,p:1.5,bgcolor:"#f5f5f5",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[(0,R.jsx)(s.A,{variant:"caption",sx:{fontWeight:600,color:Se.A.forthColor,display:"block",mb:.5},children:"Room Occupancy Rules"}),(0,R.jsxs)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[(0,R.jsxs)(s.A,{variant:"caption",sx:{bgcolor:"#e3f2fd",color:"#1976d2",px:1,py:.5,borderRadius:"4px"},children:["Standard: ",(null===I||void 0===I?void 0:I.standardRoomOccupancy)||1," guest",(null===I||void 0===I?void 0:I.standardRoomOccupancy)>1?"s":""]}),(0,R.jsxs)(s.A,{variant:"caption",sx:{bgcolor:"#fff3e0",color:"#f57c00",px:1,py:.5,borderRadius:"4px"},children:["Maximum: ",(null===I||void 0===I?void 0:I.maxRoomOccupancy)||1," guest",(null===I||void 0===I?void 0:I.maxRoomOccupancy)>1?"s":""]}),(0,R.jsxs)(s.A,{variant:"caption",sx:{bgcolor:"#e8f5e9",color:"#2e7d32",px:1,py:.5,borderRadius:"4px"},children:["Your Guest: ",Number(ve)+Number(je)," guest",Number(ve)+Number(je)>1?"s":""]}),(0,R.jsxs)(s.A,{variant:"caption",sx:{bgcolor:"#f3e5f5",color:"#7b1fa2",px:1,py:.5,borderRadius:"4px"},children:["Rooms needed: ",Zo]})]}),$o&&$o.length>0&&(0,R.jsxs)(l.A,{sx:{mt:2},children:[(0,R.jsx)(s.A,{variant:"caption",sx:{fontWeight:600,color:Se.A.forthColor,display:"block",mb:.5},children:"Room-wise Guest Distribution:"}),(0,R.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:$o.map((e,o)=>{const i=(null===I||void 0===I?void 0:I.standardRoomOccupancy)||1,t=e>i?e-i:0;return(0,R.jsxs)(s.A,{variant:"caption",sx:{bgcolor:t>0?"#ffebee":"#e8f5e9",color:t>0?"#c62828":"#2e7d32",px:1,py:.5,borderRadius:"4px"},children:["Room ",o+1,": ",e," guest",1!==e?"s":"",t>0&&" (+".concat(t," extra)")]},o)})})]}),qo>0&&(0,R.jsxs)(l.A,{sx:{mt:1.5,p:1,bgcolor:"#fff3e0",borderRadius:"6px",border:"1px solid #ffcc80"},children:[(0,R.jsxs)(s.A,{variant:"caption",sx:{fontWeight:600,color:"#e65100",display:"flex",alignItems:"center",gap:.5,mb:1},children:[(0,R.jsx)(re,{fontSize:"small"}),"Additional Guest Charges (Payable at Property):"]}),(0,R.jsxs)(l.A,{sx:{ml:2,mt:.5},children:[(0,R.jsxs)(s.A,{variant:"caption",sx:{display:"block"},children:["\u2022 ",qo," extra guest",qo>1?"s":""," across ",Zo," room",Zo>1?"s":"","(Standard occupancy: ",(null===I||void 0===I?void 0:I.standardRoomOccupancy)||1," guest",(null===I||void 0===I?void 0:I.standardRoomOccupancy)>1?"s":""," per room)"]}),(0,R.jsxs)(s.A,{variant:"caption",sx:{display:"block",fontWeight:600,color:"#e65100",mt:.5},children:["\u2022 Total extra charge: \u20b9 ",Xo.toFixed(2)]}),(0,R.jsx)(s.A,{variant:"caption",sx:{display:"block",color:"#666",mt:.5},children:"Note: This amount will be collected directly by the property during check-in."})]})]})]}),fo&&(0,R.jsx)(a.A,{severity:"error",sx:{mt:3,mb:2,borderRadius:2,"& .MuiAlert-message":{fontSize:"14px",fontWeight:500}},onClose:()=>go(null),children:fo}),(0,R.jsxs)("form",{onSubmit:Ri.handleSubmit,children:[(0,R.jsx)(s.A,{variant:"h6",mt:4,sx:{color:Se.A.firstColor,fontWeight:"bold"},children:"Guest Information"}),(0,R.jsx)(Ce.XY,{label:"Guest Name *",name:"name",fullWidth:!0,margin:"normal",value:Ri.values.name,onChange:e=>Ni("name",e.target.value),onBlur:Ri.handleBlur,error:Ri.touched.name&&Boolean(Ri.errors.name),helperText:Ri.touched.name&&Ri.errors.name?String(Ri.errors.name):" ",inputRef:Eo,sx:{"& .MuiFormHelperText-root":{color:"red",fontSize:"12px",marginLeft:1,marginTop:.5,fontWeight:500},"& .MuiOutlinedInput-root":{"&.Mui-error fieldset":{borderColor:"red",borderWidth:"2px"}}}}),(0,R.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",width:{xs:"100%",md:"100%"}},children:[(0,R.jsx)(pe(),{country:"in",onlyCountries:["in"],disableDropdown:!0,countryCodeEditable:!1,enableSearch:!1,value:Ri.values.phoneNumber,placeholder:"Phone Number",onChange:e=>Ri.setFieldValue("phoneNumber",e),onBlur:()=>Ri.setFieldTouched("phoneNumber",!0),inputStyle:{width:"100%",height:"56px",borderRadius:"52px",border:"none",outline:"none",boxShadow:"4px 4px 10px rgba(104, 39, 184, 0.17)",color:Se.A.firstColor,paddingLeft:"60px",fontSize:"16px",backgroundColor:"white"},buttonStyle:{borderRadius:"52px 0 0 52px",backgroundColor:"white",border:"none"},containerStyle:{width:"100%"},dropdownStyle:{borderRadius:"12px"}}),Ri.touched.phoneNumber&&Ri.errors.phoneNumber&&(0,R.jsx)(s.A,{sx:{color:"red",fontSize:"12px",mt:.5,ml:"14px"},children:Ri.errors.phoneNumber})]}),(0,R.jsx)(Ce.XY,{label:"Email Address (Optional)",name:"email",fullWidth:!0,margin:"normal",value:Ri.values.email,onChange:e=>Ni("email",e.target.value),onBlur:Ri.handleBlur,error:Ri.touched.email&&Boolean(Ri.errors.email),helperText:Ri.touched.email&&Ri.errors.email?String(Ri.errors.email):" ",sx:{"& .MuiFormHelperText-root":{fontSize:"12px",marginLeft:1,marginTop:.5}}}),(0,R.jsxs)(l.A,{sx:{mt:3,mb:2},children:[(0,R.jsxs)(l.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},mb:1,gap:{xs:1,sm:0}},children:[(0,R.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,R.jsx)(s.A,{variant:"subtitle1",sx:{color:Se.A.firstColor,fontWeight:"bold",fontSize:{xs:"1rem",sm:"1.1rem"}},children:"GST Details(Optional)"}),yo&&(0,R.jsx)(f.A,{label:"GST Added \u2713",color:"success",size:"small",icon:(0,R.jsx)(ne,{}),sx:{fontSize:{xs:"0.7rem",sm:"0.8rem"},height:{xs:28,sm:32}}})]}),(0,R.jsx)(l.A,{sx:{display:"flex",gap:1,width:{xs:"100%",sm:"auto"}},children:yo?(0,R.jsxs)(l.A,{sx:{display:"flex",gap:1},children:[(0,R.jsx)(d.A,{size:"small",variant:"outlined",onClick:ii,sx:{textTransform:"none",fontSize:{xs:"0.75rem",sm:"0.875rem"},minWidth:{xs:"80px",sm:"100px"},whiteSpace:"nowrap",borderColor:"#ff6b6b",color:"#ff6b6b","&:hover":{bgcolor:"#ffeaea",borderColor:"#ff4444"}},children:"Remove"}),(0,R.jsx)(d.A,{size:"small",variant:"outlined",onClick:()=>bo(!Ao),sx:{textTransform:"none",fontSize:{xs:"0.75rem",sm:"0.875rem"},minWidth:{xs:"100px",sm:"120px"},whiteSpace:"nowrap",borderColor:Se.A.firstColor,color:Se.A.firstColor,"&:hover":{bgcolor:"#f5f0ff"}},children:Ao?"Hide Details":"Change GST"})]}):(0,R.jsx)(d.A,{size:"small",variant:Ao?"outlined":"contained",onClick:()=>{bo(!Ao),(0,ke.M3)()&&!Ao&&ei((0,ke.F6)())},sx:{textTransform:"none",fontSize:{xs:"0.75rem",sm:"0.875rem"},minWidth:{xs:"100px",sm:"120px"},whiteSpace:"nowrap",bgcolor:Ao?"transparent":Se.A.firstColor,color:Ao?Se.A.firstColor:"white",borderColor:Ao?Se.A.firstColor:"transparent","&:hover":{bgcolor:Ao?"#f5f0ff":Se.A.firstColor,borderColor:Se.A.firstColor}},children:Ao?"Cancel":"Add GST"})})]}),!yo&&!Ao&&(0,R.jsx)(l.A,{sx:{p:{xs:1,sm:1.5},borderRadius:1.5,bgcolor:"#f0f7ff",border:"1px solid #cce5ff",mb:2},children:(0,R.jsxs)(s.A,{variant:"body2",sx:{color:"#0066cc",fontSize:{xs:"0.8rem",sm:"0.9rem"},display:"flex",alignItems:"center",gap:1},children:[(0,R.jsx)(se.A,{fontSize:"small"}),"Need a business invoice? Add your GST details to get a tax invoice with your booking."]})}),Ao&&(0,R.jsxs)(l.A,{sx:{p:{xs:1.5,sm:2},borderRadius:2,bgcolor:"#f8f9fa",border:"1px solid #dee2e6",animation:"slideDown 0.3s ease-out"},children:[No&&(0,R.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",my:2},children:(0,R.jsx)(g.A,{size:24})}),(0,ke.M3)()&&To.length>0&&!Go&&(0,R.jsxs)(l.A,{sx:{mb:3},children:[(0,R.jsxs)(s.A,{variant:"body2",sx:{mb:1.5,color:Se.A.forthColor,fontWeight:600,display:"flex",alignItems:"center",gap:1,fontSize:{xs:"0.85rem",sm:"0.9rem"}},children:[(0,R.jsx)(se.A,{fontSize:"small"}),"Your Saved GST Records:"]}),(0,R.jsx)(l.A,{sx:{p:{xs:1,sm:2},borderRadius:2,bgcolor:"white",border:"1px solid #e0e0e0",maxHeight:{xs:"250px",sm:"300px"},overflowY:"auto"},children:0===To.length?(0,R.jsxs)(l.A,{sx:{p:3,textAlign:"center",color:"#666"},children:[(0,R.jsx)(se.A,{sx:{fontSize:40,color:"#ddd",mb:1}}),(0,R.jsx)(s.A,{variant:"body2",children:"No saved GST records found"}),(0,R.jsx)(s.A,{variant:"caption",children:"Add your first GSTIN to save it for future bookings"})]}):To.map((e,o)=>{const i=!0===e.verified||"Active"===e.gstStatus,t=(null===Mo||void 0===Mo?void 0:Mo.id)===e.id||(null===Mo||void 0===Mo?void 0:Mo._id)===e._id;return(0,R.jsx)(l.A,{sx:{p:{xs:1,sm:1.5},mb:1.5,borderRadius:2,border:t?"2px solid ".concat(Se.A.firstColor):"1px solid #ddd",backgroundColor:t?"#f3e5f5":"white",cursor:"pointer","&:hover":{borderColor:Se.A.firstColor,backgroundColor:"#faf5ff"}},onClick:()=>oi(e),children:(0,R.jsxs)(l.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},gap:{xs:1,sm:0}},children:[(0,R.jsxs)(l.A,{sx:{flex:1,width:"100%"},children:[(0,R.jsxs)(l.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"flex-start",sm:"center"},gap:{xs:.5,sm:1},mb:.5},children:[(0,R.jsx)(s.A,{variant:"body2",sx:{fontWeight:600,fontSize:{xs:"0.85rem",sm:"0.9rem"}},children:e.gstNumber}),(0,R.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:.5,flexWrap:"wrap"},children:[i&&(0,R.jsx)(A.A,{title:"Verified GST",children:(0,R.jsx)(ne,{fontSize:"small",color:"success"})}),e.gstStatus&&(0,R.jsx)(f.A,{label:e.gstStatus,size:"small",color:"Active"===e.gstStatus?"success":"error",variant:"outlined",sx:{height:20,fontSize:"0.65rem"}})]})]}),(0,R.jsx)(s.A,{variant:"caption",sx:{color:"#666",display:"block",mb:.5,fontSize:{xs:"0.75rem",sm:"0.8rem"}},children:e.legalName}),(0,R.jsx)(s.A,{variant:"caption",sx:{color:"#888",display:"block",fontSize:{xs:"0.7rem",sm:"0.75rem"}},children:e.address})]}),(0,R.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:.5,width:{xs:"100%",sm:"auto"},justifyContent:{xs:"flex-end",sm:"flex-start"},mt:{xs:1,sm:0}},children:[t?(0,R.jsx)(f.A,{label:"Selected",size:"small",color:"success",icon:(0,R.jsx)(ie,{}),sx:{height:24,fontSize:"0.7rem"}}):(0,R.jsx)(d.A,{size:"small",variant:"outlined",onClick:o=>{o.stopPropagation(),oi(e)},sx:{fontSize:"0.75rem",minWidth:"70px"},children:"Select"}),(0,R.jsxs)(l.A,{sx:{display:"flex",gap:.5},children:[(0,R.jsx)(A.A,{title:"Copy GSTIN",children:(0,R.jsx)(m.A,{size:"small",sx:{fontSize:{xs:"0.8rem",sm:"1rem"}},onClick:o=>{var i;o.stopPropagation(),i=e.gstNumber,navigator.clipboard.writeText(i).then(()=>ge.oR.success("GSTIN copied to clipboard")).catch(()=>ge.oR.error("Failed to copy GSTIN"))},children:(0,R.jsx)(ae,{fontSize:"small"})})}),(0,R.jsx)(A.A,{title:"Remove from account",children:(0,R.jsx)(m.A,{size:"small",color:"error",sx:{fontSize:{xs:"0.8rem",sm:"1rem"}},onClick:o=>{o.stopPropagation(),(async e=>{if((0,ke.M3)()){if(window.confirm("Are you sure you want to remove this GST from your account?")){Wo(e);try{var o;const i={userId:(0,ke.F6)()};console.log(e),console.log(i);const t=await(0,ye.Av)(e,i.userId);null!==t&&void 0!==t&&null!==(o=t.data)&&void 0!==o&&o.success?(ge.oR.success("GST removed from your account"),wo(o=>o.filter(o=>o.id!==e&&o._id!==e)),!Mo||Mo.id!==e&&Mo._id!==e||ii()):ge.oR.error("Failed to remove GST")}catch(i){console.error("Error deleting GST:",i),ge.oR.error("Failed to remove GST")}finally{Wo(null)}}}else ge.oR.error("Please login to manage GST records")})(e.id||e._id)},disabled:Oo===(e.id||e._id),children:Oo===(e.id||e._id)?(0,R.jsx)(g.A,{size:16}):(0,R.jsx)(de,{fontSize:"small"})})})]})]})]})},e._id||e.id||o)})}),(0,R.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:2},children:(0,R.jsx)(d.A,{startIcon:(0,R.jsx)(ce.A,{}),variant:"outlined",onClick:()=>{Ho(!0),jo(""),ko(""),Co(""),Ro("none"),Po(null)},sx:{textTransform:"none",fontSize:{xs:"0.8rem",sm:"0.875rem"}},children:"Add New GST"})})]}),(Go||!(0,ke.M3)()||(0,ke.M3)()&&0===To.length)&&(0,R.jsxs)(l.A,{children:[(0,R.jsx)(s.A,{variant:"body2",sx:{mb:2,color:Se.A.forthColor,fontWeight:600,fontSize:{xs:"0.9rem",sm:"1rem"}},children:Go?"Add New GSTIN":"Enter GSTIN for Business Invoice"}),(0,R.jsxs)(l.A,{sx:{mb:2},children:[(0,R.jsxs)(l.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"},gap:{xs:1,sm:1},mb:1},children:[(0,R.jsx)(Ce.XY,{label:"GSTIN Number",fullWidth:!0,value:yo,onChange:e=>{const o=e.target.value.toUpperCase();if(jo(o),15===o.length){/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/i.test(o)||(ge.oR.error("Invalid GSTIN format. Please check the number."),Ro("invalid"))}},placeholder:"Enter 15-digit GSTIN",inputRef:Lo,disabled:"verified"===zo,sx:{flex:1},size:"small"}),(0,R.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:["verified"===zo&&(0,R.jsx)(A.A,{title:"GSTIN Verified",children:(0,R.jsx)(ne,{color:"success",sx:{fontSize:{xs:24,sm:28}}})}),(0,R.jsx)(d.A,{variant:"contained",size:"small",onClick:async()=>{var e;if(!yo.trim())return ge.oR.error("Please enter GSTIN number"),void(null===(e=Lo.current)||void 0===e||e.focus());if(!/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/i.test(yo.toUpperCase()))return ge.oR.error("Please enter a valid 15-digit GSTIN format"),void Ro("invalid");Yo(!0),Ro("pending");try{var o,i;const e=(0,ke.M3)()?(0,ke.F6)():null,u=(0,t.A)({gstNumber:yo.toUpperCase()},e&&{userId:e}),m=await(0,ye.Lb)(u);if(null!==m&&void 0!==m&&null!==(o=m.data)&&void 0!==o&&o.data){var l,r,n,s;const o=(null===(l=m.data)||void 0===l?void 0:l.data)||(null===(r=m.data)||void 0===r?void 0:r.result);Ro("verified"),ko((null===o||void 0===o?void 0:o.legalName)||(null===o||void 0===o?void 0:o.lgnm)||""),Co((null===o||void 0===o?void 0:o.address)||(null===o||void 0===o||null===(n=o.pradr)||void 0===n?void 0:n.adr)||"");const i=(0,t.A)((0,t.A)({},o),{},{id:null===o||void 0===o?void 0:o.id,gstNumber:(null===o||void 0===o?void 0:o.gstNumber)||yo.toUpperCase(),legalName:(null===o||void 0===o?void 0:o.legalName)||(null===o||void 0===o?void 0:o.lgnm)||"",address:(null===o||void 0===o?void 0:o.address)||(null===o||void 0===o||null===(s=o.pradr)||void 0===s?void 0:s.adr)||"",verified:!0});Po(i),ge.oR.success("GSTIN verified successfully!"),e&&ei(e)}else if("BAD_REQUEST"===(null===m||void 0===m||null===(i=m.data)||void 0===i?void 0:i.status)){var a;const o=(null===(a=m.data)||void 0===a?void 0:a.message)||"GST verification failed";if(o.includes("already exists")){var d;const o=null===(d=m.data)||void 0===d?void 0:d.data;if(e&&null!==o&&void 0!==o&&o.id)try{var c;const i=await(0,ye.yZ)(o.id,{userId:e});null!==i&&void 0!==i&&null!==(c=i.data)&&void 0!==c&&c.success&&ge.oR.success("GST linked to your account!")}catch(x){console.error("Error updating GST user ID:",x)}Ro("verified"),jo(o.gstNumber||yo.toUpperCase()),ko(o.legalName||""),Co(o.address||""),Po(o),ge.oR.info("Using existing GST record")}else Ro("invalid"),ge.oR.error(o)}else Ro("invalid"),ge.oR.error("GST verification failed. Please try again.")}catch(h){var u,m;if(console.error("GST verification error:",h),Ro("invalid"),"BAD_REQUEST"===(null===(u=h.response)||void 0===u||null===(m=u.data)||void 0===m?void 0:m.status)){const e=h.response.data;null!==e&&void 0!==e&&e.data?(Ro("verified"),ko(e.data.legalName||""),Co(e.data.address||""),Po(e.data),ge.oR.info("Using existing GST record")):ge.oR.error((null===e||void 0===e?void 0:e.message)||"Invalid GST number")}else ge.oR.error("Failed to verify GST. Please check your internet connection.")}finally{Yo(!1)}},disabled:Io||"verified"===zo||15!==yo.length,sx:{textTransform:"none",bgcolor:Se.A.firstColor,fontSize:{xs:"0.75rem",sm:"0.875rem"},minWidth:{xs:"100px",sm:"120px"},height:{xs:"36px",sm:"40px"}},startIcon:Io?(0,R.jsx)(g.A,{size:16,color:"inherit"}):null,children:Io?"Verifying...":"verified"===zo?"Verified":"Verify"})]})]}),"invalid"===zo&&(0,R.jsx)(a.A,{severity:"error",sx:{mt:1,fontSize:"0.8rem",py:.5},children:"Invalid GSTIN format. Please enter a valid 15-digit GSTIN."}),yo.length>0&&yo.length<15&&(0,R.jsx)(s.A,{variant:"caption",sx:{color:"warning.main",display:"block",mt:.5,fontSize:"0.75rem"},children:"Enter 15-digit GSTIN to verify"})]}),"verified"===zo&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(Ce.XY,{label:"Legal Business Name",fullWidth:!0,margin:"normal",size:"small",value:So,onChange:e=>ko(e.target.value),InputProps:{startAdornment:(0,R.jsx)(A.A,{title:"Verified",children:(0,R.jsx)(ne,{color:"success",sx:{mr:1,fontSize:20}})})},sx:{mb:2}}),(0,R.jsx)(Ce.XY,{label:"Registered Business Address",fullWidth:!0,margin:"normal",size:"small",multiline:!0,rows:2,value:Do,onChange:e=>Co(e.target.value),InputProps:{startAdornment:(0,R.jsx)(A.A,{title:"Verified",children:(0,R.jsx)(ne,{color:"success",sx:{mr:1,fontSize:20}})})},sx:{mb:2}}),(0,R.jsxs)(a.A,{severity:"success",sx:{mb:2,fontSize:"0.9rem"},icon:(0,R.jsx)(ne,{}),children:[(0,R.jsx)(s.A,{variant:"body2",sx:{fontWeight:600},children:"GSTIN verified successfully!"}),(0,R.jsx)(s.A,{variant:"caption",children:"This GST will be added to your invoice"})]}),(0,ke.M3)()&&(0,R.jsx)(s.A,{variant:"caption",sx:{color:"#666",display:"block",textAlign:"center",mt:1,fontSize:"0.8rem"},children:"This GST record will be saved to your account for future bookings"})]}),(0,ke.M3)()&&To.length>0&&Go&&(0,R.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:2},children:(0,R.jsx)(d.A,{variant:"text",size:"small",onClick:()=>{Ho(!1),jo(""),ko(""),Co(""),Ro("none")},sx:{textTransform:"none",fontSize:"0.8rem"},children:"\u2190 Back to Saved GST Records"})})]}),Mo&&(0,R.jsxs)(a.A,{severity:"success",sx:{mt:2,fontSize:"0.9rem"},icon:(0,R.jsx)(ie,{}),children:[(0,R.jsx)(s.A,{variant:"body2",sx:{fontWeight:600},children:"Selected GST for Invoice:"}),(0,R.jsxs)(l.A,{sx:{ml:1,mt:.5},children:[(0,R.jsx)(s.A,{variant:"body2",sx:{fontWeight:600},children:Mo.gstNumber}),(0,R.jsx)(s.A,{variant:"caption",sx:{color:"#388e3c",display:"block"},children:Mo.legalName}),(0,R.jsx)(s.A,{variant:"caption",sx:{color:"#666",display:"block",mt:.5},children:Mo.address})]}),(0,R.jsx)(l.A,{sx:{display:"flex",justifyContent:"flex-end",mt:1},children:(0,R.jsx)(d.A,{size:"small",color:"error",onClick:ii,sx:{fontSize:"0.75rem"},children:"Remove GST"})})]}),!yo&&(0,R.jsx)(l.A,{sx:{p:{xs:1,sm:1.5},borderRadius:1.5,bgcolor:"#f0f7ff",border:"1px solid #cce5ff",mt:2},children:(0,R.jsxs)(s.A,{variant:"body2",sx:{color:"#0066cc",fontSize:{xs:"0.8rem",sm:"0.9rem"},display:"flex",alignItems:"center",gap:1},children:[(0,R.jsx)(Re.A,{fontSize:"small"}),(0,R.jsx)("strong",{children:"Optional:"})," Add GST only if you need a business invoice. You can proceed without GST for personal bookings."]})})]})]}),(0,R.jsxs)(l.A,{sx:{mt:3,mb:2},children:[(0,R.jsx)(s.A,{variant:"subtitle1",sx:{color:Se.A.firstColor,fontWeight:"bold",mb:1},children:"Huts4u Discount"}),xo?(0,R.jsxs)(l.A,{sx:{p:2,borderRadius:2,bgcolor:"#e8f5e9",border:"1px solid #c8e6c9",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,R.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,R.jsx)(ue,{color:"success"}),(0,R.jsxs)(l.A,{children:[(0,R.jsx)(s.A,{sx:{fontWeight:600,color:"#2e7d32"},children:"HUTS4U Discount Applied"}),(0,R.jsx)(s.A,{variant:"body2",sx:{color:"#388e3c"},children:"discount on total amount"}),(0,R.jsxs)(s.A,{variant:"caption",sx:{color:"#666",display:"block",mt:.5},children:["You saved \u20b9 ",xi.toFixed(2)]})]})]}),(0,R.jsx)(d.A,{variant:"outlined",color:"error",size:"small",onClick:()=>{ho(!1),ge.oR.info("Huts4u Discount removed. Prices updated.")},children:"Remove"})]}):(0,R.jsxs)(l.A,{sx:{p:2,borderRadius:2,bgcolor:"#fff3e0",border:"1px solid #ffcc80",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,R.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,R.jsx)(ue,{color:"warning"}),(0,R.jsx)(l.A,{children:(0,R.jsx)(s.A,{sx:{fontWeight:600,color:"#e65100"},children:"Huts4u Discount Available"})})]}),(0,R.jsx)(d.A,{variant:"contained",sx:{background:Se.A.firstColor},size:"small",onClick:()=>{ho(!0),ge.oR.success("Huts4u Discount applied!")},children:"Apply"})]}),xo&&(0,R.jsx)(s.A,{sx:{color:"green",fontSize:12,mt:1,textAlign:"center"},children:"\u2713  Huts4u Discount automatically applied to your booking"})]}),(0,R.jsx)(l.A,{sx:{mt:2},children:(0,R.jsx)(b.A,{control:(0,R.jsx)($,{checked:no,onChange:e=>{so(e.target.checked),fo&&e.target.checked&&go(null)},color:"primary"}),label:(0,R.jsxs)("span",{children:["I accept the"," ",(0,R.jsx)("span",{style:{color:Se.A.firstColor,cursor:"pointer",textDecoration:"underline"},onClick:()=>co(!0),children:"Terms & Conditions"})]})})}),(0,R.jsx)(be.A,{variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2,opacity:Pi()?1:.7,"&:disabled":{backgroundColor:"#e0e0e0",color:"#9e9e9e",cursor:"not-allowed"}},type:"submit",disabled:!Pi(),children:(0,ke.M3)()?"Pay Now":"Verify Phone & Pay"}),(0,R.jsx)(ze.A,{open:eo,onClose:()=>oo(!1),onVerificationSuccess:()=>{oo(!1),"verified"===zo&&Mo&&(0,ke.M3)()&&!Mo.userId?Ii():Ci()},phone:io.phone,name:io.name,email:io.email,token:io.token}),lo&&(0,R.jsx)(De,{orderDetails:lo,amount:Di,bookingDetails:{hotel:z,room:I,guestInfo:Ri.values,gstDetails:"verified"===zo?{gstNumber:yo,legalName:So,address:Do,verified:!0,gstRecordId:(null===Mo||void 0===Mo?void 0:Mo.id)||(null===Mo||void 0===Mo?void 0:Mo._id),gstStatus:(null===Mo||void 0===Mo?void 0:Mo.gstStatus)||"Active"}:null,timing:(()=>{if("hourly"===B&&E&&L&&qe){const e=xe()("".concat(L," ").concat(E),"YYYY-MM-DD HH:mm"),o=e.add(qe,"hour");return{checkInDate:e.format("DD MMM YYYY"),checkInTime:e.format("hh:mm A"),checkOutDate:o.format("DD MMM YYYY"),checkOutTime:o.format("hh:mm A"),duration:"".concat(qe," hrs"),bookingType:"hourly"}}{const e=ti();return{checkInDate:xe()(L,"YYYY-MM-DD").format("DD MMM YYYY"),checkInTime:"12:00 PM",checkOutDate:xe()(Z,"YYYY-MM-DD").format("DD MMM YYYY"),checkOutTime:"11:00 AM",duration:"".concat(e," night").concat(e>1?"s":""),bookingType:"daily"}}})(),pricingDetails:(0,t.A)((0,t.A)({},ri),{},{nights:li,rooms:Zo.toString(),adults:ve,children:je,bookingType:B,checkinDate:L,checkOutDate:Z,checkinTime:E,slotDuration:qe,extraGuestCount:qo,extraGuestCharge:Xo,guestsPerRoom:$o,inventoryData:w,unitBase:vi}),bookingType:B,rooms:Zo.toString(),adults:ve,children:je}})]})]})}),(0,R.jsx)(r.A,{sx:{p:1,background:"white",border:"none",boxShadow:0,borderRadius:"12px",height:"fit-content",minWidth:{md:"350px"}},children:(0,R.jsxs)(n.A,{children:[(0,R.jsx)(s.A,{variant:"h6",gutterBottom:!0,sx:{color:Se.A.firstColor,fontWeight:"bold"},children:"Your Bill Summary"}),"verified"===zo&&(0,R.jsxs)(l.A,{sx:{mb:2,p:1.5,bgcolor:"#e8f5e9",borderRadius:1,border:"1px solid #c8e6c9",display:"flex",alignItems:"center",gap:1},children:[(0,R.jsx)(ne,{color:"success",fontSize:"small"}),(0,R.jsxs)(l.A,{children:[(0,R.jsx)(s.A,{variant:"body2",sx:{fontWeight:600,color:"#2e7d32"},children:"GST Invoice Enabled"}),(0,R.jsxs)(s.A,{variant:"caption",sx:{color:"#388e3c",display:"block"},children:["GSTIN: ",yo]}),(0,R.jsx)(s.A,{variant:"caption",sx:{color:"#666",display:"block"},children:So})]})]}),(0,R.jsxs)(l.A,{sx:{mb:2,p:1.5,bgcolor:"#e3f2fd",borderRadius:1,border:"1px solid #bbdefb"},children:[(0,R.jsx)(s.A,{variant:"body2",sx:{fontWeight:600,color:"#1565c0"},children:Fi()}),(0,R.jsx)(s.A,{variant:"caption",sx:{color:"#1976d2",display:"block",mt:.5},children:"hourly"===B?"".concat(qe," hrs \u2022 ").concat(Zo," room").concat(Zo&&Zo>1?"s":""):"".concat(li," night").concat(li>1?"s":""," \u2022 ").concat(Zo," room").concat(Zo&&Zo>1?"s":"")}),xo&&(0,R.jsx)(s.A,{variant:"caption",sx:{color:"green",fontWeight:600,mt:.5,display:"block"},children:"\u2713  Huts4u Discount Applied"})]}),qo>0&&(0,R.jsxs)(l.A,{sx:{mb:2,p:1.5,bgcolor:"#fff3e0",borderRadius:"8px",border:"1px solid #ffcc80"},children:[(0,R.jsxs)(s.A,{variant:"caption",sx:{fontWeight:600,color:"#e65100",display:"flex",alignItems:"center",gap:.5,mb:1},children:[(0,R.jsx)(re,{fontSize:"small"}),"Additional Guest Charges"]}),(0,R.jsxs)(s.A,{variant:"body2",sx:{ml:2},children:[qo," extra guest",qo>1?"s":"",": \u20b9 ",Xo.toFixed(2)]}),(0,R.jsx)(s.A,{variant:"caption",sx:{display:"block",color:"#666",mt:1,fontStyle:"italic"},children:"Note: This amount will be collected directly by the property during check-in."})]}),(0,R.jsxs)("div",{style:{marginTop:"10px",display:"flex",flexWrap:"wrap",flexDirection:"column",gap:"8px",alignItems:"flex-end"},children:[(0,R.jsx)(s.A,{sx:{fontSize:"16px",color:Se.A.forthColor,textDecoration:"line-through",fontWeight:600,opacity:.95},children:pi>0?"\u20b9 ".concat(fi.toFixed(0)):"---"}),(0,R.jsx)(s.A,{sx:{fontSize:"24px",color:Se.A.firstColor,fontWeight:"bold"},children:gi>0?"\u20b9 ".concat(gi.toFixed(0)):"\u2014"}),(0,R.jsx)(s.A,{sx:{fontSize:"13px",color:Se.A.forthColor,textAlign:"right"},children:Ai>0?(0,R.jsxs)(R.Fragment,{children:["\u20b9",Ai.toFixed(0)," taxes & fees"]}):"\u2014"}),(0,R.jsx)(K.A,{sx:{width:"100%",mt:1}}),(0,R.jsxs)("div",{style:{width:"100%",textAlign:"right"},children:[xi>0&&xo&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(s.A,{sx:{fontSize:13,color:Se.A.forthColor},children:["Subtotal before discount: \u20b9 ",mi.toFixed(2)]}),(0,R.jsxs)(s.A,{sx:{fontSize:14,color:"green",fontWeight:600},children:["Huts4u Discount: - \u20b9 ",xi.toFixed(2)]})]}),(0,R.jsx)(s.A,{sx:{fontSize:"16px",color:Se.A.firstColor,fontWeight:"700",mt:xi>0&&xo?1:0},children:hi>0?"Final: \u20b9 ".concat(bi.toFixed(2)):"---"})]})]}),(0,R.jsxs)(l.A,{sx:{mt:3,borderRadius:2,border:"1px dashed #ddd",p:2,backgroundColor:"#fafafa"},children:[(0,R.jsx)(s.A,{sx:{fontSize:13,fontWeight:600,mb:1,color:Se.A.forthColor},children:"Detailed Breakup"}),(0,R.jsxs)(s.A,{sx:{fontSize:13},children:[(0,R.jsx)("strong",{children:"1. Base Price (Reimbursement)"})," ",(0,R.jsx)("span",{style:{fontSize:11},children:"(HSN 9985)"}),(0,R.jsxs)("span",{style:{float:"right"},children:["\u20b9 ",(ni+si).toFixed(2)]})]}),(0,R.jsxs)(s.A,{sx:{fontSize:13,mt:1},children:[(0,R.jsx)("strong",{children:"2. Service Charges"})," ",(0,R.jsx)("span",{style:{fontSize:11},children:"(HSN 996111)"}),(0,R.jsxs)("span",{style:{float:"right"},children:["\u20b9 ",yi.toFixed(2)]})]}),(0,R.jsxs)(s.A,{sx:{fontSize:12,ml:2,mt:.3},children:["CGST @ 9% on Service",(0,R.jsxs)("span",{style:{float:"right"},children:["\u20b9 ",ji.toFixed(2)]})]}),(0,R.jsxs)(s.A,{sx:{fontSize:12,ml:2},children:["SGST @ 9% on Service",(0,R.jsxs)("span",{style:{float:"right"},children:["\u20b9 ",Si.toFixed(2)]})]}),(0,R.jsxs)(s.A,{sx:{fontSize:13,mt:1},children:[(0,R.jsx)("strong",{children:"3. Convenience Fees (Incl. GST)"})," ",(0,R.jsx)("span",{style:{fontSize:11},children:"(Reimbursement, HSN 9985)"}),(0,R.jsxs)("span",{style:{float:"right"},children:["\u20b9 ",ki.toFixed(2)]})]}),(0,R.jsx)(K.A,{sx:{my:1.5}}),(0,R.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,R.jsx)(s.A,{sx:{fontSize:14,fontWeight:600},children:"Subtotal:"}),(0,R.jsxs)(s.A,{sx:{fontSize:14,fontWeight:600},children:["\u20b9 ",mi.toFixed(2)]})]}),xo&&xi>0&&(0,R.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1.5},children:[(0,R.jsx)(s.A,{sx:{fontSize:14,fontWeight:600,color:"green"},children:"Huts4u Discount:"}),(0,R.jsxs)(s.A,{sx:{fontSize:14,fontWeight:600,color:"green"},children:["- \u20b9 ",xi.toFixed(2)]})]}),(0,R.jsx)(K.A,{sx:{my:1}}),(0,R.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1.5},children:[(0,R.jsx)(s.A,{sx:{fontSize:16,fontWeight:700,color:Se.A.firstColor},children:"Total Payable"}),(0,R.jsxs)(s.A,{sx:{fontSize:18,fontWeight:700,color:Se.A.firstColor},children:["\u20b9 ",Di.toFixed(2)]})]}),"verified"===zo&&(0,R.jsx)(l.A,{sx:{mt:1.5,p:1.5,bgcolor:"#e8f5e9",borderRadius:1,border:"1px solid #c8e6c9"},children:(0,R.jsxs)(s.A,{sx:{fontSize:13,color:"#2e7d32",fontWeight:600,textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[(0,R.jsx)(ne,{fontSize:"small"}),"GST Invoice will be generated with your booking"]})}),xo&&xi>0&&(0,R.jsx)(l.A,{sx:{mt:1.5,p:1.5,bgcolor:"#e8f5e9",borderRadius:1},children:(0,R.jsxs)(s.A,{sx:{fontSize:13,color:"#2e7d32",fontWeight:600,textAlign:"center"},children:["\ud83c\udf89 You saved \u20b9 ",xi.toFixed(2)," with Huts4u Discount!"]})})]})]})}),(0,R.jsxs)(Q.A,{open:ao,onClose:()=>co(!1),maxWidth:"sm",fullWidth:!0,children:[(0,R.jsx)(J.A,{children:"Terms & Conditions"}),(0,R.jsxs)(ee.A,{children:[(0,R.jsx)(s.A,{variant:"body2",sx:{whiteSpace:"pre-line"},children:"\nBy booking, you agree to the property's terms and conditions, cancellation policy, and house rules.\nYou also agree to follow Huts4u's official Terms & Conditions mentioned on the link below.\nPlease ensure you have read and understood all applicable policies.\n"}),(0,R.jsx)(s.A,{variant:"body2",sx:{color:Se.A.firstColor,textDecoration:"underline",cursor:"pointer",fontWeight:600},onClick:()=>window.open("https://huts4u.com/terms","_blank"),children:"Open Huts4u Terms & Conditions"})]}),(0,R.jsx)(oe.A,{children:(0,R.jsx)(d.A,{onClick:()=>{co(!1)},children:"Close"})})]})]})},we={borderRadius:"52px",boxShadow:"4px 4px 10px rgba(104, 39, 184, 0.17)",color:Se.A.firstColor,background:"white",fontSize:{xs:"12px",md:"14px"},width:"fit-content",p:1,px:2,mb:1}},70141:(e,o,i)=>{i.d(o,{A:()=>r});var t=i(59662),l=i(70579);const r=(0,t.A)((0,l.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},84770:(e,o,i)=>{i.d(o,{A:()=>r});var t=i(59662),l=i(70579);const r=(0,t.A)((0,l.jsx)("path",{d:"M12 7V3H2v18h20V7zM6 19H4v-2h2zm0-4H4v-2h2zm0-4H4V9h2zm0-4H4V5h2zm4 12H8v-2h2zm0-4H8v-2h2zm0-4H8V9h2zm0-4H8V5h2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8zm-2-8h-2v2h2zm0 4h-2v2h2z"}),"Business")}}]);
//# sourceMappingURL=339.5e4316bd.chunk.js.map