"use strict";(self.webpackChunkhuts4u=self.webpackChunkhuts4u||[]).push([[315],{20751:(e,t,r)=>{r.d(t,{A:()=>i});var o=r(59662),a=r(70579);const i=(0,o.A)((0,a.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12m8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8"}),"Block")},69320:(e,t,r)=>{r.d(t,{A:()=>i});var o=r(59662),a=r(70579);const i=(0,o.A)((0,a.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star")},79315:(e,t,r)=>{r.r(t),r.d(t,{calculatePriceBreakdown:()=>S,default:()=>N});var o=r(89379),a=r(20751),i=r(69320),l=r(91082),n=r(59662),s=r(70579);const d=(0,n.A)((0,s.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person");var c=r(7353),u=r(12110),h=r(77739),p=r(94496),f=r(36591),v=r(26494),x=r(76641),g=r(92382),m=r(33580),A=r(61968),y=r(65043),b=r(69995),w=r(60446),j=r.n(w),k=r(73216),Y=r(59007);const S=e=>{const t=Number(e)||0;if(!t||t<=0)return{basePrice:0,platformFee:0,gstOnBase:0,gstOnPlatform:0,gatewayFee:0,gstOnGateway:0,gstTotal:0,finalPrice:0};const r=.05*t,o=.13*(t+r),a=.18*o,i=.02*(t+r+o+a),l=.18*i,n=r+a+l+i;return{basePrice:t,platformFee:o,gstOnBase:r,gstOnPlatform:a,gatewayFee:i,gstOnGateway:l,gstTotal:n,finalPrice:t+o+n}},M="https://huts44u.s3.ap-south-1.amazonaws.com",H=Y.w4,D=e=>{if(!e||!Array.isArray(e)||0===e.length)return 0;const t=e.reduce((e,t)=>e+(Number(t.rating)||0),0);return Math.round(t/e.length*10)/10},F=(e,t)=>{if(!e||!t)return[];let r=[];if(Array.isArray(e))r=e;else if(e&&"object"===typeof e)if(Array.isArray(e.data))r=e.data;else if(Array.isArray(e.rows))r=e.rows;else{if(!Array.isArray(e.result))return[];r=e.result}return Array.isArray(r)?r.filter(e=>{const r=e.hotelId||e.propertyId||e.hotel_id||e.hotelID;return r===t||(null===r||void 0===r?void 0:r.toString())===(null===t||void 0===t?void 0:t.toString())}):[]},C=(e,t,r,o)=>{if(!e||!r)return e[o]||0;const a=e.id,i=j()(r).format("YYYY-MM-DD"),l=null===t||void 0===t?void 0:t.find(e=>e.roomId===a&&j()(e.date).format("YYYY-MM-DD")===i);if(!l)return e[o]||0;switch(o){case"rateFor1Night":return l.overnightRate||e.rateFor1Night||0;case"rateFor3Hour":return l.threeHourRate||e.rateFor3Hour||0;case"rateFor6Hour":return l.sixHourRate||e.rateFor6Hour||0;case"rateFor12Hour":return l.twelveHourRate||e.rateFor12Hour||0;default:return e[o]||0}},z=(e,t,r)=>{var o;const a=null===(o=e.status)||void 0===o?void 0:o.toLowerCase();if(!("available"===a||"active"===a))return{isAvailable:!1,status:"Unavailable",reason:"Room is currently unavailable"};if(!t||0===t.length)return{isAvailable:!0,status:"Available",reason:"Available for booking"};const i=r?j()(r).format("YYYY-MM-DD"):"",l=i?t.find(e=>j()(e.date).format("YYYY-MM-DD")===i):null;if(l){if(l.isBlocked)return{isAvailable:!1,status:"Blocked",reason:"Room is blocked for selected date"};if(!(l.overnightAvailable>l.overnightBooked||l.threeHourAvailable>l.threeHourBooked||l.sixHourAvailable>l.sixHourBooked||l.twelveHourAvailable>l.twelveHourBooked))return{isAvailable:!1,status:"Sold Out",reason:"No slots available for selected date"}}return{isAvailable:!0,status:"Available",reason:"Available for booking"}},I=async(e,t)=>{try{var r,o,a,i,l,n,s;const d={data:{filter:"",roomId:e,date:t},page:0,pageSize:1e3,order:[["createdAt","ASC"]]},c=await(0,b.ww)(d);let u=[];return null!==c&&void 0!==c&&null!==(r=c.data)&&void 0!==r&&null!==(o=r.data)&&void 0!==o&&o.data&&Array.isArray(c.data.data.data)?u=c.data.data.data:null!==c&&void 0!==c&&null!==(a=c.data)&&void 0!==a&&null!==(i=a.data)&&void 0!==i&&i.rows&&Array.isArray(c.data.data.rows)?u=c.data.data.rows:null!==c&&void 0!==c&&null!==(l=c.data)&&void 0!==l&&null!==(n=l.data)&&void 0!==n&&n.result&&Array.isArray(c.data.data.result)?u=c.data.data.result:Array.isArray(null===c||void 0===c||null===(s=c.data)||void 0===s?void 0:s.data)&&(u=c.data.data),u}catch(d){return console.error("Error fetching inventory for room ".concat(e,":"),d),[]}},B=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;const a=null===e||void 0===e||null===(t=e.rooms)||void 0===t?void 0:t[0];if(!a)return{rate:0,label:""};const i=[{rate:C(a,r,o,"rateFor3Hour"),label:"per 3 hour",slot:"rateFor3Hour"},{rate:C(a,r,o,"rateFor6Hour"),label:"per 6 hour",slot:"rateFor6Hour"},{rate:C(a,r,o,"rateFor12Hour"),label:"per 12 hour",slot:"rateFor12Hour"},{rate:C(a,r,o,"rateFor1Night"),label:"per night",slot:"rateFor1Night"}].filter(e=>e.rate>0&&((e,t,r,o)=>{var a;if(!e||!r)return!1;const i=null===(a=e.status)||void 0===a?void 0:a.toLowerCase();if("available"!==i&&"active"!==i)return!1;const l=j()(r).format("YYYY-MM-DD"),n=null===t||void 0===t?void 0:t.find(e=>j()(e.date).format("YYYY-MM-DD")===l);if(!n)return!0;if(n.isBlocked)return!1;switch(o){case"rateFor1Night":return n.overnightAvailable>n.overnightBooked;case"rateFor3Hour":return n.threeHourAvailable>n.threeHourBooked;case"rateFor6Hour":return n.sixHourAvailable>n.sixHourBooked;case"rateFor12Hour":return n.twelveHourAvailable>n.twelveHourBooked;default:return!0}})(a,r,o,e.slot));return i.length?i.reduce((e,t)=>t.rate<e.rate?t:e):{rate:0,label:""}},R=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;if(e.length<=t)return e;const r=[...e];for(let d=r.length-1;d>0;d--){const e=Math.floor(Math.random()*(d+1));[r[d],r[e]]=[r[e],r[d]]}const o=[],a=new Set,i=(e,t)=>{var r,o;const a=null===e||void 0===e||null===(r=e.rooms)||void 0===r?void 0:r[0];if(!a)return 0;const i=(null===(o=e._inventoryData)||void 0===o?void 0:o[a.id])||[];return B(e,i,t).rate},l=j()().format("YYYY-MM-DD");[r.filter(e=>i(e,l)<=1500&&i(e,l)>0),r.filter(e=>i(e,l)>1500&&i(e,l)<=3e3),r.filter(e=>i(e,l)>3e3)].forEach(e=>{if(o.length<t&&e.length>0){const t=e[Math.floor(Math.random()*e.length)];t&&t.id&&!a.has(t.id)&&(a.add(t.id),o.push(t))}});const n=t-o.length;if(n>0){((e,r)=>{for(const i of e){if(o.length>=t)break;if(i&&i.id&&!a.has(i.id)&&(a.add(i.id),o.push(i),o.length>=r))break}})(r.filter(e=>!a.has(e.id)),n)}const s=[...o];for(let d=s.length-1;d>0;d--){const e=Math.floor(Math.random()*(d+1));[s[d],s[e]]=[s[e],s[d]]}return s.slice(0,t)},N=()=>{const{isBelow400px:e}=(0,A.lm)(),[t,r]=(0,y.useState)([]),[n,w]=(0,y.useState)([]),[Y,C]=(0,y.useState)(null),[N,O]=(0,y.useState)({}),[T,P]=(0,y.useState)(!0),E=(0,k.Zp)(),L={dots:!1,infinite:n.length>3,speed:500,slidesToShow:3,slidesToScroll:1,arrows:!1,responsive:[{breakpoint:1024,settings:{slidesToShow:2,centerMode:!1,arrows:!1}},{breakpoint:600,settings:{slidesToShow:1,centerMode:!1,arrows:!1}}]};(0,y.useEffect)(()=>{(async()=>{try{var e,t;P(!0);const i=(async()=>{try{var e;const t={data:{filter:""},page:0,pageSize:1e3,order:[["createdAt","ASC"]]},r=await(0,b.Ge)(t);let o=null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.data;return null!==o&&void 0!==o&&o.data&&Array.isArray(o.data)?o.data:null!==o&&void 0!==o&&o.rows&&Array.isArray(o.rows)?o.rows:null!==o&&void 0!==o&&o.result&&Array.isArray(o.result)?o.result:Array.isArray(o)?o:[]}catch(t){return console.error("Error fetching ratings:",t),[]}})(),l={data:{filter:"",status:"Approved"},page:0,pageSize:50,order:[["createdAt","ASC"]]},n=await(0,b.Vy)(l),s=((null===n||void 0===n||null===(e=n.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.rows)||[]).map(e=>e.id);console.log("Fetching rooms for ".concat(s.length," hotels..."));const[d]=await Promise.all([i]);C(d);let c=[];for(const e of s){var a;const t={id:e,secondTable:"Room"},r=await(0,b.YT)(t),i=(null===r||void 0===r?void 0:r.data)||null;if(i&&null!==(a=i.data)&&void 0!==a&&a[0]){const e=i.data[0].id,t=F(d,e),r=D(t);c.push((0,o.A)((0,o.A)({},i.data[0]),{},{ratings:{rating:r,count:t.length}}))}}console.log("Total hotels fetched with rooms: ".concat(c.length)),r(c);const u=R(c,15);w(u);const h=j()().format("YYYY-MM-DD"),p=u.map(async e=>{const t=await(async(e,t)=>{const r={};if(!e.rooms||0===e.rooms.length)return r;for(const a of e.rooms)try{const e=await I(a.id,t);r[a.id]=e}catch(o){console.error("Error fetching inventory for room ".concat(a.id,":"),o),r[a.id]=[]}return r})(e,h);return{hotelId:e.id,inventory:t}}),f=(await Promise.all(p)).reduce((e,t)=>{let{hotelId:r,inventory:o}=t;return e[r]=o,e},{});O(f),console.log("Displaying ".concat(u.length," hotels with inventory data"))}catch(i){console.error("Error:",i)}finally{P(!1)}})()},[]);return(0,s.jsx)(c.A,{sx:{width:"100%",position:"relative",overflow:"hidden","& .slick-slider":{width:"100%"},"& .slick-list":{width:"100%",margin:{xs:"0 -4px",sm:"0"}},"& .slick-track":{display:"flex",alignItems:"stretch"},"& .slick-slide":{height:"auto",padding:{xs:"0 8px",sm:"0 12px"},"& > div":{height:"100%"}}},children:(0,s.jsx)(g.A,(0,o.A)((0,o.A)({},L),{},{children:n.map(e=>{var t,r,o,n,g,A,y;const b=null===e||void 0===e||null===(t=e.rooms)||void 0===t?void 0:t[0],w=(null===(r=N[e.id])||void 0===r?void 0:r[null===b||void 0===b?void 0:b.id])||[],k=j()().format("YYYY-MM-DD"),Y=B(e,w,k),{rate:D,label:F}=Y,{basePrice:C,platformFee:I,gstTotal:R}=S(D),O=C+I,T=R,P=b?z(b,w,k):{isAvailable:!1,status:"No Rooms",reason:"No rooms available"},L=P.isAvailable,W=(null===(o=e.ratings)||void 0===o?void 0:o.rating)||0,G=(null===(n=e.ratings)||void 0===n?void 0:n.count)||0;return(0,s.jsx)(c.A,{sx:{height:"100%",display:"flex",justifyContent:"center"},children:(0,s.jsxs)(u.A,{onClick:()=>L&&(e=>{var t,r;const o=null===e||void 0===e||null===(t=e.rooms)||void 0===t?void 0:t[0];if(!o)return;const a=(null===(r=N[e.id])||void 0===r?void 0:r[o.id])||[];if(!z(o,a,j()().format("YYYY-MM-DD")).isAvailable)return;const i={bookingType:"fullDay",location:"Bhubaneswar, Odisha, India",rooms:1,adults:2,children:0,nights:1,checkinDate:j()().format("YYYY-MM-DD"),minBudget:100,maxBudget:2e4,sortBy:"all",page:1,hotelId:e.id},l=Object.entries(i).filter(e=>{let[t,r]=e;return""!==r&&null!==r&&void 0!==r}).map(e=>{let[t,r]=e;return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(String(r)))}).join("&");console.log("Navigating to search with params:",l),E("/search?".concat(l))})(e),sx:{width:{xs:"100%",sm:"100%",md:"100%"},maxWidth:{xs:"100%",sm:"320px",md:"320px"},display:"flex",flexDirection:"column",boxShadow:"none",borderRadius:"12px",border:"solid 3px",borderColor:L?m.A.firstColor:"#777",position:"relative",cursor:L?"pointer":"not-allowed",opacity:L?1:.5,pointerEvents:L?"auto":"none",overflow:"visible"},children:[!L&&(0,s.jsx)(h.A,{title:P.reason,children:(0,s.jsxs)(p.A,{sx:{position:"absolute",top:0,right:0,zIndex:1,px:1.5,background:"#ff4444",color:"white",borderRadius:"0px 0px 0px 12px",fontSize:"14px",pb:.3,fontWeight:"bold",display:"flex",alignItems:"center",gap:.5},children:[(0,s.jsx)(a.A,{sx:{fontSize:16}}),P.status.toUpperCase()]})}),L&&W>=4.5&&(0,s.jsxs)(p.A,{sx:{position:"absolute",top:0,left:0,zIndex:1,px:1.5,background:"#FFD700",color:"#000",borderRadius:"0px 0px 12px 0px",fontSize:"12px",pb:.3,fontWeight:"bold",display:"flex",alignItems:"center",gap:.5},children:[(0,s.jsx)(i.A,{sx:{fontSize:14}}),"TOP RATED"]}),L&&(0,s.jsx)(p.A,{sx:{position:"absolute",top:0,right:L&&W>=4.5?"auto":0,left:L&&W>=4.5?"auto":0,zIndex:1,px:1.5,background:m.A.background,color:"white",borderRadius:L&&W>=4.5?"0px 0px 12px 0px":"0px 0px 0px 12px",fontSize:"14px",pb:.3},children:"Featured"}),(0,s.jsx)(c.A,{sx:{height:"200px",overflow:"hidden",flexShrink:0},children:(0,s.jsx)(f.A,{component:"img",height:"200",image:(U=null===(g=e.propertyImages)||void 0===g?void 0:g[0],U?U.includes(M)?U.replace(M,H):U:"/default-hotel.jpg"),alt:e.propertyName,sx:{objectFit:"cover",width:"100%",height:"100%"}})}),(0,s.jsxs)(v.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",p:2,pb:3},children:[(0,s.jsxs)(c.A,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,children:[(0,s.jsxs)(c.A,{display:"flex",alignItems:"center",children:[(0,s.jsx)(x.A,{value:W,precision:.1,readOnly:!0,size:"small"}),(0,s.jsx)(p.A,{sx:{fontSize:"16px",color:m.A.secondColor,ml:1},children:W>0?W.toFixed(1):"N/A"})]}),G>0&&(0,s.jsxs)(p.A,{sx:{fontSize:"12px",color:"#666"},children:["(",G," review",1!==G?"s":"",")"]})]}),(0,s.jsx)(p.A,{sx:{fontFamily:"CustomFontB",mb:.5,minHeight:"3em",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"1.5em"},variant:"h6",children:e.propertyName}),(0,s.jsx)(c.A,{sx:{minHeight:"60px",display:"flex",flexDirection:"column",justifyContent:"center",mb:1.5},children:O>0&&L?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(p.A,{variant:"h6",sx:{mb:.5},children:["\u20b9",Math.round(O)," ",(0,s.jsx)("span",{style:{fontSize:"14px",fontWeight:"bold"},children:F})]}),(0,s.jsxs)(p.A,{sx:{fontSize:"12px",color:"#555"},children:["+ \u20b9",Math.round(T)," taxes & fees"]}),(0,s.jsx)(p.A,{sx:{fontSize:"10px",color:"#888",mt:.5},children:(0,s.jsx)("em",{children:"Dynamic pricing based on today's availability"})})]}):(0,s.jsx)(p.A,{sx:{fontSize:"14px",color:"#777",minHeight:"60px",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"},children:L?"Check Price":P.reason})}),(0,s.jsxs)(c.A,{display:"flex",justifyContent:"space-between",sx:{background:m.A.background,p:1,py:1.5,borderRadius:"12px",minHeight:"50px",mb:1.5},children:[(0,s.jsxs)(p.A,{sx:{fontSize:"12px",color:"white",px:2,display:"flex",alignItems:"center",width:"50%"},children:[(0,s.jsx)(l.A,{style:{fontSize:"18px",paddingRight:"4px"}}),e.city||"City N/A"]}),(0,s.jsxs)(p.A,{sx:{fontSize:"12px",color:"white",px:2,display:"flex",alignItems:"center",width:"50%"},children:[(0,s.jsx)(d,{style:{fontSize:"18px",paddingRight:"4px"}}),(null===(A=e.rooms)||void 0===A||null===(y=A[0])||void 0===y?void 0:y.standardRoomOccupancy)||2]})]}),(0,s.jsx)(p.A,{sx:{fontSize:"10px",background:"#e0e0e0",color:"#333",px:1,py:.2,borderRadius:"4px",display:"inline-block",width:"fit-content",alignSelf:"flex-start"},children:e.propertyType||"Hotel"})]})]})},e.id);var U})}))})}}}]);
//# sourceMappingURL=315.1f289b8a.chunk.js.map