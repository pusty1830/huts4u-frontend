"use strict";(self.webpackChunkhuts4u=self.webpackChunkhuts4u||[]).push([[264],{47264:(e,t,r)=>{r.r(t),r.d(t,{calculatePriceBreakdown:()=>Y,default:()=>C});var o=r(89379),a=r(20751),i=r(91082),l=r(59893),n=r(69320),s=r(7353),d=r(12110),c=r(77739),u=r(94496),h=r(36591),f=r(26494),p=r(76641),x=r(92382),v=r(33580),g=r(61968),m=r(65043),A=r(69995),y=r(60446),b=r.n(y),w=r(73216),j=r(70579);const Y=e=>{const t=Number(e)||0;if(!t||t<=0)return{basePrice:0,platformFee:0,gstOnBase:0,gstOnPlatform:0,gatewayFee:0,gstOnGateway:0,gstTotal:0,finalPrice:0};const r=.05*t,o=.13*(t+r),a=.18*o,i=.02*(t+r+o+a),l=.18*i,n=r+a+l+i;return{basePrice:t,platformFee:o,gstOnBase:r,gstOnPlatform:a,gatewayFee:i,gstOnGateway:l,gstTotal:n,finalPrice:t+o+n}},k=e=>{if(!e||!Array.isArray(e)||0===e.length)return 0;const t=e.reduce((e,t)=>e+(Number(t.rating)||0),0);return Math.round(t/e.length*10)/10},S=(e,t)=>{if(!e||!t)return[];let r=[];if(Array.isArray(e))r=e;else if(e&&"object"===typeof e)if(Array.isArray(e.data))r=e.data;else if(Array.isArray(e.rows))r=e.rows;else{if(!Array.isArray(e.result))return[];r=e.result}return Array.isArray(r)?r.filter(e=>{const r=e.hotelId||e.propertyId||e.hotel_id||e.hotelID;return r===t||(null===r||void 0===r?void 0:r.toString())===(null===t||void 0===t?void 0:t.toString())}):[]},H=(e,t,r,o)=>{if(!e||!r)return e[o]||0;const a=e.id,i=b()(r).format("YYYY-MM-DD"),l=null===t||void 0===t?void 0:t.find(e=>e.roomId===a&&b()(e.date).format("YYYY-MM-DD")===i);if(!l)return e[o]||0;switch(o){case"rateFor1Night":return l.overnightRate||e.rateFor1Night||0;case"rateFor3Hour":return l.threeHourRate||e.rateFor3Hour||0;case"rateFor6Hour":return l.sixHourRate||e.rateFor6Hour||0;case"rateFor12Hour":return l.twelveHourRate||e.rateFor12Hour||0;default:return e[o]||0}},M=(e,t,r)=>{var o;const a=null===(o=e.status)||void 0===o?void 0:o.toLowerCase();if(!("available"===a||"active"===a))return{isAvailable:!1,status:"Unavailable",reason:"Room is currently unavailable"};if(!t||0===t.length)return{isAvailable:!0,status:"Available",reason:"Available for booking"};const i=r?b()(r).format("YYYY-MM-DD"):"",l=i?t.find(e=>b()(e.date).format("YYYY-MM-DD")===i):null;if(l){if(l.isBlocked)return{isAvailable:!1,status:"Blocked",reason:"Room is blocked for selected date"};if(!(l.overnightAvailable>l.overnightBooked||l.threeHourAvailable>l.threeHourBooked||l.sixHourAvailable>l.sixHourBooked||l.twelveHourAvailable>l.twelveHourBooked))return{isAvailable:!1,status:"Sold Out",reason:"No slots available for selected date"}}return{isAvailable:!0,status:"Available",reason:"Available for booking"}},D=async(e,t)=>{try{var r,o,a,i,l,n,s;const d={data:{filter:"",roomId:e,date:t},page:0,pageSize:1e3,order:[["createdAt","ASC"]]},c=await(0,A.ww)(d);let u=[];return null!==c&&void 0!==c&&null!==(r=c.data)&&void 0!==r&&null!==(o=r.data)&&void 0!==o&&o.data&&Array.isArray(c.data.data.data)?u=c.data.data.data:null!==c&&void 0!==c&&null!==(a=c.data)&&void 0!==a&&null!==(i=a.data)&&void 0!==i&&i.rows&&Array.isArray(c.data.data.rows)?u=c.data.data.rows:null!==c&&void 0!==c&&null!==(l=c.data)&&void 0!==l&&null!==(n=l.data)&&void 0!==n&&n.result&&Array.isArray(c.data.data.result)?u=c.data.data.result:Array.isArray(null===c||void 0===c||null===(s=c.data)||void 0===s?void 0:s.data)&&(u=c.data.data),u}catch(d){return console.error("Error fetching inventory for room ".concat(e,":"),d),[]}},F=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;const a=null===e||void 0===e||null===(t=e.rooms)||void 0===t?void 0:t[0];if(!a)return{rate:0,label:""};const i=[{rate:H(a,r,o,"rateFor3Hour"),label:"per 3 hour",slot:"rateFor3Hour"},{rate:H(a,r,o,"rateFor6Hour"),label:"per 6 hour",slot:"rateFor6Hour"},{rate:H(a,r,o,"rateFor12Hour"),label:"per 12 hour",slot:"rateFor12Hour"},{rate:H(a,r,o,"rateFor1Night"),label:"per night",slot:"rateFor1Night"}].filter(e=>e.rate>0&&((e,t,r,o)=>{var a;if(!e||!r)return!1;const i=null===(a=e.status)||void 0===a?void 0:a.toLowerCase();if("available"!==i&&"active"!==i)return!1;const l=b()(r).format("YYYY-MM-DD"),n=null===t||void 0===t?void 0:t.find(e=>b()(e.date).format("YYYY-MM-DD")===l);if(!n)return!0;if(n.isBlocked)return!1;switch(o){case"rateFor1Night":return n.overnightAvailable>n.overnightBooked;case"rateFor3Hour":return n.threeHourAvailable>n.threeHourBooked;case"rateFor6Hour":return n.sixHourAvailable>n.sixHourBooked;case"rateFor12Hour":return n.twelveHourAvailable>n.twelveHourBooked;default:return!0}})(a,r,o,e.slot));return i.length?i.reduce((e,t)=>t.rate<e.rate?t:e):{rate:0,label:""}},z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;if(e.length<=t)return e;const r=[...e];for(let d=r.length-1;d>0;d--){const e=Math.floor(Math.random()*(d+1));[r[d],r[e]]=[r[e],r[d]]}const o=[],a=new Set,i=(e,t)=>{var r,o;const a=null===e||void 0===e||null===(r=e.rooms)||void 0===r?void 0:r[0];if(!a)return 0;const i=(null===(o=e._inventoryData)||void 0===o?void 0:o[a.id])||[];return F(e,i,t).rate},l=b()().format("YYYY-MM-DD");[r.filter(e=>i(e,l)<=1500&&i(e,l)>0),r.filter(e=>i(e,l)>1500&&i(e,l)<=3e3),r.filter(e=>i(e,l)>3e3)].forEach(e=>{if(o.length<t&&e.length>0){const t=e[Math.floor(Math.random()*e.length)];t&&t.id&&!a.has(t.id)&&(a.add(t.id),o.push(t))}});const n=t-o.length;if(n>0){((e,r)=>{for(const i of e){if(o.length>=t)break;if(i&&i.id&&!a.has(i.id)&&(a.add(i.id),o.push(i),o.length>=r))break}})(r.filter(e=>!a.has(e.id)),n)}const s=[...o];for(let d=s.length-1;d>0;d--){const e=Math.floor(Math.random()*(d+1));[s[d],s[e]]=[s[e],s[d]]}return s.slice(0,t)},C=()=>{const{isBelow400px:e}=(0,g.lm)(),[t,r]=(0,m.useState)([]),[y,H]=(0,m.useState)([]),[C,I]=(0,m.useState)(null),[B,R]=(0,m.useState)({}),[N,O]=(0,m.useState)(!0),T=(0,w.Zp)(),P={dots:!1,infinite:y.length>3,speed:500,slidesToShow:3,slidesToScroll:1,arrows:!1,responsive:[{breakpoint:1024,settings:{slidesToShow:2,centerMode:!1,arrows:!1}},{breakpoint:600,settings:{slidesToShow:1,centerMode:!1,arrows:!1}}]};(0,m.useEffect)(()=>{(async()=>{try{var e,t;O(!0);const i=(async()=>{try{var e;const t={data:{filter:""},page:0,pageSize:1e3,order:[["createdAt","ASC"]]},r=await(0,A.Ge)(t);let o=null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.data;return null!==o&&void 0!==o&&o.data&&Array.isArray(o.data)?o.data:null!==o&&void 0!==o&&o.rows&&Array.isArray(o.rows)?o.rows:null!==o&&void 0!==o&&o.result&&Array.isArray(o.result)?o.result:Array.isArray(o)?o:[]}catch(t){return console.error("Error fetching ratings:",t),[]}})(),l={data:{filter:"",status:"Approved"},page:0,pageSize:50,order:[["createdAt","ASC"]]},n=await(0,A.Vy)(l),s=((null===n||void 0===n||null===(e=n.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.rows)||[]).map(e=>e.id);console.log("Fetching rooms for ".concat(s.length," hotels..."));const[d]=await Promise.all([i]);I(d);let c=[];for(const e of s){var a;const t={id:e,secondTable:"Room"},r=await(0,A.YT)(t),i=(null===r||void 0===r?void 0:r.data)||null;if(i&&null!==(a=i.data)&&void 0!==a&&a[0]){const e=i.data[0].id,t=S(d,e),r=k(t);c.push((0,o.A)((0,o.A)({},i.data[0]),{},{ratings:{rating:r,count:t.length}}))}}console.log("Total hotels fetched with rooms: ".concat(c.length)),r(c);const u=z(c,15);H(u);const h=b()().format("YYYY-MM-DD"),f=u.map(async e=>{const t=await(async(e,t)=>{const r={};if(!e.rooms||0===e.rooms.length)return r;for(const a of e.rooms)try{const e=await D(a.id,t);r[a.id]=e}catch(o){console.error("Error fetching inventory for room ".concat(a.id,":"),o),r[a.id]=[]}return r})(e,h);return{hotelId:e.id,inventory:t}}),p=(await Promise.all(f)).reduce((e,t)=>{let{hotelId:r,inventory:o}=t;return e[r]=o,e},{});R(p),console.log("Displaying ".concat(u.length," hotels with inventory data"))}catch(i){console.error("Error:",i)}finally{O(!1)}})()},[]);return(0,j.jsx)(s.A,{sx:{width:"100%",position:"relative",overflow:"hidden","& .slick-slider":{width:"100%"},"& .slick-list":{width:"100%",margin:{xs:"0 -4px",sm:"0"}},"& .slick-track":{display:"flex",alignItems:"stretch"},"& .slick-slide":{height:"auto",padding:{xs:"0 8px",sm:"0 12px"},"& > div":{height:"100%"}}},children:(0,j.jsx)(x.A,(0,o.A)((0,o.A)({},P),{},{children:y.map(e=>{var t,r,o,x,g,m,A;const y=null===e||void 0===e||null===(t=e.rooms)||void 0===t?void 0:t[0],w=(null===(r=B[e.id])||void 0===r?void 0:r[null===y||void 0===y?void 0:y.id])||[],k=b()().format("YYYY-MM-DD"),S=F(e,w,k),{rate:H,label:D}=S,{basePrice:z,platformFee:C,gstTotal:I}=Y(H),R=z+C,N=I,O=y?M(y,w,k):{isAvailable:!1,status:"No Rooms",reason:"No rooms available"},P=O.isAvailable,E=(null===(o=e.ratings)||void 0===o?void 0:o.rating)||0,L=(null===(x=e.ratings)||void 0===x?void 0:x.count)||0;return(0,j.jsx)(s.A,{sx:{height:"100%",display:"flex",justifyContent:"center"},children:(0,j.jsxs)(d.A,{onClick:()=>P&&(e=>{var t,r;const o=null===e||void 0===e||null===(t=e.rooms)||void 0===t?void 0:t[0];if(!o)return;const a=(null===(r=B[e.id])||void 0===r?void 0:r[o.id])||[];if(!M(o,a,b()().format("YYYY-MM-DD")).isAvailable)return;const i={bookingType:"fullDay",location:"Bhubaneswar, Odisha, India",rooms:1,adults:2,children:0,nights:1,checkinDate:b()().format("YYYY-MM-DD"),minBudget:100,maxBudget:2e4,sortBy:"all",page:1,hotelId:e.id},l=Object.entries(i).filter(e=>{let[t,r]=e;return""!==r&&null!==r&&void 0!==r}).map(e=>{let[t,r]=e;return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(String(r)))}).join("&");console.log("Navigating to search with params:",l),T("/search?".concat(l))})(e),sx:{width:{xs:"100%",sm:"100%",md:"100%"},maxWidth:{xs:"100%",sm:"320px",md:"320px"},display:"flex",flexDirection:"column",boxShadow:"none",borderRadius:"12px",border:"solid 3px",borderColor:P?v.A.firstColor:"#777",position:"relative",cursor:P?"pointer":"not-allowed",opacity:P?1:.5,pointerEvents:P?"auto":"none",overflow:"visible"},children:[!P&&(0,j.jsx)(c.A,{title:O.reason,children:(0,j.jsxs)(u.A,{sx:{position:"absolute",top:0,right:0,zIndex:1,px:1.5,background:"#ff4444",color:"white",borderRadius:"0px 0px 0px 12px",fontSize:"14px",pb:.3,fontWeight:"bold",display:"flex",alignItems:"center",gap:.5},children:[(0,j.jsx)(a.A,{sx:{fontSize:16}}),O.status.toUpperCase()]})}),P&&E>=4.5&&(0,j.jsxs)(u.A,{sx:{position:"absolute",top:0,left:0,zIndex:1,px:1.5,background:"#FFD700",color:"#000",borderRadius:"0px 0px 12px 0px",fontSize:"12px",pb:.3,fontWeight:"bold",display:"flex",alignItems:"center",gap:.5},children:[(0,j.jsx)(n.A,{sx:{fontSize:14}}),"TOP RATED"]}),P&&(0,j.jsx)(u.A,{sx:{position:"absolute",top:0,right:P&&E>=4.5?"auto":0,left:P&&E>=4.5?"auto":0,zIndex:1,px:1.5,background:v.A.background,color:"white",borderRadius:P&&E>=4.5?"0px 0px 12px 0px":"0px 0px 0px 12px",fontSize:"14px",pb:.3},children:"Featured"}),(0,j.jsx)(s.A,{sx:{height:"200px",overflow:"hidden",flexShrink:0},children:(0,j.jsx)(h.A,{component:"img",height:"200",image:(null===(g=e.propertyImages)||void 0===g?void 0:g[0])||"/default-hotel.jpg",alt:e.propertyName,sx:{objectFit:"cover",width:"100%",height:"100%"}})}),(0,j.jsxs)(f.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",p:2,pb:3},children:[(0,j.jsxs)(s.A,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,children:[(0,j.jsxs)(s.A,{display:"flex",alignItems:"center",children:[(0,j.jsx)(p.A,{value:E,precision:.1,readOnly:!0,size:"small"}),(0,j.jsx)(u.A,{sx:{fontSize:"16px",color:v.A.secondColor,ml:1},children:E>0?E.toFixed(1):"N/A"})]}),L>0&&(0,j.jsxs)(u.A,{sx:{fontSize:"12px",color:"#666"},children:["(",L," review",1!==L?"s":"",")"]})]}),(0,j.jsx)(u.A,{sx:{fontFamily:"CustomFontB",mb:.5,minHeight:"3em",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"1.5em"},variant:"h6",children:e.propertyName}),(0,j.jsx)(s.A,{sx:{minHeight:"60px",display:"flex",flexDirection:"column",justifyContent:"center",mb:1.5},children:R>0&&P?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(u.A,{variant:"h6",sx:{mb:.5},children:["\u20b9",Math.round(R)," ",(0,j.jsx)("span",{style:{fontSize:"14px",fontWeight:"bold"},children:D})]}),(0,j.jsxs)(u.A,{sx:{fontSize:"12px",color:"#555"},children:["+ \u20b9",Math.round(N)," taxes & fees"]}),(0,j.jsx)(u.A,{sx:{fontSize:"10px",color:"#888",mt:.5},children:(0,j.jsx)("em",{children:"Dynamic pricing based on today's availability"})})]}):(0,j.jsx)(u.A,{sx:{fontSize:"14px",color:"#777",minHeight:"60px",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"},children:P?"Check Price":O.reason})}),(0,j.jsxs)(s.A,{display:"flex",justifyContent:"space-between",sx:{background:v.A.background,p:1,py:1.5,borderRadius:"12px",minHeight:"50px",mb:1.5},children:[(0,j.jsxs)(u.A,{sx:{fontSize:"12px",color:"white",px:2,display:"flex",alignItems:"center",width:"50%"},children:[(0,j.jsx)(i.A,{style:{fontSize:"18px",paddingRight:"4px"}}),e.city||"City N/A"]}),(0,j.jsxs)(u.A,{sx:{fontSize:"12px",color:"white",px:2,display:"flex",alignItems:"center",width:"50%"},children:[(0,j.jsx)(l.A,{style:{fontSize:"18px",paddingRight:"4px"}}),(null===(m=e.rooms)||void 0===m||null===(A=m[0])||void 0===A?void 0:A.standardRoomOccupancy)||2]})]}),(0,j.jsx)(u.A,{sx:{fontSize:"10px",background:"#e0e0e0",color:"#333",px:1,py:.2,borderRadius:"4px",display:"inline-block",width:"fit-content",alignSelf:"flex-start"},children:e.propertyType||"Hotel"})]})]})},e.id)})}))})}},59893:(e,t,r)=>{r.d(t,{A:()=>i});var o=r(59662),a=r(70579);const i=(0,o.A)((0,a.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person")},69320:(e,t,r)=>{r.d(t,{A:()=>i});var o=r(59662),a=r(70579);const i=(0,o.A)((0,a.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star")}}]);
//# sourceMappingURL=264.faeb8d09.chunk.js.map